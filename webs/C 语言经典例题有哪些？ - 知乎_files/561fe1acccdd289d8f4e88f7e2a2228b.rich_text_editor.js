(function(a){with(a){
a.KC=function(b,c){var d=k;if("delete"===c&&(d=Bt.Ur?"debugger":window.prompt("请输入删除理由"),!d))return;b.xhr=new V(j);b.mb&&P(b.g(),b.xhr,"success",b.te);b.xhr.ajax("/reviewq/answer?queue_id="+b.Jb+"&is_realm="+b.$d,"action="+c+"&answer_id="+b.aa.getAttribute("data-answer_id")+"&task_id="+b.aa.getAttribute("data-task_id")+(d?"&reason="+d:"")+"&none_queue="+b.aa.getAttribute("data-none_queue"))},a.LC=function(b,c){b.xhr=new V(j);b.mb&&P(b.g(),b.xhr,"success",b.te);b.xhr.ajax("/reviewq/question?queue_id="+
b.Jb+"&is_realm="+b.$d,"action="+c+"&question_id="+b.aa.getAttribute("data-question_id")+"&task_id="+b.aa.getAttribute("data-task_id")+"&none_queue="+b.aa.getAttribute("data-none_queue"))},a.MC=["delete","delete_answer"],a.NC=function(b){if(A&&!Gb(9)){var c=m;try{c=b.parentNode}catch(d){}return!!c}return sc(b.ownerDocument.body,b)},a.OC=function(b,c){return b.ba.h(c?b.xH:b.ZC)},a.PC=function(b){if("outerHTML"in b)return b.outerHTML;var c=Rb(b).createElement("div");c.appendChild(b.cloneNode(j));return c.innerHTML};
zo.prototype.bg=Z(68,function(){var b=this.Wq.body.createTextRange();b.moveToElementText(this.Wq.body);return this.Ag(new zo(b,this.Wq),j)});Jo.prototype.bg=Z(67,function(){return(!this.ta||NC(this.ta))&&(!this.pa||NC(this.pa))&&(!(A&&!Gb(9))||No(this).bg())});Po.prototype.bg=Z(66,function(){var b=m;try{b=z.every(this.Lh(),function(b){return A?!!b.parentNode:sc(b.ownerDocument.body,b)})}catch(c){}return b});Vo.prototype.bg=Z(65,function(){return z.every(ko(this),function(b){return b.bg()})});
ro.prototype.bj=Z(60,function(){return 3!=this.ca.nodeType?-1:this.ca==this.ta?this.ya:0});To.prototype.bj=Z(59,s(0));Xo.prototype.bj=Z(58,function(){return this.cg[this.Uk].bj()});Vy.prototype.ww=Z(53,function(b,c,d,e,g){var h=g||"question",b="question"===h?"问题":"答案";z.contains(MC,e)?Ai({title:d+b,content:"确定要"+d+"这个"+b+"吗？",Bi:["取消","确定"+d]},function(b){b?"question"===h?LC(this,e):KC(this,e):this.locked=m},this):"question"===h?LC(this,e):KC(this,e)});
uo.prototype.Yd=Z(48,function(){var b=Sb(this.O.startContainer).o("div");b.appendChild(this.O.cloneContents());b=b.innerHTML;if(Ea(b,"<")||!this.isCollapsed()&&!Va(b,"<"))return b;var c=this.uc(),c=1==c.nodeType?c:c.parentNode;return PC(c.cloneNode(m)).replace(">",">"+b)});zo.prototype.Yd=Z(47,function(){return this.O.htmlText});Jo.prototype.Yd=Z(46,function(){return No(this).Yd()});Po.prototype.Yd=Z(45,function(){return this.Kg()});Vo.prototype.Yd=Z(44,function(){return z.map(ko(this),function(b){return b.Yd()}).join("")});
ro.prototype.$i=Z(43,function(){return 3!=this.ca.nodeType?-1:this.ca==this.pa?this.wa:this.ca.nodeValue.length});To.prototype.$i=Z(42,s(0));Xo.prototype.$i=Z(41,function(){return this.cg[this.Uk].$i()});io.prototype.lg=Z(40,function(b){this.isCollapsed()||this.Yc();return this.insertNode(b,j)});Po.prototype.lg=Z(39,function(b){b=this.insertNode(b,j);this.isCollapsed()||this.Yc();return b});
fo.prototype.restore=Z(37,function(b){this.Mf&&go.log(ae,"Disposed SavedRange objects cannot be restored.",i);var c=this.Yj();b||this.C();return c});Oo.prototype.Yj=Z(36,function(){return Mo(this.vB,this.MJ,this.mD,this.XL)});Uo.prototype.Yj=Z(35,function(){for(var b=(this.Va.length?Rb(this.Va[0]):document).body.createControlRange(),c=0,d=this.Va.length;c<d;c++)b.addElement(this.Va[c]);return Qo(b)});
Yo.prototype.Yj=Z(34,function(){var b=z.map(this.qz,function(b){return b.restore()}),c=new Vo;c.Yl=b;c.We=z.map(b,function(b){return b.Vd()});return c});tu.prototype.vj=Z(27,function(){return 0<=this.eg-this.Pd.value.length});
so.prototype.Kg=Z(26,function(){var b=new Vr;O.forEach(this,function(c,d,e){3==c.nodeType?b.append(Ua(c.nodeValue.substring(e.bj(),e.$i()))):1==c.nodeType&&(-1==e.$b?gc(c)&&b.append("</"+c.tagName+">"):(d=c.cloneNode(m),d=PC(d),A&&"LI"==c.tagName?b.append(d):(c=d.lastIndexOf("<"),b.append(c?d.substr(0,c):d))))},this);return b.toString()});Jo.prototype.Kg=Z(25,function(){return No(this).Kg()});Po.prototype.Kg=Z(24,function(){return z.map(So(this),PC).join("")});Vo.prototype.Kg=Z(23,function(){return this.Yd()});
ho.prototype.np=Z(17,function(){var b=this.Mc?-1:1;this.$b==b&&(this.$b=-1*b,this.depth+=this.$b*(this.Mc?-1:1))});ro.prototype.np=Z(16,function(){ro.m.np.apply(this);sc(this.ca,this.pa)&&f(O.Za)});Yd.prototype.hC=Z(14,function(b,c){this.log(ee,b,c)});Hd.prototype.setInterval=Z(12,function(b){this.Pg=b;this.oa&&this.enabled?(this.stop(),this.start()):this.oa&&this.stop()});ol.prototype.mw=Z(11,function(){return this.h().innerHTML});
qo.prototype.ih=Z(9,function(b,c){this.insertNode(b,j);this.insertNode(c,m)});uo.prototype.ih=Z(8,function(b,c){var d=ac(Rb(this.T()));if(d=$o(d))var e=d.T(),g=d.ha(),h=d.ra(),l=d.Ea();var n=this.O.cloneRange(),q=this.O.cloneRange();n.collapse(m);q.collapse(j);n.insertNode(c);q.insertNode(b);n.detach();q.detach();if(d){if(3==e.nodeType)for(;h>e.length;){h-=e.length;do e=e.nextSibling;while(e==b||e==c)}if(3==g.nodeType)for(;l>g.length;){l-=g.length;do g=g.nextSibling;while(g==b||g==c)}Mo(e,h,g,l).select()}});
zo.prototype.ih=Z(7,function(b,c){var d=this.O.duplicate(),e=this.O.duplicate();Fo(d,b,j);Fo(e,c,m);this.ue()});Jo.prototype.ih=Z(6,function(b,c){No(this).ih(b,c);this.ue()});uo.prototype.Yc=Z(5,function(){var b=this.O;b.extractContents();if(b.startContainer.hasChildNodes()&&(b=b.startContainer.childNodes[b.startOffset])){var c=b.previousSibling;""==Gc(b)&&L(b);c&&""==Gc(c)&&L(c)}});
zo.prototype.Yc=Z(4,function(){if(!this.isCollapsed()&&this.O.htmlText){var b=this.T(),c=this.ha(),d=this.O.text,e=this.O.duplicate();e.moveStart("character",1);e.moveStart("character",-1);e.text==d&&(this.O=e);this.O.text="";this.ue();d=this.T();e=this.ra();try{var g=b.nextSibling;b==c&&(b.parentNode&&3==b.nodeType&&g&&3==g.nodeType)&&(b.nodeValue+=g.nodeValue,L(g),this.O=Bo(d),this.O.move("character",e),this.ue())}catch(h){}}});Jo.prototype.Yc=Z(3,function(){No(this).Yc();this.ue()});
Po.prototype.Yc=Z(2,function(){if(this.O){for(var b=[],c=0,d=this.O.length;c<d;c++)b.push(this.O.item(c));z.forEach(b,L);this.collapse(m)}});Vo.prototype.Yc=Z(1,function(){z.forEach(ko(this),function(b){b.Yc()})});
a.QC=function(b,c){var d=c.jd();b.nd[d]&&b.Nb.log(ae,"Cannot register the same class of plugin twice.",i);b.nd[d]=c;for(var e in zv)c[zv[e]]&&b.oj[e].push(c);c.B=b;b.Zd()&&c.enable(b)},a.RC=function(b){return b.B&&b.B.hb},a.SC=function(b){var c=b.ca.parentNode;return new Sr(c,z.indexOf(c.childNodes,b.ca))},a.TC=function(b,c,d,e){return Mo(b,c,d,e)},a.UC=function(b){M.call(this);this.xH=db();this.ZC=db();this.ba=Sb(b.za());b.ih(this.ba.o("SPAN",{id:this.xH}),this.ba.o("SPAN",{id:this.ZC}))};y(UC,fo);
UC.prototype.Ro=function(b){L(OC(this,j));L(OC(this,m));return b};UC.prototype.Yj=function(){var b=k,c=OC(this,j),d=OC(this,m);if(c&&d){var b=c.parentNode,c=z.indexOf(b.childNodes,c),e=d.parentNode,d=z.indexOf(e.childNodes,d);e==b&&(d-=1);b=Mo(b,c,e,d);b=this.Ro(b);b.select()}else this.Ro();return b};UC.prototype.p=function(){this.Ro();this.ba=k};
a.VC=function(b){var c;if(3==b.ca.nodeType)for(c=b.ca.previousSibling;c&&3==c.nodeType;c=c.previousSibling)b.offset+=Tr(c);else c=b.ca.previousSibling;var d=b.ca.parentNode;b.ca=c?c.nextSibling:d.firstChild;return b},a.WC=function(b,c){return c?Ur(b.T(),b.ra()):Ur(b.ha(),b.Ea())},a.XC=function(b){for(var c=k,d=b.firstChild;d;){var e=d.nextSibling;3==d.nodeType?""==d.nodeValue?b.removeChild(d):c?(c.nodeValue+=d.nodeValue,b.removeChild(d)):c=d:(XC(d),c=k);d=e}},a.YC=function(b){var c=b&&b.nodeName.toLowerCase();
return!(!b||"block"!=(1!=b.nodeType?k:A?Uf(b,"display"):Tf(b,"display"))&&!("td"==c||"table"==c||"li"==c))},a.ZC=function(b){return Hc(b,YC,j)},a.$C=function(b,c){if(c){var d,e=VC(WC(c,j)),g=SC(e),h=e.ca.previousSibling;3==e.ca.nodeType&&(e.ca=k);var l=VC(WC(c,m)),n=SC(l),q=l.ca.previousSibling;3==l.ca.nodeType&&(l.ca=k);d=function(){!e.ca&&h&&(e.ca=h.nextSibling,e.ca||(e=new Sr(h,Tr(h))));!l.ca&&q&&(l.ca=q.nextSibling,l.ca||(l=new Sr(q,Tr(q))));return Mo(e.ca||g.ca.firstChild||g.ca,e.offset,l.ca||
n.ca.firstChild||n.ca,l.offset)};var r=ZC(c.Db())}r?(r=wc(r,b),A?XC(r):r.normalize()):b&&(A?XC(b):b.normalize());return d?d():k},a.aD=function(b,c,d){Cs.call(this,c,b||Sz.D(),d)};y(aD,Cs);a.bD=function(b){return b.getAttribute&&"true"==b.getAttribute("g_editable")},a.cD=function(b){UC.call(this,b)};y(cD,UC);cD.prototype.Ro=function(b){var c=OC(this,j),d=OC(this,m),c=c&&d?wc(c,d):c||d;cD.m.Ro.call(this);if(b)return $C(c,b);c&&(b=$o(ac(Rb(c))),(b=$C(c,b))&&b.select())};
a.dD=function(b,c,d){for(var e=(c=1==c)?b.T():b.ha(),g=c?b.ra():b.Ea(),h=b.Db();e!=h&&e!=d&&!(c&&0!=g||!c&&g!=Tr(e));)var l=e.parentNode,e=z.indexOf(l.childNodes,e),g=c?e:e+1,e=l;return TC(c?e:b.T(),c?g:b.ra(),c?b.ha():e,c?b.Ea():g)},a.eD=function(b){rg(b,m);if(ip)for(var c=b,b=b.parentNode;b&&"HTML"!=b.tagName;){if(qg?"none"==b.style[qg].toLowerCase():(A||rb)&&"on"==b.getAttribute("unselectable")){rg(b,m,j);for(var d=0,e=b.childNodes.length;d<e;d++){var g=b.childNodes[d];g!=c&&1==g.nodeType&&rg(b.childNodes[d],
j)}}c=b;b=b.parentNode}},a.fD=function(b){var c=b.target.tagName;"TEXTAREA"!=c&&"INPUT"!=c&&b.preventDefault()},a.gD=void 0,a.hD=function(b){var c=b.Db();return b.T()!=c.parentElement&&bD(c)||!!Hc(c,bD)},a.iD=function(b,c){var d=dD(b,1,c),d=dD(d,0,c),e=d.T(),g=d.ha(),h=d.ra(),d=d.Ea();if(e==g){for(;g!=c&&0==h&&d==Tr(g);)e=g.parentNode,h=z.indexOf(e.childNodes,g),d=h+1,g=e;e=g}return Mo(e,h,g,d)},a.jD=function(b,c){ip&&c.c(b,"mousedown",fD,j);rg(b,j);for(var d=b.getElementsByTagName("INPUT"),e=0,g=
d.length;e<g;e++){var h=d[e];h.type in Bp&&eD(h)}z.forEach(b.getElementsByTagName("TEXTAREA"),eD)},a.kD=function(b){return!!zp[b.tagName]},a.lD=function(b){return ks(O.filter(new is(b),js))},a.mD=void 0,a.oD=function(b){var c=arguments,d=c.length;return function(){for(var b=0;b<d;b++)if(!c[b].apply(this,arguments))return m;return j}},a.pD=function(b){this.Gf=b;this.IO=j;this.Qv=[]},a.qD=function(b){b.nv||(b.nv=Gc(b.Gf));return b.nv};a.rD=function(){yv.call(this)};y(rD,yv);rD.prototype.jd=s("BTF");rD.prototype.Nb=ke("goog.editor.plugins.BasicTextFormatter");a.sD=F.ym({GI:"+link",iV:"+formatBlock",vV:"+indent",WV:"+outdent",BW:"+strikeThrough",rV:"+insertHorizontalRule",DW:"+subscript",EW:"+superscript",PW:"+underline",KU:"+bold",xV:"+italic",gV:"+fontSize",fV:"+fontName",eV:"+foreColor",EU:"+backColor",UV:"+insertOrderedList",TW:"+insertUnorderedList",yV:"+justifyCenter",zV:"+justifyFull",BV:"+justifyRight",AV:"+justifyLeft"});
t=rD.prototype;t.Je=function(b){return b in sD};t.Ae=function(){return aw(this.B)};a.tD=function(b){return RC(b).za()};
t.bf=function(b,c){var d,e,g,h,l,n=c;switch(b){case "+backColor":if(n!==k)if(op){e=n;g=aw(this.B);var q,r;g&&g.isCollapsed()&&(q=RC(this).createTextNode(B?" ":""),n=g.T(),r=1==n.nodeType?n:n.parentNode,""==r.innerHTML?(r.style.textIndent="-10000px",r.appendChild(q)):(r=RC(this).o("span",{style:"text-indent:-10000px"},q),g.lg(r)),oo(q).select());uD(this,"hiliteColor",e,m,j);q&&(B&&(q.data=""),r.style.textIndent="")}else rb?uD(this,"hiliteColor",n):uD(this,b,n);break;case "+link":a:{l=n;this.B.Ie||
RC(this).Pa().focus();g=(e=this.Ae())&&e.Db();if((g=Ic(g,"A"))&&Hc(g,bD))nc(g);else{g=k;var x=[];if((n=e&&e.Db())&&"IMG"==n.tagName)l=k;else{if(e&&e.isCollapsed())e=e.Be(0).Vd(),fp?(g=RC(this).createElement("A"),e.insertNode(g)):ep&&(e.pasteHTML("<a id='newLink'></a>"),g=RC(this).h("newLink"),g.removeAttribute("id"));else{var E=db();uD(this,"CreateLink",E);z.forEach(this.B.h().getElementsByTagName("A"),function(b){Bs(b.href,E)&&x.push(b)});x.length&&(g=x.pop())}e=g;g=new pD(e);g.Gf.href="/";l&&(e.target=
l);x&&(g.Qv=x);l=g}if(l){if(!this.B.execCommand("link",l))if(h=this.B.Ik.prompt(KA,"http://"))if(e=l,g=qD(l)||h,n=e.Gf,n.href=h,q=qD(e),g!=q&&(h=ss(n),3==h.nodeType&&(h=h.parentNode),Gc(h)!=q&&(h=n),ic(h),n=Sb(h),h.appendChild(n.createTextNode(g)),e.nv=k),e.IO=m,e=l.Gf,sp){g=e.nextSibling;if(!g||!(3==g.nodeType&&(Ea(g.data," ")||Ea(g.data," "))))g=Sb(e).createTextNode(" "),kc(g,e);bp(g,1).select()}else Yr(e,m);else{e=oo(l.Gf);e=new cD(e);nc(l.Gf);for(l.Gf=k;l.Qv.length;)nc(l.Qv.pop());e.restore().select();
l=k;break a}break a}}l=k}break;case "+justifyCenter":case "+justifyFull":case "+justifyRight":case "+justifyLeft":uD(this,b,k,m,j);B&&uD(this,b,k,m,j);(!mp||!B)&&O.forEach(aw(this.B),vD);break;default:A&&("+formatBlock"==b&&n)&&(n="<"+n+">");if("+foreColor"==b&&n===k)break;switch(b){case "+indent":case "+outdent":mp&&(B&&(e=j),rb&&(e="+outdent"==b?!tD(this).queryCommandEnabled("outdent"):j));case "+insertOrderedList":case "+insertUnorderedList":if(q=vp)q=tD(this),q=wD(this,j,q,b,i);if(q)g="P"!=this.B.queryCommandValue("+defaultTag");
else if(!wp&&(A||rb)){d=this.Ae();q=d.Db();var G=tD(this);xD.lastIndex=0;xD.test(q.innerHTML)&&(d=d.T()&&d.ha()?new UC(d):k,"P"==q.tagName?yD(q,j):(q.innerHTML=q.innerHTML.replace(xD,'<p$1 trtempbr="temp_br">'),q=z.toArray(q.getElementsByTagName("P")),O.forEach(q,function(b){if("temp_br"==b.getAttribute("trtempbr")){b.removeAttribute("trtempbr");if(hs(Fc(b))){var c=A?G.createTextNode(" "):G.createElement("BR");b.appendChild(c)}yD(b)}})),d.restore())}B&&(up&&!this.queryCommandValue(b))&&(q=this.B.queryCommandValue("+defaultTag"),
"P"==q||"DIV"==q?q=m:(q=this.Ae(),q.isCollapsed()&&3!=q.uc().nodeType?(d=RC(this).createTextNode(" "),q.insertNode(d,m),oo(d).select(),q=j):q=m),h|=q);case "+formatBlock":d=!!this.B.aj("Bidi");break;case "+subscript":case "+superscript":tp&&!this.queryCommandValue(b)&&(q="+subscript"==b?"+superscript":"+subscript",r=zD(q),this.queryCommandValue(q)||tD(this).execCommand(r,m,k),tD(this).execCommand(r,m,k));break;case "+underline":case "+bold":case "+italic":e=B&&mp&&this.queryCommandValue(b);break;
case "+foreColor":case "+fontName":e=mp&&B}uD(this,b,n,d,!!e);h&&tD(this).execCommand("Delete",m,j);g&&tD(this).execCommand("FormatBlock",m,"<div>")}B&&!this.B.Og&&RC(this).Pa().focus();return l};
t.queryCommandValue=function(b){var c;switch(b){case "+link":return b=(b=this.Ae())&&b.Db(),b=Ic(b,"A"),!!b&&!!Hc(b,bD);case "+justifyCenter":case "+justifyFull":case "+justifyRight":case "+justifyLeft":return AD(this,b);case "+formatBlock":var b=aw(this.B),d=k;O.forEach(b,function(b,c,e){-1!=e.$b&&(b=ZC(b).tagName,d=d||b,d!=b&&(d=k,f(O.Za)),e.np())});return d;case "+indent":case "+outdent":case "+insertHorizontalRule":return m;case "+fontSize":case "+fontName":case "+foreColor":case "+backColor":return this.Ps(tD(this),
b,mp&&B);case "+underline":case "+bold":case "+italic":c=mp&&B;default:var e=tD(this);return wD(this,j,e,b,c)}};t.rG=function(b){kp&&b.match(/^\s*<script/i)&&(b="&nbsp;"+b);lp&&(b=b.replace(/<(\/?)strong([^\w])/gi,"<$1b$2"),b=b.replace(/<(\/?)em([^\w])/gi,"<$1i$2"));return b};
t.CK=function(b){for(var b=b.getElementsByTagName("IMG"),c=0,d;d=b[c];c++)if(A){d.removeAttribute("tabIndex");d.removeAttribute("tabIndexSet");var e=d;"removeAttribute"in e&&e.removeAttribute(sa);try{delete e[sa]}catch(g){}d.JP&&(d.tabIndex=d.JP)}};t.DK=function(b){if(C){for(var c=Tb(this.B.hb.Ca,"HEAD",i,i),d=[],e=c.length,g=1;g<e;++g)for(var h=c[g].getElementsByTagName("STYLE"),l=h.length,n=0;n<l;++n)d.push(h[n].outerHTML);return d.join("")+b}return b};
t.vr=function(b,c,d){if(!d)return m;var e;switch(c){case "b":e="+bold";break;case "i":e="+italic";break;case "u":e="+underline";break;case "s":return j}return e?(this.B.execCommand(e),j):m};
a.xD=A?/<br([^\/>]*)\/?>/gi:/<br([^\/>]*)\/?>(?!<\/(div|p)>)/gi,a.yD=function(b,c){if(A||rb){var d=b.outerHTML.replace(/<(\/?)p/gi,"<$1div");c&&(d=d.replace(xD,"</div><div$1>"));rb&&!/<\/div>$/i.test(d)&&(d+="</div>");b.outerHTML=d}},a.zD=function(b){return 0==b.indexOf("+")?b.substring(1):b},a.vD=function(b){b=ZC(b);b.align&&(b.style.textAlign=b.align,b.removeAttribute("align"))},a.uD=function(b,c,d,e,g){var h=k;e&&(h=b.B.queryCommandValue("rtl")?"rtl":b.B.queryCommandValue("ltr")?"ltr":k);var c=
zD(c),l,n;if(A){var q=c;n=[];var e=k,r=b.Ae();l=RC(b);if(q in BD){var x=r&&r.Db();if(x){for(var E=Ub("BLOCKQUOTE",k,x),G,I=0;I<E.length;I++)if(r.containsNode(E[I])){G=E[I];break}if(x=G||Ic(x,"BLOCKQUOTE"))e=l.o("div",{style:"height:0"}),x.appendChild(e),n.push(e),G?r=Mo(G,0,e,0):r.containsNode(e)&&(r=TC(r.T(),r.ra(),e,0)),r.select()}}G=b.B;!G.pc()&&!e&&q in CD&&(G=G.h(),r&&(r.isCollapsed()&&!qc(G))&&(e=r.Be(0).Vd(),r=e.duplicate(),r.moveToElementText(G),r.collapse(m),r.isEqual(e)&&(r=l.createTextNode(" "),
G.appendChild(r),e.move("character",1),e.move("character",-1),e.select(),n.push(r))),e=l.o("div",{style:"height:0"}),G.appendChild(e),n.push(e));l=n[0];n=n[1]}if(C){l=c;var Q;DD[l]&&(Q=RC(b).o("div",{style:"height: 0"},"x"),b.B.h().appendChild(Q));ED[l]&&(l=b.B.h(),Q=RC(b).o("div",{style:"height: 0"},"x"),l.insertBefore(Q,l.firstChild));l=Q}if(B&&(Q=c,Eb("1.9")&&"formatblock"==Q.toLowerCase()&&(Q=b.Ae(),G=Q.T(),Q.isCollapsed()&&(G&&"BODY"==G.tagName)&&(e=Q.ra(),(G=G.childNodes[e])&&"BR"==G.tagName))))Q=
Q.Vd(),Q.setStart(G,0),Q.setEnd(G,0);if(xp&&"fontsize"==c.toLowerCase()){var X=iD(aw(b.B),b.B.h());O.forEach(O.filter(X,function(b,c,d){return 1==d.$b&&X.containsNode(b)}),function(b){Rf(b,"font-size","");B&&(0==b.style.length&&b.getAttribute("style")!=k)&&b.removeAttribute("style")})}Q=tD(b);if(g&&mp&&(Q.execCommand("styleWithCSS",m,j),rb)){G=[];e=aw(b.B).Db();do G.push(e);while(e=e.parentNode);G=O.sK(O.ad(aw(b.B)),O.ad(G));G=O.filter(G,YC);O.forEach(G,function(b){var c=b.style.outline;b.style.outline=
"0px solid red";b.style.outline=c})}Q.execCommand(c,m,d);g&&mp&&Q.execCommand("styleWithCSS",m,m);C&&(!Eb("526")&&"formatblock"==c.toLowerCase()&&d&&/^[<]?h\d[>]?$/i.test(d))&&O.forEach(b.Ae(),function(b){"Apple-style-span"==b.className&&(b.style.fontSize="",b.style.fontWeight="")});if(/insert(un)?orderedlist/i.test(c)){if(C){var na=m;O.forEach(b.Ae(),function(b){var c=b.tagName;if("UL"==c||"OL"==c)if(na){if(c=rc(b)){var d=b.ownerDocument.createRange();d.setStartAfter(c);d.setEndBefore(b);if(Ga(d.toString())&&
c.nodeName==b.nodeName){for(;c.lastChild;)b.insertBefore(c.lastChild,b.firstChild);c.parentNode.removeChild(c)}}}else na=j})}if(A){for(c=(c=b.Ae())&&c.uc();c&&"UL"!=c.tagName&&"OL"!=c.tagName;)c=c.parentNode;c&&(c=c.parentNode);c&&(d=z.toArray(c.getElementsByTagName("UL")),z.extend(d,z.toArray(c.getElementsByTagName("OL"))),z.forEach(d,function(b){var c=b.type;if(c&&!("UL"==b.tagName?FD:GD)[c])b.type=""}));n&&L(n)}}l&&L(l);h&&b.B.execCommand(h)},a.CD={indent:1,outdent:1,insertOrderedList:1,insertUnorderedList:1,
justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,ltr:1,rtl:1},a.BD={insertOrderedList:1,insertUnorderedList:1},a.GD={1:1,a:1,A:1,i:1,I:1},a.FD={disc:1,circle:1,square:1},a.DD={justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,formatBlock:1},a.ED={insertOrderedList:1,insertUnorderedList:1},a.HD={center:1,justify:1,right:1,left:1},a.AD=function(b,c){var d=c.replace("+justify","").toLowerCase();"full"==d&&(d="justify");var e=b.B.aj("Bidi");if(e)return d==e.VX();var g=b.Ae();if(!g)return m;
for(var h=g.Db(),e=z.filter(h.childNodes,function(b){return js(b)&&g.containsNode(b,j)}),e=e.length?e:[h],h=0;h<e.length;h++){var l=ZC(e[h]),n=d,q=Vf(l,"textAlign"),q=q.replace(/^-(moz|webkit)-/,"");HD[q]||(q=l.align||"left");if(n!=q)return m}return j};rD.prototype.Ps=function(b,c,d){return wD(this,m,b,c,d)};a.wD=function(b,c,d,e,g){e=zD(e);if(g){var h=tD(b);h.execCommand("styleWithCSS",m,j)}b=c?d.queryCommandState(e):d.queryCommandValue(e);g&&h.execCommand("styleWithCSS",m,m);return b};a.ID=function(b,c){M.call(this);this.ys=[];for(this.ts=[];b&&"BODY"!=b.nodeName&&b!=c;){for(var d=0,e=b.previousSibling;e;)e=e.previousSibling,++d;this.ys.unshift(d);this.ts.unshift(b.nodeName);b=b.parentNode}};y(ID,M);ID.prototype.toString=function(){for(var b=[],c,d=0;c=this.ts[d];d++)b.push(this.ys[d]+","+c);return b.join("\n")};a.JD=function(b,c){for(var d,e=c,g=0;d=b.ts[g];++g)if(e=e.childNodes[b.ys[g]],!e||e.nodeName!=d)return k;return e};ID.prototype.p=function(){delete this.ys;delete this.ts};ke("goog.editor.plugins.Blockquote");a.KD=function(){yv.call(this)};y(KD,yv);t=KD.prototype;t.ji="DIV";t.jd=s("EnterHandler");t.enable=function(b){KD.m.enable.call(this,b);yp&&("P"==this.ji||"DIV"==this.ji)&&RC(this).za().execCommand("opera-defaultBlock",m,this.ji)};t.rG=function(b){return!b||hs(b)?kp?this.lM():"":b};t.lM=jf("<br>");
t.YM=function(b){if(B&&this.B.Og)return m;if(8==b.keyCode){var c=aw(this.B),d=this.B.h(),c=c&&c.T();d.firstChild==c&&Ls(c)&&(b.preventDefault(),b.stopPropagation())}else if(13==b.keyCode)if(B){if(!b.shiftKey){var d=aw(this.B),c=!d||d.isCollapsed(),e=fp?LD(this):MD(this),g=this.B.execCommand("+splitBlockquote",e);g&&(b.preventDefault(),b.stopPropagation());fp||e.removeNode(j);g||this.PM(b,c,d)}}else{this.B.Fh();d=fp?LD(this):MD(this);if(c=!!this.B.execCommand("+splitBlockquote",d))b.preventDefault(),
b.stopPropagation();fp||d.removeNode(j);C&&this.QM(b);if(A||rb)ND(this);else if(!c&&C){if(c=d=aw(this.B))a:{for(c=d.Db();c;c=c.parentNode)if(kD(c)){c="BLOCKQUOTE"==c.tagName;break a}c=m}if(c){c=RC(this);e=c.createElement("BR");d.insertNode(e,j);if(d=kD(e.parentNode)){for(d=e.nextSibling;d&&3==d.nodeType&&!d.nodeValue;)d=d.nextSibling;d=!d}d&&jc(c.createElement("BR"),e);Yr(e,m);b.preventDefault()}}this.B.Ze()}else if(B&&46==b.keyCode&&(c=aw(this.B),c.isCollapsed()&&(d=c.ha(),1==d.nodeType&&(c=d.childNodes[c.Ea()])&&
"BR"==c.tagName)))e=ks(O.filter(new is(c,m,j),js)),g=c.nextSibling,d.removeChild(c),b.preventDefault(),g&&kD(g)&&(e&&!("BR"==e.tagName||kD(e))?bp(e,Tr(e)).select():(b=ss(g),bp(b,0).select()));return m};t.ur=function(b){if(B&&this.B.Og)return m;(A||rb)&&13==b.keyCode&&ND(this,j);return m};t.QM=ha;t.PM=ha;
a.OD=F.Dh("LI","DIV","H1","H2","H3","H4","H5","H6"),a.ND=function(b,c){for(var d=aw(b.B),e=d.uc(),g=b.B.h(),h;e&&e!=g;){var l=e.nodeName;if("DIV"==l||OD[l]&&(!c||!(Ls(e)&&1==e.getElementsByTagName("BR").length))){if(rb&&h){"DIV"==l&&(h==e.lastChild&&Ls(h))&&(kc(h,e),oo(h).select());break}return}rb&&(c&&"P"==l&&"DIV"!=l)&&(h=e);e=e.parentNode}if(A&&!Eb(9)){var n=m,d=d.Vd(),e=d.duplicate();e.moveEnd("character",1);if(e.text.length&&(n=e.parentElement(),e=e.duplicate(),e.collapse(m),e=e.parentElement(),
n=n!=e&&e!=d.parentElement()))d.move("character",-1),d.select()}b.B.hb.za().execCommand("FormatBlock",m,"<DIV>");n&&(d.move("character",1),d.select())},a.MD=function(b){var b=RC(b).za(),c=b.selection.createRange(),d=db();c.pasteHTML('<span id="'+d+'"></span>');b=b.getElementById(d);b.id="";return b},a.LD=function(b){b=aw(b.B);if(!b.isCollapsed()){var c=j;if(rb){var d=b.T(),e=b.ra();d==b.ha()&&(d.lastChild&&"BR"==d.lastChild.tagName&&e==d.childNodes.length-1)&&(c=m)}if(c){var g=b;if(g&&!g.isCollapsed()){var h=
j,c=g.Db(),d=new ID(g.T(),c),e=g.ra(),l;l=g;var n=l.T();YC(n)&&(n=n.childNodes[l.ra()]||n);var n=ZC(n),q=l.ha();YC(q)&&(q=q.childNodes[l.Ea()]||q);q=ZC(q);l=n==q;if(n=!l)a:{var q=g,n=q.ha(),q=q.Ea(),r=n;if(YC(r)){var x=r.childNodes[q];if(!x||1==x.nodeType&&YC(x)){n=m;break a}}for(x=ZC(r);x!=r;){if(lD(r)){n=j;break a}r=r.parentNode}n=q!=Tr(n)}g.Yc();(g=JD(d,c))?g=bp(g,e):(g=bp(c,c.childNodes.length),h=m);g.select();l&&(l=ZC(g.T()),Ls(l,j)&&(h="&nbsp;",rb&&"LI"==l.tagName&&(h="<br>"),l.innerHTML=h,
Ks(l.firstChild),h=m));n&&(g=ZC(g.T()),l=lD(g),g&&l&&(hc(g,l.childNodes),L(l)));h&&(g=bp(JD(d,c),e),g.select())}}}return WC(b,j)};a.PD=function(){},a.QD=new PD,a.RD=["click",B?"keypress":"keydown"];PD.prototype.c=function(b,c,d,e,g){function h(b){if("click"==b.type&&md(b))c.call(e,b);else if(13==b.keyCode||3==b.keyCode)b.type="keypress",c.call(e,b)}h.zj=c;h.tS=e;g?g.c(b,RD,h):N(b,RD,h)};PD.prototype.Ba=function(b,c,d,e,g){for(var h=0;d=RD[h];h++){var l;l=xd(b,d,m)||[];for(var n,q=0;n=l[q];q++)if(n.dg.zj==c&&n.dg.tS==e){g?g.Ba(b,d,n.dg):wd(b,d,n.dg);break}}};a.TD=function(b){M.call(this);this.uk=b||window;this.ls=N(this.uk,"resize",this.Rw,m,this);this.lc=Yb(this.uk);if(C&&lb||rb&&this.uk.self!=this.uk.top)this.St=window.setInterval(v(this.YB,this),SD)};y(TD,Fd);a.SD=500;t=TD.prototype;t.ls=k;t.uk=k;t.lc=k;t.St=k;t.rl=function(){return this.lc?this.lc.clone():k};t.p=function(){TD.m.p.call(this);this.ls&&(yd(this.ls),this.ls=k);this.St&&(window.clearInterval(this.St),this.St=k);this.lc=this.uk=k};t.Rw=function(){this.YB()};
t.YB=function(){var b=Yb(this.uk);Pb(b,this.lc)||(this.lc=b,this.dispatchEvent("resize"))};a.VD=function(b,c){M.call(this);this.ba=Sb(b);this.N=new le(this);this.FA=new TD(this.ba.Pa());this.md={};this.vd=this.ba.o("DIV",{className:UD});R(this.vd,m);b.appendChild(this.vd);Rf(this.vd,"zIndex",c);this.Zm=this.vd;this.HK=this.ba.o("DIV",{className:"tr_bubble_closebox",innerHTML:"&nbsp;"});this.Zm.appendChild(this.HK);jD(this.vd,this.N);this.bi=new ph(this.vd)};y(VD,Fd);a.UD="tr_bubble";t=VD.prototype;t.Nb=ke("goog.ui.editor.Bubble");
t.p=function(){VD.m.p.call(this);L(this.vd);this.vd=k;this.N.C();this.N=k;this.FA.C();this.FA=k};t.Y=p("Zm");t.Db=p("vd");t.IN=function(){this.Q()&&this.na()};t.pN=function(){for(var b in this.md)L(this.md[b].element);this.md={};D.remove(this.vd,"tr_multi_bubble");this.N.Lc();this.dispatchEvent("hide")};t.Q=function(){return this.bi.Q()};a.WD=A?4:2,a.XD=new Mf(WD,0,WD,0);
VD.prototype.na=function(){var b=k,c=j,d;for(d in this.md)var e=this.md[d],b=e.hA,c=c&&e.FR;d=496;b=cg(this.vd)!=cg(b);c&&(d=YD(this,b?7:5,4,9));d&496&&(d=YD(this,b?6:4,5,9));d&496&&(d=YD(this,b?7:5,4,5),d&496&&this.Nb.rk("reposition(): positionAtAnchor() failed with "+d))};
a.YD=function(b,c,d,e){var g=k,h;for(h in b.md){var l=b.md[h].hA;if(!g||sc(l,g))g=b.md[h].hA}return jl(g,c,b.vd,d,k,XD,e)},a.ZD=function(b,c,d,e,g,h){this.type=d;this.hA=g;this.FR=h;this.element=b.o("DIV",{className:"tr_bubble_panel",id:c},b.o("DIV",{className:"tr_bubble_panel_title"},e+":"),b.o("DIV",{className:"tr_bubble_panel_content"}))};ZD.prototype.Y=function(){return this.element.lastChild};a.$D=function(){yv.call(this);this.gc=new le(this)};y($D,yv);a.aE=function(b,c){return new VD(b,c)},a.bE={};t=$D.prototype;t.Kj=k;t.Ix=m;t.jd=jf("AbstractBubblePlugin");t.ur=function(){this.Q()&&this.ij();return m};
t.ij=function(b,c){var d;if(b)d=b.target;else if(c)d=c;else{var e=aw(this.B);if(e){var g=e.T(),h=e.ha(),l=e.ra(),n=e.Ea();A&&(e.isCollapsed()&&g!=h)&&(e=bp(g,l));1==g.nodeType&&(g==h&&l==n-1)&&(g=g.childNodes[l],1==g.nodeType&&(d=g))}d=d||e&&e.Db()}var q;a:{if(d&&(l=this.iM(d))){if(l!=this.Ct||!this.Kj){cE(this);this.$g&&bs(this.$g);d=dE(this);var r=this.gw();if(!F.some(d.md,function(b){return b.type==r})){this.Ct=l;var g=this.gw(),n=this.uD(),h=v(this.YK,this),x=this.RS(),e=db(),l=new ZD(d.ba,e,
g,n,l,!x);d.md[e]=l;n=0;for(x=d.Zm.childNodes.length-1;n<x;n++){var E=d.Zm.childNodes[n];if(d.md[E.id].type>g){q=E;break}}jc(l.element,q||d.Zm.lastChild);h(l.Y());jD(l.element,d.N);q=F.cb(d.md);1==q?(d.N.c(d.FA,"resize",d.IN).c(d.bi,"hide",d.pN),d.bi.w(j),d.na()):2==q&&D.add(d.vd,"tr_multi_bubble");d.na();this.Kj=e;this.gc.c(d,"hide",this.ND);this.$h();this.Ix&&this.gc.c(d.Y(),"keydown",this.UP);this.gc.c(d.Y(),"mouseover",function(){this.$g&&this.$g.stop()},this)}}else this.$g&&this.$g.stop();q=
m;break a}cE(this);q=m}return q};t.disable=function(b){if(b.Aj==Lv){var c=bE[b.id];c&&(c.C(),delete bE[b.id])}};a.dE=function(b){var c=b.kX||b.B.Ik.document.body;b.ba=Sb(c);var d=bE[b.B.id];d||(d=aE.call(k,c,b.B.iK||0),bE[b.B.id]=d);return d};t.gw=s("");t.uD=s("");t.RS=kf;
a.cE=function(b){if(b.Kj&&(!b.$g||!b.$g.Gb()))b.$g=new cj(function(){if(this.Kj){var b=dE(this),d=this.Kj;L(b.md[d].element);delete b.md[d];d=F.cb(b.md);1>=d&&D.remove(b.vd,"tr_multi_bubble");0==d?b.bi.w(m):b.na();this.ND()}},250,b),b.$g.start()};t.$h=ha;t.ND=function(){this.Kj=this.Ct=k;this.gc.Lc()};t.Mw=function(b){if(this.Ix&&this.Q()&&9==b.keyCode&&!b.shiftKey){var c=dE(this).Y();if(c=J("tr_bubble_link",c))return c.focus(),b.preventDefault(),j}return m};
t.UP=function(b){if(this.Q()&&9==b.keyCode){var c=dE(this).Y(),c=Vb("tr_bubble_link",c);if(b.shiftKey?c[0]==b.target:c.length&&c[c.length-1]==b.target)this.B.focus(),b.preventDefault()}};t.Q=function(){return!!this.Kj};t.na=function(){var b=dE(this);b&&b.na()};
t.Hq=function(b,c,d,e,g){c=this.ba.o("SPAN",{className:"tr_bubble_link"},g?this.ba.o("I",{className:g},c):c);this.Ix&&c.setAttribute("tabindex",0);c.setAttribute("role","link");e?e.appendChild(c):(e=this.ba.h(b))&&mc(c,e);c.id=b;jD(c,this.gc);d&&(b=this.gc,QD.c(c,d,i,b.ga||b,b));return c};w("Go to link: ");w("Change");w("Remove");a.eE=function(b){M.call(this);this.gd=b};y(eE,Fd);eE.prototype.show=function(){this.Ye||(this.Ye=this.iv(),this.Ye.addEventListener(Dh,this.sM,m,this));this.Ye.w(j)};eE.prototype.hide=function(){this.Ye&&this.Ye.w(m)};eE.prototype.qb=function(){return!!this.Ye&&this.Ye.Q()};a.fE=function(b){this.$k=b;this.ti=new uh("",j,this.$k.gd);this.bn=new Bh(this.$k.gd);this.an={};this.th("tr-dialog")};fE.prototype.Xa=function(b){this.ti.Xa(b);return this};
a.gE=function(b,c){var d=w("OK");b.bn.set("ok",c||d,j);b.an.ok=v(b.$k.lN,b.$k)},a.hE=function(b){var c=Ih,d=w("取消");b.bn.set(c,d,m,j);b.an[c]=v(b.$k.zw,b.$k);return b};fE.prototype.pe=function(b,c,d){d=d||db();this.bn.set(d,b);this.an[d]=c;return this};fE.prototype.th=function(b){D.add(wh(this.ti),b);return this};fE.prototype.La=function(b){this.ti.Y().appendChild(b);return this};
a.iE=function(b){b.bn.Hb()&&(gE(b),hE(b));Fh(b.ti,b.bn);var c=b.an;b.an=k;b.ti.addEventListener(Gh,function(b){if(c[b.key])return c[b.key](b)});zh(b.ti,j);var d=b.ti;b.ti=k;return d};t=eE.prototype;t.hw=function(b){return this.Ye.qc.hd(b)};t.lN=function(b){return(b=this.kn(b))?this.dispatchEvent(b):m};t.zw=function(){return this.dispatchEvent("cancel")};t.p=function(){this.Ye&&(this.hide(),this.Ye.C(),this.Ye=k);eE.m.p.call(this)};t.sM=function(){this.dispatchEvent("afterhide")};a.jE=function(b){yv.call(this);this.OK=b};y(jE,yv);t=jE.prototype;t.Je=function(b){return b==this.OK};t.execCommand=function(b,c){return this.bf.apply(this,arguments)};t.bf=function(b,c){this.SG||kE(this);this.sc||(this.sc=this.hv(Sb(this.B.Ik),c));var d=aw(this.B);this.pz=d&&new cD(d);Ns(this.B.hb.Pa());vd(this.sc,"afterhide",this.In,m,this);this.B.Og=j;this.sc.show();this.dispatchEvent("dialogOpened");Cv(this.B);return j};
t.In=function(){this.B.Og=m;lE(this);this.SG||kE(this);this.dispatchEvent("dialogClosed");Cv(this.B);this.B.Nq.selectionchange=za()};a.lE=function(b){b.pz&&(b.pz.restore(),b.pz=k);b.B.focus()};t.p=function(){kE(this);jE.m.p.call(this)};t.SG=m;t.yx=m;a.kE=function(b){b.sc&&!b.yx&&(b.yx=j,b.sc.C(),b.sc=k,b.yx=m)};a.mE=function(){};y(mE,mq);ia(mE);t=mE.prototype;t.K=s("goog-tab");t.tc=function(){return Vc.bB};t.o=function(b){var c=mE.m.o.call(this,b);(b=b.Yf())&&this.Nc(c,b);return c};t.n=function(b,c){var c=mE.m.n.call(this,b,c),d=this.Yf(c);d&&b.ot(d);if(b.da&8&&(d=b.getParent())&&qa(d.om))b.Zb(8,m),d.om(b);return c};t.Yf=function(b){return b.title||""};t.Nc=function(b,c){b&&(b.title=c||"")};a.nE=function(b,c,d){uq.call(this,b,c||mE.D(),d);xq(this,8,j);this.fk|=9};y(nE,uq);nE.prototype.Yf=p("xp");nE.prototype.Nc=function(b){this.L.Nc(this.h(),b);this.ot(b)};nE.prototype.ot=ca("xp");sq("goog-tab",function(){return new nE(k)});a.oE=function(){};y(oE,Cq);ia(oE);oE.prototype.K=s("goog-tab-bar");oE.prototype.tc=function(){return Vc.XI};oE.prototype.Dz=function(b,c,d){this.bF||(this.vq||pE(this),this.bF=F.ym(this.vq));var e=this.bF[c];e?(b.dp(e==qE||e==rE?Fq:Eq),b.cF=e):oE.m.Dz.call(this,b,c,d)};oE.prototype.ef=function(b){var c=oE.m.ef.call(this,b);this.vq||pE(this);c.push(this.vq[b.cF]);return c};a.pE=function(b){var c=b.K();b.vq=F.create(sE,c+"-top",tE,c+"-bottom",qE,c+"-start",rE,c+"-end")};a.vE=function(b,c,d){b=b||sE;this.dp(b==qE||b==rE?Fq:Eq);this.cF=b;Cs.call(this,this.zb,c||oE.D(),d);uE(this)};y(vE,Cs);a.sE="top",a.tE="bottom",a.qE="start",a.rE="end";t=vE.prototype;t.bK=j;t.tf=k;t.z=function(){vE.m.z.call(this);uE(this)};t.p=function(){vE.m.p.call(this);this.tf=k};t.removeChild=function(b,c){wE(this,b);return vE.m.removeChild.call(this,b,c)};t.yz=function(b){vE.m.yz.call(this,b);this.bK&&this.om(oh(this,b))};t.om=function(b){b?b.nm(j):this.tf&&this.tf.nm(m)};
a.wE=function(b,c){if(c&&c==b.tf){for(var d=fs(b,c),e=d-1;c=oh(b,e);e--)if(c.Q()&&c.isEnabled()){b.om(c);return}for(d+=1;c=oh(b,d);d++)if(c.Q()&&c.isEnabled()){b.om(c);return}b.om(k)}};t.AN=function(b){this.tf&&this.tf!=b.target&&this.tf.nm(m);this.tf=b.target};t.BN=function(b){b.target==this.tf&&(this.tf=k)};t.yN=function(b){wE(this,b.target)};t.zN=function(b){wE(this,b.target)};t.Ce=function(){Fs(this)||this.qd(this.tf||oh(this,0))};
a.uE=function(b){b.g().c(b,"select",b.AN).c(b,"unselect",b.BN).c(b,"disable",b.yN).c(b,"hide",b.zN)};sq("goog-tab-bar",function(){return new vE});a.xE=function(){yv.call(this)};y(xE,yv);xE.prototype.vr=function(b){if(B&&this.B.Og)b=m;else if(9==b.keyCode&&!b.metaKey&&!b.ctrlKey){var c=aw(this.B);Ic(c.Db(),"LI")||O.some(c,function(b){return"LI"==b.tagName})?(this.B.execCommand(b.shiftKey?"+outdent":"+indent"),b.preventDefault(),b=j):b=m}else b=m;return b};a.yE=function(){yv.call(this)};y(yE,xE);yE.prototype.jd=s("ListTabHandler");a.zE=function(b){yv.call(this);this.uP=b};y(zE,yv);t=zE.prototype;t.jd=jf("LoremIpsum");t.Xp=lf;t.Dp=m;t.queryCommandValue=function(b){return"usinglorem"==b&&this.Dp};
t.execCommand=function(b,c){if("clearlorem"==b){var d=!!c,e=this.B;if(this.Dp&&!e.Og){var g=e.h();g||(g=e.Kc);this.Dp=m;g.style.fontStyle=this.IP;e.ge(j,k,j);d&&e.Zd()&&(C?(Rb(e.h()).body.focus(),e.Vf()):rb&&fw(e))}}else"updatelorem"==b&&(d=this.B,!this.Dp&&(!d.Og&&Nv!=d.id)&&((e=d.h())||(e=d.Kc),Ls(e)&&(this.Dp=j,this.IP=e.style.fontStyle,e.style.fontStyle="italic",d.ge(j,this.uP,j))))};t.Je=function(b){return"clearlorem"==b||"updatelorem"==b||"usinglorem"==b};a.AE=function(){yv.call(this);this.iR=k};y(AE,yv);a.BE=/^(DIV|TR|LI|BLOCKQUOTE|H\d|PRE|XMP)/,a.CE=function(b){b.push("<br>")};t=AE.prototype;t.jd=s("RemoveFormatting");t.Je=function(b){return"+removeFormat"==b};t.bf=function(b){"+removeFormat"==b&&!aw(this.B).isCollapsed()&&(b=this.iR||v(this.IG,this),DE(this,b),RC(this).za().execCommand("RemoveFormat",m,i),rp&&DE(this,function(b){var d=Eb("528")?/&nbsp;/g:/\u00A0/g;return b.replace(d," ")}))};
t.vr=function(b,c,d){return!d?m:" "==c?(this.B.execCommand("+removeFormat"),j):m};
a.EE=function(b,c){for(var d=b.B.h();c&&c!=d;){if("TABLE"==c.tagName)return c;c=c.parentNode}return k},a.DE=function(b,c){var d=aw(b.B);if(!(1<d.cj())){if(B){var e=iD(d,b.B.h()),g=EE(b,e.T()),h=EE(b,e.ha());if(g||h){if(g==h)return;var l,n=d;l=g;var d=h,e=new cD(n),q=n.T(),r=n.ra(),x=n.ha(),n=n.Ea(),E=RC(b);if(l){var G=E.createTextNode("");kc(G,l);q=G;r=0}d&&(G=E.createTextNode(""),jc(G,d),x=G,n=0);Mo(q,r,x,n).select();l=e;g||(d=L(OC(l,j)),b.Vz=d);h||(d=L(OC(l,m)),b.Iv=d);d=aw(b.B);e=iD(d,b.B.h())}e.select();
d=e}q=d;d=RC(b).o("div");e=q.Vd();fp?d.appendChild(e.cloneContents()):ep&&(r=q.Jc(),r=r.replace(/\r\n/g,"\r"),x=r.length,q=x-r.replace(/^[\s\xa0]+/,"").length,r=x-La(r).length,e.moveStart("character",q),e.moveEnd("character",-r),q=e.htmlText,"Formatted"==e.queryCommandValue("formatBlock")&&(q=Ma(e.htmlText)),d.innerHTML=q);q=c(d.innerHTML);E=aw(b.B);d=RC(b);r=db();e=db();q='<span id="'+r+'"></span>'+q+'<span id="'+e+'"></span>';n=db();x='<span id="'+n+'"></span>';if(ep){G=E.Be(0).Vd();G.pasteHTML(x);
for(var I;(I=G.parentElement())&&Ls(I)&&!bD(I);){E=I.nodeName;if("TD"==E||"TR"==E||"TH"==E)break;L(I)}G.pasteHTML(q);(n=d.h(n))&&L(n)}else if(fp){d.za().execCommand("insertImage",m,n);E=RegExp("<[^<]*"+n+"[^>]*>");I=aw(b.B).Db();3==I.nodeType&&(I=I.parentNode);for(;!E.test(I.innerHTML);)I=I.parentNode;if(B)I.innerHTML=I.innerHTML.replace(E,q);else{I.innerHTML=I.innerHTML.replace(E,x);for(I=n=d.h(n);(I=n.parentNode)&&Ls(I)&&!bD(I);){E=I.nodeName;if("TD"==E||"TR"==E||"TH"==E)break;kc(n,I);L(I)}I.innerHTML=
I.innerHTML.replace(RegExp(x,"i"),q)}}I=d.h(r);d=d.h(e);Mo(I,0,d,d.childNodes.length).select();L(I);L(d);B&&l&&(d=aw(b.B),I=b.B.h(),b.Vz&&(I.insertBefore(b.Vz,I.firstChild),b.Vz=k),b.Iv&&(I.appendChild(b.Iv),b.Iv=k),I=k,e=OC(l,j),q=OC(l,m),e&&q&&(I=Mo(e,0,q,0)),TC((g?I:d).T(),(g?I:d).ra(),(h?I:d).ha(),(h?I:d).Ea()).select(),l.C())}};
t.IG=function(b){var c=document.createElement("div");c.innerHTML=b;for(var b=[],c=[c.childNodes,0],d=[],e=0,g=[],h=0,l=0;0<=l;l-=2){for(var n=m;0<h&&l<=g[h-1];)h--,n=j;n&&CE(b);for(n=m;0<e&&l<=d[e-1];)e--,n=j;n&&CE(b);for(var n=c[l],q=c[l+1];q<n.length;){var r=n[q++],x=r.nodeName;switch(x){case "#text":r=0<e?r.nodeValue:Ha(r.nodeValue);r=Ua(r);b.push(r);continue;case "P":CE(b);CE(b);break;case "BR":CE(b);continue;case "TABLE":CE(b);g[h++]=l;break;case "PRE":case "XMP":d[e++]=l;break;case "STYLE":case "SCRIPT":case "SELECT":continue;
case "A":if(r.href&&""!=r.href){b.push("<a href='");b.push(r.href);b.push("'>");b.push(this.IG(r.innerHTML));b.push("</a>");continue}else break;case "IMG":b.push("<img src='");b.push(r.src);b.push("'");"0"==r.border&&b.push(" border='0'");b.push(">");continue;case "TD":r.previousSibling&&b.push(" ");break;case "TR":r.previousSibling&&CE(b);break;case "DIV":var E=r.parentNode;if(E.firstChild==r&&BE.test(E.tagName))break;default:BE.test(x)&&CE(b)}r=r.childNodes;0<r.length&&(c[l++]=n,c[l++]=q,n=r,q=
0)}}return b.join("").replace(/\xa0|[ \t]+/g," ")};a.FE=function(b){this.DB=b};y(FE,Fd);a.GE=function(){M.call(this);this.oP=100;this.Id=[];this.Sj=[];this.Hs=[]};y(GE,Fd);t=GE.prototype;t.Ir=k;t.vA=function(){HE(this,this.Id,this.Sj)};t.az=function(){HE(this,this.Sj,this.Id)};a.HE=function(b,c,d){if(c.length){var e=c.pop();d.push(e);b.Hs.push({type:c==b.Id?"before_undo":"before_redo",sD:c==b.Id?e.vA:e.az,state:e});1==b.Hs.length&&b.Hg();(0==c.length||1==d.length)&&b.dispatchEvent("state_change")}};
t.Hg=function(){if(!(this.Ir||0==this.Hs.length)){var b=this.Hs.shift();this.dispatchEvent({type:b.type,state:b.state})&&(b.state.DB?(this.Ir=N(b.state,"action_completed",this.SL,m,this),b.sD.call(b.state)):(b.sD.call(b.state),this.Hg()))}};t.SL=function(){yd(this.Ir);this.Ir=k;this.Hg()};a.IE=function(b){yv.call(this);b=b||new GE;this.eF&&yd(this.eF);this.ie=b;this.eF=N(this.ie,"state_change",this.AL,m,this);this.Wi={};this.pn={};this.pE=k;this.kK=v(this.lS,this)};y(IE,yv);IE.prototype.Nb=ke("goog.editor.plugins.UndoRedo");IE.prototype.Qn=k;a.JE=F.ym({RW:"+undo",hW:"+redo"});t=IE.prototype;t.Je=function(b){return b in JE};t.VH=function(b){this.disable(b);this.B=k};
t.enable=function(b){if(!this.isEnabled(b)){bw(b);var c=new le(this);B||c.c(b,"beforechange",this.uM);c.c(b,Hv,this.BM);c.c(b,"blur",this.yw);this.Wi[b.Ng]=c;KE(this,b)}};t.disable=function(b){bw(b);var c=this.Wi[b.Ng];c&&(c.C(),delete this.Wi[b.Ng]);this.pn[b.Ng]&&delete this.pn[b.Ng]};t.isEnabled=function(b){return!!this.Wi[b.Ng]};t.p=function(){IE.m.p.call(this);for(var b in this.Wi)this.Wi[b].C(),delete this.Wi[b];this.B=k;this.ie&&(this.ie.C(),delete this.ie)};t.jd=s("UndoRedo");
t.execCommand=function(b){"+undo"==b?this.ie.vA():"+redo"==b&&this.ie.az()};t.queryCommandValue=function(b){var c=k;"+undo"==b?c=0<this.ie.Id.length:"+redo"==b&&(c=0<this.ie.Sj.length);return c};t.AL=function(){this.B.dispatchEvent({type:"cvc",PK:["+redo","+undo"]})};
t.lS=function(b,c,d){var e=this.B;if(e){Bv(e,j,j);try{e.Fh();e.execCommand("clearlorem",j);e.h().innerHTML=c;d&&d.select();var g=this.B;e.focus();g&&g.Ng!=b.An&&g.execCommand("updatelorem");var h=this.pn[b.An];h.oi=c;h.TH=d}catch(l){this.Nb.log(ae,"Error while restoring undo state",l)}finally{this.Qn=b,e.Ze(),Cv(e)}}};
t.vr=function(b,c,d){if(d){var e;"z"==c?e=b.shiftKey?"+redo":"+undo":"y"==c&&(e="+redo");if(e)return(b="+undo"==e?this.ie.Id[this.ie.Id.length-1]:this.ie.Sj[this.ie.Sj.length-1])&&b.An?this.B.execCommand(e):this.execCommand(e),j}return m};t.uM=function(b){if(!this.Qn){var b=b.target,c=b.Ng;this.pE!=c&&(this.pE=c,KE(this,b))}};t.BM=function(b){this.Qn?(b=this.Qn,this.Qn=k,b.dispatchEvent("action_completed")):KE(this,b.target)};t.yw=function(b){(b=b.target)&&bw(b)};
a.KE=function(b,c){var d=c.Ng,e,g;c.queryCommandValue("usinglorem")?(e="",g=k):(e=c.h().innerHTML,g=new LE(c),g=!g.vj()?k:g);var h=b.pn[d];if(h){if(h.oi==e)return;if(""==e||""==h.oi){var l=c.Ts(8,"",{});if(e==l&&""==h.oi||h.oi==l&&""==e)return}h.bz=e;h.QR=g;l=b.ie;if(0==l.Id.length||!h.Ui(l.Id[l.Id.length-1])){l.Id.push(h);l.Id.length>l.oP&&l.Id.shift();var n=l.Sj.length;l.Sj.length=0;l.dispatchEvent({type:"state_added",state:h});(1==l.Id.length||n)&&l.dispatchEvent("state_change")}}b.pn[d]=new ME(d,
e,g,b.kK)},a.ME=function(b,c,d,e){this.DB=j;this.An=b;this.QG=e;this.oi=c;this.TH=d};y(ME,FE);ME.prototype.vA=function(){this.QG(this,this.oi,this.TH)};ME.prototype.az=function(){this.QG(this,this.bz,this.QR)};ME.prototype.Ui=function(b){return this.An==b.An&&this.oi==b.oi&&this.bz==b.bz};
a.LE=function(b){this.Td=b;var c=b.hb.Pa(),b=(b=aw(b))&&b.bg()&&b.Pa()==c?b:k;if(fp){if(c=b,this.Yr=m,c){var d=lo(c),e=mo(c);if(d&&e){var b=c.Uh()?c.Ea():c.ra(),d=new ID(d,this.Td.h()),g=no(c),e=new ID(e,this.Td.h());c.Uh()?(this.ya=e,this.Wz=g,this.wa=d,this.Jv=b):(this.ya=d,this.Wz=b,this.wa=e,this.Jv=g);this.Yr=j}}}else ep&&(c=b,this.Yr=m,c&&(b=c.Be(0).Vd(),sc(this.Td.h(),b.parentElement())&&(c=this.Td.hb.za().body.createTextRange(),c.moveToElementText(this.Td.h()),e=b.duplicate(),e.collapse(j),
e.setEndPoint("StartToStart",c),this.ya=NE(e),b=b.duplicate(),b.setEndPoint("StartToStart",c),this.wa=NE(b),this.Yr=j)))};LE.prototype.vj=p("Yr");LE.prototype.toString=function(){return fp?"W3C:"+this.ya.toString()+"\n"+this.Wz+":"+this.wa.toString()+"\n"+this.Jv:"IE:"+this.ya+","+this.wa};LE.prototype.select=function(){var b=this.Ae(this.Td.h());b&&(ep&&this.Td.h().focus(),ap(b).select())};
LE.prototype.Ae=function(b){if(fp){var c=JD(this.ya,b),b=JD(this.wa,b);return!c||!b?k:Mo(c,this.Wz,b,this.Jv).Vd()}c=b.ownerDocument.body.createTextRange();c.moveToElementText(b);c.collapse(j);c.moveEnd("character",this.wa);c.moveStart("character",this.ya);return c};
a.NE=function(b){var c=b.duplicate(),d=b.text,e=d.length;c.collapse(j);c.moveEnd("character",e);for(var g,h=10;(g=c.compareEndPoints("EndToEnd",b))&&!(e-=g,c.moveEnd("character",-g),--h,0==h););b=0;for(c=d.indexOf("\n\r");-1!=c;)++b,c=d.indexOf("\n\r",c+1);return e+b};a.OE=function(b,c){Bq.call(this,b||Rz.D(),c)};y(OE,Bq);sq("goog-toolbar-separator",function(){return new OE});a.QE=function(b,c){M.call(this);this.ga=new le(this);this.Td=b;this.vb=c;this.Xy=[];mh(this.vb,function(b){b.eb&&this.Xy.push(PE(b.Wd()))},this);this.vb.Qe(m);this.ga.c(this.Td,"cvc",this.eU).c(this.vb,"action",this.ww)};y(QE,Fd);a.PE=function(b){return b};t=QE.prototype;t.g=p("ga");t.lr=p("Td");t.Q=function(){return this.vb.Q()};t.w=function(b){this.vb.w(b)};t.isEnabled=function(){return this.vb.isEnabled()};t.gb=function(b){this.vb.gb(b)};t.blur=function(){this.vb.Uc(k)};
t.p=function(){QE.m.p.call(this);this.ga&&(this.ga.C(),delete this.ga);this.vb&&(this.vb.C(),delete this.vb);delete this.Td;delete this.Xy};t.eU=function(b){if(this.vb.isEnabled()&&this.dispatchEvent("change")){var c;try{c=this.Td.queryCommandValue(b.PK||this.Xy)}catch(d){c={}}var b=c,e;for(e in b)if(c=kh(this.vb,e)){var g=b[e];c.pi?c.pi(g):c.Zc(!!g)}}};t.ww=function(b){var c=b.target.Wd();this.Td.execCommand(c,b.target.U())};a.RE=function(b){this.OL=b};y(RE,gd);RE.prototype.type="ok";a.SE=function(b){gd.call(this,"change");this.vj=b};y(SE,gd);a.TE=function(b){return!b?"":"//www.zhihu.com/equation?tex="+encodeURIComponent(b)};a.UE=function(b){T.call(this,b)};y(UE,T);UE.prototype.jj="";UE.prototype.w=function(b){R(this.h(),b)};a.WE=function(b,c,d,e,g,h,l,n){this.ni=c;this.rh=l||[];for(var c=n||VE.D(),n=[],d=-d,e=-e,q=0;q<l.length;q++)n.push(K("DIV",{"class":c.K()+"-item",style:"width:"+g+"px;height:"+h+"px;background-position:"+d+"px "+e+"px;"})),d-=g;this.hg=b;fA.call(this,n,c)};y(WE,fA);WE.prototype.Oh=p("ni");WE.prototype.Zf=function(b){WE.m.Zf.call(this,b);this.hg.dispatchEvent(new XE(YE,this))};WE.prototype.Ph=function(b){WE.m.Ph.call(this,b);b.relatedTarget&&!sc(this.h(),b.relatedTarget)&&this.hg.qv()};
WE.prototype.kd=function(b){WE.m.kd.call(this,b);b.relatedTarget&&!sc(this.h(),b.relatedTarget)&&this.hg.rv.stop()};a.XE=function(b,c,d){gd.call(this,b,d);this.pR=c},a.YE="a";XE.prototype.pw=p("pR");a.VE=function(){};y(VE,Yz);ia(VE);VE.prototype.K=s("ee-palette");a.ZE=function(b){WE.call(this,b,"a",0,150,18,18,"\\leftarrow \\rightarrow \\leftrightarrow \\Leftarrow \\Rightarrow \\Leftrightarrow \\uparrow \\downarrow \\updownarrow \\Uparrow \\Downarrow \\Updownarrow".split(" "));jA(this,new Ob(12,1))};y(ZE,WE);a.$E=function(b){WE.call(this,b,"c",0,70,18,18,"\\leq \\geq \\prec \\succ \\preceq \\succeq \\ll \\gg \\equiv \\sim \\simeq \\asymp \\approx \\ne \\subset \\supset \\subseteq \\supseteq \\in \\ni \\notin".split(" "));jA(this,new Ob(7,3))};y($E,WE);a.aF=function(b){WE.call(this,b,"g",0,30,18,18,"\\alpha \\beta \\gamma \\delta \\epsilon \\varepsilon \\zeta \\eta \\theta \\vartheta \\iota \\kappa \\lambda \\mu \\nu \\xi \\pi \\varpi \\rho \\varrho \\sigma \\varsigma \\tau \\upsilon \\phi \\varphi \\chi \\psi \\omega \\Gamma \\Delta \\Theta \\Lambda \\Xi \\Pi \\Sigma \\Upsilon \\Phi \\Psi \\Omega".split(" "));jA(this,new Ob(7,6))};y(aF,WE);a.bF=function(b){WE.call(this,b,"m",0,90,30,56,"x_{a};x^{b};x_{a}^{b};\\bar{x};\\tilde{x};\\frac{a}{b};\\sqrt{x};\\sqrt[n]{x};\\bigcap_{a}^{b};\\bigcup_{a}^{b};\\prod_{a}^{b};\\coprod_{a}^{b};\\left( x \\right);\\left[ x \\right];\\left{ x \\right};\\left| x \\right|;\\int_{a}^{b};\\oint_{a}^{b};\\sum_{a}^{b}{x};\\lim_{a \\rightarrow b}{x}".split(";"));jA(this,new Ob(10,2))};y(bF,WE);a.dF=function(b){WE.call(this,b,"mn",0,0,46,18,["g","s","c","m","a"],cF.D());jA(this,new Ob(5,1))};y(dF,WE);dF.prototype.w=function(b,c){return dF.m.w.call(this,j,c)};a.cF=function(){};y(cF,VE);ia(cF);cF.prototype.K=s("ee-menu-palette");a.eF=function(b){WE.call(this,b,"s",0,50,18,18,"\\times \\div \\cdot \\pm \\mp \\ast \\star \\circ \\bullet \\oplus \\ominus \\oslash \\otimes \\odot \\dagger \\ddagger \\vee \\wedge \\cap \\cup \\aleph \\Re \\Im \\top \\bot \\infty \\partial \\forall \\exists \\neg \\angle \\triangle \\diamond".split(" "));jA(this,new Ob(7,5))};y(eF,WE);a.fF=function(){M.call(this);this.iG={};this.Jm=k;this.N=new le(this);this.rv=new Hd(300);this.N.c(this.rv,Id,this.DD)};y(fF,Fd);t=fF.prototype;t.pw=function(b){var c=this.iG,d=c[b];if(!d){switch(b){case "mn":d=new dF(this);break;case "g":d=new aF(this);break;case "s":d=new eF(this);break;case "c":d=new $E(this);break;case "m":d=new bF(this);break;case "a":d=new ZE(this);break;default:f(Error("Invalid palette type!"))}c[b]=d}return d};
t.setActive=function(b){var c=this.Jm;c&&c.w(m);this.Jm=c=this.pw(b);c.w(j);return c};t.qv=function(){this.rv.start()};t.DD=function(){this.setActive("mn")};t.p=function(){fF.m.p.call(this);this.iG=this.Jm=k};a.gF=function(b,c,d){T.call(this,d);this.jj=c;this.hg=b.oR};y(gF,UE);t=gF.prototype;t.OE="";t.Uu=0;
t.o=function(){var b=w("TeX 公式"),c=w("预览"),d=w("Learn more"),e=this.ba,d=e.o("DIV",{style:"display: none;"},e.o("SPAN",{"class":"ee-section-title ee-section-title-floating"},b),this.jj?e.o("A",{id:"ee-section-learn-more",target:"_blank",href:this.jj},d):k,e.o("DIV",{style:"clear: both;"}),b=this.pO=e.o("DIV",{style:"position: relative"}));this.hg.setActive("mn").W(b);b.appendChild(e.o("DIV",{style:"clear:both"}));var g=this.lh=e.o("textarea",{"class":"ee-tex",dir:"ltr"});b.appendChild(g);b.appendChild(e.o("DIV",
{"class":"ee-section-title"},c));c=this.HR=e.o("DIV",{"class":"ee-preview-container"});b.appendChild(c);this.e=d};t.z=function(){this.FH=new pu(this.lh);N(this.FH,"input",this.QD,m,this);this.g().c(this.lh,"keydown",this.QD);this.g().c(this.hg,YE,this.oN,m,this)};t.w=function(b){gF.m.w.call(this,b);b&&Jd(this.YL,0,this)};t.YL=function(){this.lh.focus();Zr(this.lh,this.lh.value.length)};
a.hF=function(b){var c=b.ml();if(c!=b.OE){b.OE=c;var d=!(1024<c.length);b.dispatchEvent(new SE(d));var b=b.HR,e=Sb(b);e.Ws(b);c&&(d?c=e.o("IMG",{src:TE(c)}):(c=w("Equation is too long"),c=e.o("DIV",{"class":"ee-warning"},c)),e.appendChild(b,c))}};t.QD=function(){this.Uu++;Jd(v(this.CN,this,this.Uu),500)};t.CN=function(b){b==this.Uu&&hF(this)};
t.oN=function(b){var c=b.pw(),d=this.hg,e=d.Jm,b=this.lh;if("mn"==c.Oh()){var g=c.pb,g=-1!=g?0<=g&&g<c.rh.length?c.rh[g]:k:k;if(e!=c&&e.Oh()==g){d.DD();return}g&&(c=this.hg.setActive(g),c.h()||c.W(this.pO),c=c.h(),Yf(c,0,-c.clientHeight))}else{e=this.hg.Jm;g=0<=e.pb&&e.pb<e.rh.length?e.rh[e.pb]:k;if(!g)return;Jd(v(this.xO,this,g+" "),0)}b.focus()};t.xO=function(b){var c=this.lh,d=sm(c),e=c.value,e=e.substring(0,d)+b+e.substring(d);c.value=e;Zr(c,d+b.length);hF(this)};t.ml=function(){return this.lh.value};
t.wz=function(b){this.lh.value=b;hF(this)};t.p=function(){this.FH.C();this.hg=k;gF.m.p.call(this)};a.iF=function(b,c,d){T.call(this,d);this.lC=b;this.jj=c};y(iF,T);t=iF.prototype;t.mh=k;t.o=function(){iF.m.o.call(this);this.Fq()};t.Fq=function(){var b=this.h();this.mh=new gF(this.lC,this.jj,this.ba);this.M(this.mh);this.mh.W(b);this.mh.w(j)};t.ea=function(b){this.e=b;this.Fq()};t.ml=function(){return this.mh.ml()};t.wz=function(b){this.mh.wz(b)};t.mw=function(){var b=this.ml(),c=TE(b);return!c?"":'<img src="'+c+'" alt="'+Ua(b)+'" class="ee_img tr_noresize" eeimg="1" style="vertical-align: middle">'};
t.vj=function(){return 1024<this.ml().length};t.w=function(b){this.mh.w(b)};t.p=function(){this.mh&&this.mh.C();this.lC=k;iF.m.p.call(this)};a.jF=function(b,c,d,e){eE.call(this,c);this.Vi=new iF(b,e);this.Vi.W();this.Vi.wz(d);this.Vi.addEventListener("+equation",this.Bo,m,this)};y(jF,eE);jF.prototype.iv=function(){var b=new fE(this),c=w("公式编辑器"),d=w("插入公式"),e=w("保存"),d=this.Vi.ml()?e:d;gE(hE(b.Xa(c).La(this.Vi.h())),d);return iE(b)};jF.prototype.kn=function(){if(this.Vi.vj())return k;var b=this.Vi.mw();return new RE(b)};jF.prototype.Bo=function(b){this.EF||(this.EF=this.hw("ok"));this.EF.disabled=!b.vj};a.kF=function(b){this.jj=b||"";jE.call(this,"+equation")};y(kF,jE);t=kF.prototype;t.Aa=ke("goog.editor.plugins.EquationEditorPlugin");t.jd=jf("EquationEditorPlugin");t.hv=function(b,c){var d=c||k,e;d?(e=d.getAttribute("alt"),e||(e=d.getAttribute("src"),e=!e?"":decodeURIComponent(e.match(ue)[6]||k).slice(4)||"")):e="";this.hG=d;d={};d.oR=new fF;d=new jF(d,b,e,this.jj);d.addEventListener("ok",this.gj,m,this);return d};t.enable=function(b){kF.m.enable.call(this,b)};
t.disable=function(b){kF.m.disable.call(this,b)};t.gj=function(b){lE(this);this.B.Fh();b=ec(RC(this).Ca,b.OL);if(this.hG)mc(b,this.hG);else{var c=aw(this.B);c.isCollapsed()||c.Yc();b=c.insertNode(b,m)}Yr(b,m);this.B.Ze()};a.lF=function(){$D.call(this)};y(lF,$D);w("Equation:");a.mF=w("Edit"),a.nF=w("Remove");t=lF.prototype;t.jd=s("EquationBubble");t.iM=function(b){return b&&"IMG"==b.nodeName&&(b.getAttribute("eeimg")||D.has(b,"ee_img"))?b:k};t.YK=function(b){this.Hq("ee_bubble_edit",mF,this.FL,b,"zg-icon zg-icon-pen");this.Hq("ee_remove_remove",nF,this.WR,b,"zg-icon zg-icon-trash")};t.gw=s("IMG");t.uD=function(){return w("Equation")};t.WR=function(){this.B.Fh();L(this.Ct);cE(this);this.B.Ze()};
t.FL=function(){var b=this.Ct;cE(this);this.B.execCommand("+equation",b)};a.oF=function(b){yv.call(this);this.AA="http://upload."+Bg.em+":"+location.port+"/upload";F.extend(this.F={},this.R,b||{})};y(oF,yv);t=oF.prototype;t.R={AY:ha};t.jd=jf("FastUpload");
t.enable=function(b){if(!this.isEnabled(b)&&!(!window.URL&&!window.webkitURL||!window.FileReader||!window.FormData||!document.addEventListener)){$.fn.draghover=function(){return this.each(function(){var b=$(),c=$(this),d=j;c.on("dragenter",function(l){l=l.originalEvent;0===b.size()&&(d&&z.contains(l.dataTransfer.types,"Files"))&&c.trigger("draghoverstart",l);b=b.add(l.target)});c.on("dragleave",function(l){setTimeout(function(){b=b.not(l.target);0===b.size()&&d&&c.trigger("draghoverend",l)},1)});
c.on("dragstart",function(){d=m});c.on("drop dragend",function(){b=$();c.trigger("draghoverend");d=j})})};this.JA=$(this.B.h());var c=RC(this),d=$('<div class="editable-dropzone"><div class="row"><div class="cell"><div>拖拽至此处上传</div></div></div></div>');c.tx(d[0],this.B.h());c=this.sI=d;new le(this);b.h().addEventListener("paste",v(this.Pw,this));document.addEventListener("dragover",v(this.NM,this),m);c.on("dragover",v(this.MM,this));c.get(0).addEventListener("drop",v(this.sr,this),m);$(window).draghover().on({draghoverstart:v(this.FD,
this),draghoverend:v(this.OM,this)});c.draghover().on({draghoverstart:v(this.GM,this),draghoverend:v(this.FD,this)})}};t.NM=function(b){z.contains(b.dataTransfer.types,"Files")&&(b.dataTransfer.dropEffect="none",b.preventDefault())};t.MM=function(b){b=b.originalEvent;b.dataTransfer.dropEffect="copy";b.preventDefault();b.stopPropagation()};t.FD=function(b){b.preventDefault();b.stopPropagation();pF(this,1)};t.GM=function(b){pF(this,2);b.stopPropagation()};
t.OM=function(b){b.preventDefault();pF(this,0)};a.pF=function(b,c){var d=[{display:"none"},{display:"table",width:b.JA.width(),height:b.JA.height(),"background-color":"rgba(255, 255, 255, 0.5)"}];d[2]=$.extend({},d[1],{"background-color":"rgba(245, 245, 245, 0.5)"});b.sI.css(d[c])};t.Pw=function(b){var c=this;b.clipboardData&&z.contains(b.clipboardData.types,"Files")&&z.forEach(b.clipboardData.items,function(d){-1<d.type.indexOf("image")&&(qF(c,d.getAsFile()),b.preventDefault())})};
t.sr=function(b){var c=this;c.B.execCommand("clearlorem");var d=b.dataTransfer.files;document.createElement("img");b.preventDefault();var e=[];z.forEach(d,function(b){-1<b.type.indexOf("image")?(qF(c,b),e.push(j)):e.push(m)});z.every(e,function(b){return!b})&&U("文件类型不支持！");pF(c,0)};
a.qF=function(b,c){var d=new FormData;d.append("via","xhr2");d.append("upload_file",c);var e;e=$.ajaxSettings.xhr();e.withCredentials=j;var g=$.ajax({url:b.AA,data:d,processData:m,contentType:m,xhr:function(){return e},type:"POST"}).done(function(b){"string"===$.type(b)&&(b=JSON.parse(b));if(1===b.code)U(b.msg);else{var c=new Image;c.src=b.msg[0];c.setAttribute("originImgSrc",c.src.replace("_m.jpg","_r.jpg"));c.setAttribute("data-rawWidth",b.msg[1]);c.setAttribute("data-rawHeight",b.msg[2]);g.NA.after(c)}}).fail(function(){U("上传失败！>_<")}).always(function(){g.NA.remove()}),
d=g,h;h=RC(b);var l=h.o("IMG",{"class":"",style:"display:block",src:"/static/img/spinner2.gif"}),n=aw(b.B);!n||!hD(n)||!sc(b.B.h(),n.Db())?Ls(b.B.field)?lc(b.B.h(),l,0):b.B.h().appendChild(l):n.lg(l);A||(Yr(l,m),h.Pa().focus());Bv(b.B);h=$(l);d.NA=h};a.rF={},a.xF=function(b,c,d){function e(b){nc(b)}function g(c,d){for(;c!==b;){if(d(c))return c;c=c.parentNode}return k}function h(b){return b.tagName&&b.tagName===c}b||f("Missing Editable Container");c||(c="blockquote");var c=c.toUpperCase(),l=$o();if(l&&sF(b,lo(l))&&sF(b,mo(l))){var n=TC(l.T(),l.ra(),l.ha(),l.Ea()),q;if(l.isCollapsed())q=[];else{var r=l.uc(),x=l.T(),E=l.ha();q=r.childNodes;var G=function(b){return x!==r&&!sF(b,x)},I=function(b){return!(b.previousSibling&&sF(b.previousSibling,E))};
q=O.toArray(1===q.length?q:O.gA(O.EL(q,G),I))}var G=l.Db(),I=g(G,h),Q=z.reduce(q,function(b,d){1===d.nodeType&&(h(d)?b.push(d):b.push.apply(b,z.toArray(d.getElementsByTagName(c))));return b},[]),X;if(I){if(d)return tF.gu;nc(I)}else if(Q.length){if(d)return tF.gu;z.forEach(Q,e)}else{if(d)return tF.XA;if(d=g(G,function(b){return z.contains(uF,b.tagName.toLowerCase())}))X=document.createElement(c),d.parentNode.insertBefore(X,d),X.appendChild(d);else if(l.T()!==l.ha())X=document.createElement(c),q[0].parentNode.insertBefore(X,
q[0]),z.forEach(q,function(b){X.appendChild(b)});else{n=c;vF.$I?document.execCommand("formatBlock",m,n):(d=$o(),l=d.uc(),ra(l)&&1==l.nodeType&&Ls(l)?(n=document.createElement(n),l===b?l.appendChild(n):mc(n,l),(C||B)&&n.appendChild(document.createElement("br")),Ks(n)):(d=d.ha(),d=Hc(d,function(b){return kD(b.parentNode)||YC(b.parentNode)},j),l=O.gA(new is(d,j,j),of(wF)),d=O.gA(new is(d,m,m),of(wF)),l=O.toArray(l).reverse().concat(O.toArray(d)),l.length&&(n=document.createElement(n),d=z.rf(l),(q=d.nextSibling)&&
(q&&"BR"===q.tagName)&&L(q),kc(n,d),hc(n,l),(C||B)&&n.appendChild(document.createElement("br")),Yr(n.lastChild))));return}}n&&(l=function(c,d){return c&&sF(b,c)&&Tr(c)>=d},l(n.T(),n.ra())&&l(n.ha(),n.Ea())&&n.select())}else if(d)return tF.XA},a.wF=function(b){return b&&"BR"===b.tagName||kD(b)||YC(b)},a.sF=function(b,c){return 3===b.nodeType?b===c:b.contains(3===c.nodeType?c.parentNode:c)},a.uF=["ul","ol","dl","table"],a.tF={gu:1,XA:0},a.vF=rF;vF.$I=!A;vF.toggle=xF;
vF.Xd=function(b,c){return xF(b,c,j)};vF.WI=tF;a.yF=function(){yv.call(this)};y(yF,yv);t=yF.prototype;t.jd=jf("Blockquote");t.Je=function(b){return"+blockquote"===b};t.bf=function(b){this.Je(b)&&rF.toggle(this.B.h())};t.queryCommandValue=function(){return rF.WI.gu===rF.Xd(this.B.h())};t.Mw=function(b){if(13===b.keyCode)return this.Gw(b)};t.Hz=function(b,c){return zF(b,c).Hz};
a.zF=function(b,c){function d(b,c){return{Hz:b,BF:c}}C&&(b.normalize(),c=$o());var e,g=c;e=g.ha();var h=g.Ea(),g=g.uc(),l=g.childNodes.length;3!==e.nodeType&&l&&(e=g.childNodes[h===l?l-1:h]);if(!e)return d(m,k);if(Ls(b))return d(j,b);for(h=e;h!==b;){if(lD(h))return d(m,k);h=h.parentNode}return e&&"BR"===e.tagName&&e.previousSibling&&"BR"===e.previousSibling.tagName?d(j,e):(e=c.Db())&&1===e.nodeType&&(!e.childNodes.length||Ls(e))?d(j,e):d(m,k)};
t.Gw=function(b){var c=aw(this.B);if(c.isCollapsed()){var d;a:{d=c.ha();for(var e=this.B.field;d!==e;){if("BLOCKQUOTE"===d.tagName)break a;d=d.parentNode}d=i}if(d&&(c=zF(d,c),c.Hz)){b.preventDefault();b=document.createElement("div");kc(b,d);if(C||B)(d=(d=d.nextSibling)&&"BR"===d.tagName&&d)||(d=document.createElement("br")),b.appendChild(d);bp(b,0).select();c.BF&&L(c.BF)}}};FB["+blockquote"]={eb:j,P:"引用内容",ua:"+blockquote",Ja:"tr-icon tr-blockquote",factory:GA};a.AF=function(b,c){this.fb=b;this.CA=!c};
AF.prototype.ci=function(b,c,d){var e,g=[];if(""!=b){e=$a(b);var h=RegExp("(^|\\W+)"+e,"i");O.some(this.fb,function(b){String(b).match(h)&&g.push(b);return g.length>=c})}e=g;if(0==e.length&&this.CA){var l=[];O.forEach(this.fb,function(c,d){var e=b.toLowerCase(),g=String(c).toLowerCase(),h=0;if(-1!=g.indexOf(e))h=parseInt((g.indexOf(e)/4).toString(),10);else for(var n=e.split(""),Q=-1,X=10,na=0,Xa;Xa=n[na];na++)Xa=g.indexOf(Xa),Xa>Q?(Q=Xa-Q-1,Q>X-5&&(Q=X-5),h+=Q,Q=Xa):(h+=X,X+=5);h<6*e.length&&l.push({lT:c,
WG:h,index:d})});l.sort(function(b,c){var d=b.WG-c.WG;return 0!=d?d:b.index-c.index});e=[];for(var n=0;n<c&&n<l.length;n++)e.push(l[n].lT)}d(b,e)};a.BF=function(b){T.call(this);F.extend(this.F={},this.R,b||{});this.Bc=k};y(BF,T);
a.CF=[["ABAP",["abap"]],["ActionScript",["as","actionscript"]],["Ada",["ada","ada95ada2005"]],["ANTLR",["antlr"]],["ApacheConf",["apacheconf","aconf","apache"]],["AppleScript",["applescript"]],["AspectJ",["aspectj"]],["Asymptote",["asy","asymptote"]],["AutoHotkey",["ahk"]],["Awk",["awk","gawk","mawk","nawk"]],["BBCode",["bbcode"]],["Base Makefile",["basemake"]],["Bash",["bash","sh","ksh"]],["Batchfile",["bat"]],["Befunge",["befunge"]],["BlitzMax",["blitzmax","bmax"]],["Boo",["boo"]],["Brainfuck",
["brainfuck","bf"]],["Bro",["bro"]],["BUGS",["bugs","winbugs","openbugs"]],["C",["c"]],["CMake",["cmake"]],["c-objdump",["c-objdump"]],["aspx-cs",["aspx-cs"]],["C#",["csharp","c#"]],["Ceylon",["ceylon"]],["CFEngine3",["cfengine3","cf3"]],["Cheetah",["cheetah","spitfire"]],["Clojure",["clojure","clj"]],["CoffeeScript",["coffee-script","coffeescript"]],["Coldfusion HTML",["cfm"]],["cfstatement",["cfs"]],["Common Lisp",["common-lisp","cl"]],["Coq",["coq"]],["C++",["cpp","c++"]],["cpp-objdump",["cpp-objdump",
"c++-objdumb","cxx-objdump"]],["Croc",["croc"]],["CSS",["css"]],["CUDA",["cuda","cu"]],["Cython",["cython","pyx"]],["D",["d"]],["d-objdump",["d-objdump"]],["Darcs Patch",["dpatch"]],["Dart",["dart"]],["Delphi",["delphi","pas","pascal","objectpascal"]],["dg",["dg"]],["Diff",["diff","udiff"]],["Django/Jinja",["django","jinja"]],["DTD",["dtd"]],["Duel","duel;Duel Engine;Duel View;JBST;jbst;JsonML+BST".split(";")],["Dylan",["dylan"]],["ECL",["ecl"]],["eC",["ec"]],["Erlang",["erlang"]],["Elixir",["elixir",
"ex","exs"]],["ERB",["erb"]],["Evoque",["evoque"]],["FSharp",["fsharp"]],["Factor",["factor"]],["Fancy",["fancy","fy"]],["Fantom",["fan"]],["Felix",["felix","flx"]],["Fortran",["fortran"]],["GLSL",["glsl"]],["GAS",["gas"]],["Genshi",["genshi","kid","xml+genshi","xml+kid"]],["Gettext Catalog",["pot","po"]],["Gherkin",["Cucumber","cucumber","Gherkin","gherkin"]],["Gnuplot",["gnuplot"]],["Go",["go"]],["GoodData-CL",["gooddata-cl"]],["Gosu",["gosu"]],["Gosu Template",["gst"]],["Groff",["groff","nroff",
"man"]],["Groovy",["groovy"]],["Haml",["haml","HAML"]],["Haskell",["haskell","hs"]],["haXe",["hx","haXe"]],["HTML",["html"]],["HTTP",["http"]],["Hxml",["haxeml","hxml"]],["Hybris",["hybris","hy"]],["INI",["ini","cfg"]],["Io",["io"]],["Ioke",["ioke","ik"]],["IRC logs",["irc"]],["Jade",["jade","JADE"]],["JavaScript",["js","javascript"]],["JSON",["json"]],["Java",["java"]],["Java Server Page",["jsp"]],["Julia console",["jlcon"]],["Julia",["julia","jl"]],["Kconfig",["kconfig","menuconfig","linux-config",
"kernel-config"]],["Koka",["koka"]],["Kotlin",["kotlin"]],["Lasso",["lasso","lassoscript"]],["Lighttpd configuration file",["lighty","lighttpd"]],["Literate Haskell",["lhs","literate-haskell"]],["LiveScript",["live-script","livescript"]],["LLVM",["llvm"]],["Logtalk",["logtalk"]],["Lua",["lua"]],["MOOCode",["moocode"]],["Makefile",["make","makefile","mf","bsdmake"]],["Mako",["mako"]],["MAQL",["maql"]],["Mason",["mason"]],["Matlab",["matlab"]],["Matlab session",["matlabsession"]],["MiniD",["minid"]],
["Modelica",["modelica"]],["Modula-2",["modula2","m2"]],["MoinMoin/Trac Wiki markup",["trac-wiki","moin"]],["Monkey",["monkey"]],["MoonScript",["moon","moonscript"]],["Mscgen",["mscgen","msc"]],["MuPAD",["mupad"]],["MXML",["mxml"]],["MySQL",["mysql"]],["Myghty",["myghty"]],["NASM",["nasm"]],["Nemerle",["nemerle"]],["NewLisp",["newlisp"]],["Newspeak",["newspeak"]],["Nginx configuration file",["nginx"]],["Nimrod",["nimrod","nim"]],["NumPy",["numpy"]],["objdump",["objdump"]],["Objective-C",["objective-c",
"objectivec","obj-c","objc"]],["Objective-J",["objective-j","objectivej","obj-j","objj"]],["OCaml",["ocaml"]],["Octave",["octave"]],["Ooc",["ooc"]],["Opa",["opa"]],["OpenEdge ABL",["openedge","abl","progress"]],["Perl",["perl","pl"]],["PHP",["php","php3","php4","php5"]],["PL/pgSQL",["plpgsql"]],["PostScript",["postscript"]],["PostgreSQL console (psql)",["psql","postgresql-console","postgres-console"]],["PostgreSQL SQL dialect",["postgresql","postgres"]],["POVRay",["pov"]],["PowerShell",["powershell",
"posh","ps1"]],["Prolog",["prolog"]],["Properties",["properties"]],["Protocol Buffer",["protobuf"]],["Python",["python","py","sage"]],["Python Traceback",["pytb"]],["RConsole",["rconsole","rout"]],["Racket",["racket","rkt"]],["Embedded Ragel",["ragel-em"]],["Raw token data",["raw"]],["Rd",["rd"]],["REBOL",["rebol"]],["Redcode",["redcode"]],["RHTML",["rhtml","html+erb","html+ruby"]],["RobotFramework",["RobotFramework","robotframework"]],["reStructuredText",["rst","rest","restructuredtext"]],["Ruby",
["rb","ruby","duby"]],["Rust",["rust"]],["S",["splus","s","r"]],["Standard ML",["sml"]],["Sass",["sass","SASS"]],["Scala",["scala"]],["Scaml",["scaml","SCAML"]],["Scheme",["scheme","scm"]],["Scilab",["scilab"]],["SCSS",["scss"]],["Smali",["smali"]],["Smalltalk",["smalltalk","squeak"]],["Smarty",["smarty"]],["Snobol",["snobol"]],["SourcePawn",["sp"]],["Debian Sourcelist",["sourceslist","sources.list"]],["SQL",["sql"]],["sqlite3con",["sqlite3"]],["SquidConf",["squidconf","squid.conf","squid"]],["Scalate Server Page",
["ssp"]],["Stan",["stan"]],["systemverilog",["sv"]],["Tcl",["tcl"]],["Tcsh",["tcsh","csh"]],["Tea",["tea"]],["TeX",["tex","latex"]],["Text",["text"]],["Treetop",["treetop"]],["UrbiScript",["urbiscript"]],["VGL",["vgl"]],["Vala",["vala","vapi"]],["aspx-vb",["aspx-vb"]],["VB.net",["vb.net","vbnet"]],["Velocity",["velocity"]],["verilog",["v"]],["vhdl",["vhdl"]],["VimL",["vim"]],["XQuery",["xquery","xqy","xq","xql","xqm"]],["XML",["xml"]],["XSLT",["xslt"]],["Xtend",["xtend"]],["YAML",["yaml"]]],a.DF=
function(b){return{label:b[0],value:b[1][0],toString:jf(b[0])}},a.EF=z.map(CF,DF);t=BF.prototype;t.R={AS:"lang-select",zq:"collapsed",YO:"lang-list",lR:"lang-option",Ak:"active",bC:"checked"};t.p=function(){BF.m.p.call(this);this.g().C();this.Z.C();L(this.e);this.hr=this.Ft=this.e=k};t.o=function(){var b=this.F;this.e=K("div",{innerHTML:this.Bf,className:[b.AS,b.zq].join(" ")})};t.Bf='<div class="title-button">选择语言</div><i class="zg-icon zg-icon-double-arrow"></i><div class="input-wrapper"><input class="filter-input zg-form-text-input" placeholder="搜索语言"></div>';
t.z=function(){BF.m.z.call(this);this.Ft=J("title-button",this.e);this.hr=J("filter-input",this.e);rg(this.Ft,j);var b=this.hr,c=this.e,d=this.F,e=this.g(),g=this,h=g.F,l={},n=new AF(EF,m),c=new Km(c,l),q=new Am(k,k,m),r=n.ci;n.ci=function(b,c,d){Ka(b)?r.apply(this,arguments):d(b,EF)};l.od=function(b,c,d){b=b.data;b.value===g.Bc&&(D.add(d,h.bC),d.appendChild(K("i","icon "+h.bC)));d.appendChild(document.createTextNode(b.toString()))};var x=new km(n,c,q);q.Z=x;q.Jk(b);x.Wh=20;e.c(x,"suggestionsupdate",
function(){x.Ee(x.Gc+0)}).c(x,"update",function(b){this.zy(b.Uo)}).c(x,"dismiss",function(){this.vf(j)});b=x.L;b.className=d.YO;b.et=d.lR;b.nu=d.Ak;this.Z=x;this.g().c(this.e,"click",this.qr).c(this.Ft,"click",this.DN)};t.U=p("Bc");t.sa=function(b){var c=b&&z.find(EF,function(c){return c.value===b});c&&(this.bk(c.label),this.dispatchEvent({type:"change",kR:c}));this.Bc=b};
t.qr=function(b){var c=this.Z,d=c.L.h();d&&(document.activeElement!==this.hr&&!d.contains(b.target))&&(b.preventDefault(),b.stopPropagation(),mm(c))};t.DN=function(){this.isCollapsed()&&this.vf(m)};t.isCollapsed=function(){return D.has(this.e,this.F.zq)};t.vf=function(b){if(this.isCollapsed()!==b){var c=this.hr,d=this.F;b?D.add(this.e,d.zq):(D.remove(this.e,d.zq),b=this.Z,d=b.L,b.$l(EF),d.h().scrollTop=0,d.show(),c.value="",c.focus())}};t.bk=function(b){var c=this.Ft;c.title=b;xc(c,b)};
t.zy=function(b){this.sa(b.value);this.Z.Ec()};a.FF=function(b){yv.call(this);F.extend(this.F={},this.R,b||{});this.Pv=this.vb=k};y(FF,yv);
a.GF=C||rb||B,a.HF=function(b){return"P"===b.tagName},a.IF=function(b){return 3===b.nodeType},a.JF=function(b){return b&&"PRE"===b.tagName},a.KF=function(b){function c(b){return z.contains(g,b)}function d(){var b=document.createTextNode("\n");g.push(b);return b}var e=document.createElement("div");e.innerHTML=b;var g=[],h=of(c),b=zc(e,kD);(0,z.forEach)(b,function(b){b.lastChild&&"BR"===b.lastChild.tagName&&b.removeChild(b.lastChild);b.firstChild||b.appendChild(document.createTextNode(""));b.insertBefore(d(),
b.firstChild);b.appendChild(d())});b=z.toArray(e.getElementsByTagName("br"));(0,z.forEach)(b,function(b){b!==b.parentNode.lastChild&&mc(document.createTextNode("\n"),b)});e=zc(e,IF);e=nf(function(b){return z.filter(b,function(d,e){var g=b[e-1];return!g||!(c(g)&&c(d))})},function(b){var c=z.Uv(b,h);return-1!==c?b.slice(0,c+1):b},function(b){var c=z.Tv(b,h);return-1!==c?b.slice(c):b})(e);return(0,z.map)(e,function(b){return b.nodeValue}).join("").replace(/\xa0/g," ")};t=FF.prototype;t.jd=jf("CodePlugin");
t.Je=function(b){return"+code"===b};t.bf=function(b){this.Je(b)&&this.trigger()};t.queryCommandValue=function(){var b="1"===LF(this).state,c=this.B.aj("EnterHandler");c&&(b?c.disable(this.B):c.enable(this.B));this.vb&&this.Pv&&mh(this.vb,function(c){c instanceof Uz&&c.gb(!b||z.contains(this.Pv,c.Wd()))},this);return b};t.R={nL:""};t.HS=function(b){this.vb=b;this.Pv=["toggleFullScreen"].concat("+code")};t.p=function(){FF.m.p.call(this);this.vb=k};
a.MF=function(b,c,d){for(b=b.B.field;c!==b;){if(d(c))return c;c=c.parentNode}},a.LF=function(b){var c,d=$o();d&&b.B.field.contains(d.Db())?(c=d.T(),b=(c=MF(b,c,JF))?"1":"2"):b="0";return{state:b,Po:d,code:c}};
t.trigger=function(){var b=LF(this),c=b.Po,d=b.code;switch(b.state){case "1":var e=!Ka(Gc(d)),b=lD(d);e?(d.parentNode.removeChild(d),b&&Yr(b,j)):(c=c.T()&&c.ha()?new UC(c):k,e=Ma(d.innerHTML),ks(O.filter(new is(d,m,j),js))&&(e="<br>"+e),b&&"BR"!==b.tagName&&(e+="<br>"),b=fc(e),d.parentNode.replaceChild(b,d),c.restore());break;case "2":this.Rr(c,Ka(c.Jc())?KF(c.Yd()):GF?"\n":"")}};
t.Hi=function(b,c){var d=document.createElement(b);d.id=gh(fh.D());return c(d,function(){d=H(d.id);d.removeAttribute("id");return d})};
t.xg=function(){var b=this.B,c=this.B.field,d,e=new Dl(JF,m,k,c),g=K("div",{style:"display:none"});$r(e,new Mf(4,0,0,0));e.Al=new Mf(4,0,0,0)||k;e.st=150;e.Br=100;e.dh(g);e.className="hc-lang-select";N(e,"beforeshow",function(b){d=b.target.anchor;e.$c(new ll(d,1));if(d.lang){var b=h,c,g=d.lang;(c=(c=z.find(CF,function(b){return b[0]===g||z.contains(b[1],g)}))&&DF(c))&&b.sa(c.value);h.vf(j)}else h.bk("选择语言")});N(e,"beforehide",function(b){d=k;h.sa(k);if((b=b.target)&&c.contains(b)&&JF(b))return m});
var h=new BF;h.W(g);N(h,"change",function(b){d&&(d.lang=b.kR.value,e.w(m))});this.Wp={lw:jf(e),TX:jf(h),C:function(){e.C();h.C()}};Rc(b,this.Wp);N(b,"delayedchange",this.fS,m,this);N(b.field,"paste",this.Pw,m,this)};t.fS=function(){var b=this.Wp&&this.Wp.lw();b&&(b.Q()&&b.anchor)&&b.na()};
t.Pw=function(b){var c=LF(this),d=c.Po,e=c.code;if("1"===c.state)if(c=b.Ub.clipboardData)c.types&&z.contains(c.types,"text/plain")&&(b.preventDefault(),c=c.getData("text/plain"),b=document.createTextNode(c),d.lg(b),Yr(b));else if(window.clipboardData){if(c=window.clipboardData.getData("Text")){b.preventDefault();var g=c;this.Hi("i",function(b,c){d.lg(b);b=c();g=Ia(g);mc(document.createTextNode(g),b)})}}else{var h=d.ra(),b=d.Jc().length,l=(e.firstChild?Tr(e.firstChild):0)-h-b;setTimeout(function(){var b=
KF(e.innerHTML);xc(e,b);b=(e.firstChild?Tr(e.firstChild):0)-l;e.firstChild&&bp(e.firstChild,Math.max(h,b)).select()})}};
t.Mw=function(b){if(13===b.keyCode)return this.Gw(b);if(40===b.keyCode){var c=LF(this),d=c.Po,b=c.code;if("1"===c.state){for(var e=c=d.ha(),g=[];e&&e!==b;)g.push([e.parentNode.childNodes.length,z.indexOf(e.parentNode.childNodes,e)]),e=e.parentNode;g=!g.length||z.every(g,function(b){return b[0]===b[1]+1});e=IF(c);if(g&&!(g=!e))e&&(c=c.nodeValue,d=d.Ea(),e=d===c.length||GF&&d===c.length-1&&"\n"===c.slice(-1)),g=e;g&&(lD(b)||kc(document.createElement("br"),b))}}};
t.Gw=function(b){var c=LF(this),d=c.Po;if("1"===c.state)return b.preventDefault(),A?this.Hi("i",function(b,c){d.lg(b);setTimeout(function(){var d=document.createTextNode("\r");b=c();mc(d,b);Yr(d)})}):document.queryCommandSupported("insertLineBreak")?document.execCommand("insertLineBreak"):(b=document.createTextNode("\n"),d.insertNode(b),Yr(b)),this.B.Ze(),j};
t.Rr=function(b,c){var d=this.F,e;b.Yc();var g;var h=WC(b,j),l=h.ca,n,q=this.B.field;g=MF(this,l,oD(kD,of(HF)))||q;var r=function(b){return b.parentNode.insertBefore(document.createTextNode(""),b)};if(IF(l)){var x=l.parentNode;!l.nodeValue&&x!==q&&Ls(x)?(n=r(x),l=r(n),x.parentNode.removeChild(x)):n=A&&h.offset===l.length?kc(document.createTextNode(""),l):l.splitText(h.offset)}else"BR"===l.tagName&&(n=l,l=r(l));if(n){for(var E,h=l,l=n;h!=g&&(E=h.parentNode);){n=h;h=l;for(l=E.cloneNode(m);n.nextSibling;)l.appendChild(n.nextSibling);
h&&l.insertBefore(h,l.firstChild);h=E}E=l;n=E.firstChild;hc(g,E.childNodes);g=n}else g=k;g?(e=document.createElement("PRE"),g.parentNode.insertBefore(e,g)):this.Hi("PRE",function(c,d){b.insertNode(c);e=d()});!c&&A&&(c=" ");e.lang=d.nL;xc(e,c);Ls(e)?Ks(e.firstChild):Yr(e.lastChild);d=e;lD(d)||kc(document.createElement("br"),d)};FB["+code"]={eb:j,P:"插入代码",ua:"+code",Ja:"tr-icon tr-code",factory:GA};a.NF=function(b){eE.call(this,b);this.N=new le(this);this.AA="http://upload."+Bg.em+":"+location.port+"/upload";this.qK=!A};y(NF,eE);a.OF=function(b){gd.call(this,"ok");var c=b[0];this.Bl=c;this.gG=c.replace("_m.jpg","_r.jpg");this.AG=b[1];this.zG=b[2]};y(OF,gd);t=NF.prototype;t.Bf=tk('<div class="zm-img-uploader"><iframe src="about:blank" name="av_up_frame" style="position: absolute; height: 0; width: 0; left: -9000px; "></iframe><div class="zg-section zm-img-uploader-tab"><a href="javascript:;" class="tab-nav selected">上传图片</a> 或 <a href="javascript:;" class="tab-nav">引用站外图片</a></div><form class="zg-clear" target="av_up_frame" method="POST" enctype="multipart/form-data" action="<%= uploadURL %>"><div class="tab-content selected <% if (canStylize) { %>inline<% } %>"><% if (canStylize) { %><input type="file" name="upload_file" style="opacity:0;height:0;width:0;font-size:0;position:absolute;"><a href="javascript:;" class="browser zg-btn-blue">选择图片</a><% } else { %><input type="file" name="upload_file"><% } %></div><div class="tab-content"><input type="text" autocomplete="off" name="upload_file_url" class="zm-editable-editor-input zg-form-text-input"><a href="javascript:;" class="insert zg-btn-blue zm-uploader-button-fix">确认</a></div><span style="display: none; " class="zm-img-uploader-loading">正在上传</span><span style="display: none; " class="zm-img-uploader-error">上传图片失败，请稍后重试</span></form><div class="zg-gray">请不要上传与回答问题无关的图片，详细请看 <a href="http://www.zhihu.com/question/20064580" target="_blank">知乎图片使用规范</a></div><div class="zm-command"><a class="cancel" href="javascript:;">取消</a></div></div>');
t.iv=function(){var b=fc(this.Bf({uploadURL:this.AA,canStylize:this.qK}));F.forEach({form:"form",eA:".zm-img-uploader-tab",Wg:".zm-img-uploader-loading",af:".zm-img-uploader-error",GH:"input[type=text]",Bn:"input[type=file]",SB:".browser",Pk:".cancel",vO:".insert"},function(c,e){this[e]=$(c,b).get(0)},this);this.N.c(W,"iframe_data",this.vu).c(this.Bn,"change",this.ER).c(this.vO,"click",this.wO).c(this.Pk,"click",function(){this.zw();this.hide()}).c(this.eA,"click",function(b){b=$(b.target);b.is("a")&&
!b.is(".selected")&&PF(this,b.index())});this.kC=b;mi||(PF(this,1),$(this.eA).replaceWith("<strong>输入站外图片地址：</strong>"));this.SB&&this.N.c(this.SB,"click",function(){this.Bn.click()});var c=new fE(this);c.Xa("插入图片").La(this.kC);c=iE(c);Fh(c,k);return c};t.ER=function(){if(this.Bn.value){var b=this.Bn.value,b=String(b).toLowerCase();(!b?0:z.some([".jpg",".jpeg",".gif",".png"],function(c){return Bs(b,c)}))?(this.GH.value="",R(this.Wg,j),R(this.af,m),this.form.submit()):QF(this,"图片不是 .jpg、.png 或 .gif 格式，无法上传。")}};
t.wO=function(){var b=ak(this.GH.value);b?Ea(b,"http://")?(this.Bn.value="",R(this.Wg,j),R(this.af,m),this.form.submit()):QF(this,"我们目前不支持该协议。"):QF(this,"请填写图片地址。")};a.PF=function(b,c){function d(b){b.eq(c).addClass("selected").siblings().removeClass("selected")}var e=$(".tab-nav",b.eA),g=$(".tab-content",b.form);R(b.af,m);var h=g.eq(c);h.find("input").val("");d(e);d(g);h.find(":text").focus()},a.QF=function(b,c){R(b.Wg,m);b.af.innerHTML=c;R(b.af,j)};t.vu=function(b){R(this.Wg,m);this.ck(b.sb)};
t.ck=function(b){b&&!b.r?(this.dispatchEvent(this.kn(b.msg)),this.hide()):QF(this,b.msg)};t.kn=function(b){return new OF(b)};t.p=function(){this.N.C();this.N=k;NF.m.p.call(this)};a.RF=function(){jE.call(this,"image");this.N=new le(this)};y(RF,jE);t=RF.prototype;t.jd=jf("ImageDialogPlugin");t.bf=function(b,c){var d=this.B;return!d.Ie&&(d.Vf(),!d.Ie)?m:RF.m.bf.call(this,b,c)};
t.ij=function(b){if(b&&"mouseup"===b.type){var c=b.target;c&&"IMG"===c.nodeName&&(b=lD(c),b||(b=document.createElement("br"),kc(b,c)),Ks(b))}};t.In=function(b){RF.m.In.call(this,b)};t.hv=function(b){b=new NF(b);this.N.c(b,"ok",this.gj).c(b,"cancel",this.Jn);return b};t.p=function(){RF.m.p.call(this);this.N.C()};
t.gj=function(b){lE(this);var c=RC(this),d;d=b.gG?c.o("IMG",{"class":"origin_image zh-lightbox-thumb","data-original":b.gG,title:"点击查看原图",src:b.Bl}):c.o("IMG",{"class":"content_image",src:b.Bl});b.AG&&d.setAttribute("data-rawwidth",b.AG);b.zG&&d.setAttribute("data-rawheight",b.zG);b=aw(this.B);if(hD(b))b.lg(d),A||(Yr(d,m),c.Pa().focus()),Cv(this.B),this.B.Ze();else return k;this.N.Lc()};t.Jn=function(){this.N.Lc()};a.SF=function(b){eE.call(this,b);this.N=new le(this)};y(SF,eE);a.TF=function(b,c,d,e,g){gd.call(this,"ok");this.mU=b;this.kU=c;this.lU=g;this.cT=d;this.poster=e};y(TF,gd);t=SF.prototype;t.show=function(){SF.m.show.call(this);this.Qt.focus()};t.hide=function(){SF.m.hide.call(this)};
t.iv=function(){var b="http://upload."+Bg.em+":"+location.port+"/upload_video",b=this.gd.o("div","zm-img-uploader zm-img-uploader-upload-tab-selected",[this.gd.o("div","zg-section",this.gd.o("strong",k,"输入视频页地址：")),this.DR=this.gd.o("iframe",{id:"video_up_frame",src:"about:_blank",name:"video_up_frame",style:"visible:hidden;position:absolute;height:0;width:0;left:-9000px"}),this.Kh=this.gd.o("form",{"class":"zg-section-title",target:"video_up_frame",method:"post",enctype:"multipart/form-data",action:b},
[this.Qt=this.gd.o("input",{type:"text","class":"zg-form-text-input",name:"upload_file_url",autocomplete:"off"}),this.hn=this.gd.o("a",{"class":"zg-btn-blue zm-uploader-button-fix",name:"save",href:"javascript:;"},"确定"),this.gd.o("div","zm-video-uploader-info",[this.Wg=this.gd.o("span",{style:"display:none","class":"zm-img-uploader-loading"},"正在上传"),this.af=this.gd.o("span",{style:"display:none","class":"zm-img-uploader-error"},"插入视频失败，请稍后重试")])]),this.gO=this.gd.o("div","zg-gray"),this.Ei=this.gd.o("div",
"zm-command",[this.Pk=this.gd.o("a",{href:"javascript:;"},"取消")])]);this.gO.innerHTML='我们目前支持<a class="zg-link-gray" target="_blank" href="http://youku.com">优酷</a>、<a class="zg-link-gray" target="_blank" href="http://tudou.com">土豆</a>、<a href="http://video.sina.com.cn/" class="zg-link-gray" target="_blank">新浪</a>视频服务。<br />请不要上传与回答问题无关的视频，详细请看 <a href="http://www.zhihu.com/question/20118966" target="_blank">知乎视频使用规范</a>';this.N.c(this.Pk,"click",function(){this.zw();this.hide()}).c(this.hn,"click",
this.qG).c(this.Ei,"click",this.fa).c(this.Kh,"submit",function(){return UF(this,this.Qt.value)}).c(W,"iframe_data",this.vu);this.kC=b;var c=new fE(this);c.Xa("插入视频").La(b);b=iE(c);Fh(b,k);return b};a.UF=function(b,c){c=ak(c);if(!c)return m;var d=c.match(/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi);d||(R(b.Wg,m),b.af.innerHTML="我们无法识别你输入的视频页地址",R(b.af,j));return d};
t.qG=function(){if(this.Qt.value){var b=ak(this.Qt.value);b&&UF(this,b)&&(R(this.Wg,j),R(this.af,m),this.Kh.submit())}};t.fa=function(b){"save"===(b.target&&b.target.name)&&this.qG()};t.vu=function(b){R(this.Wg,m);this.ck(b.sb)};t.ck=function(b){b&&!b.r?(this.dispatchEvent(this.kn(b.msg[0],b.msg[1],b.msg[2],b.msg[3],b.msg[4])),this.hide()):(b=b.msg,R(this.Wg,m),this.af.innerHTML=b,R(this.af,j))};t.kn=function(b,c,d,e,g){return new TF(b,c,d,e,g)};t.p=function(){this.N.C();this.N=k;SF.m.p.call(this)};
a.VF=function(){jE.call(this,gD);this.N=new le(this)};y(VF,jE);t=VF.prototype;t.jd=jf("VideoDialogPlugin");t.bf=function(b,c){var d=this.B;return!d.Ie&&(d.Vf(),!d.Ie)?m:VF.m.bf.call(this,b,c)};t.In=function(b){VF.m.In.call(this,b)};t.hv=function(b){b=new SF(b);this.N.c(b,"ok",this.gj).c(b,"cancel",this.Jn);return b};t.p=function(){VF.m.p.call(this);this.N.C()};
t.gj=function(b){lE(this);var c=RC(this),d=c.o("embed");F.forEach({type:"application/x-shockwave-flash",allowscriptaccess:"always",allowfullscreen:"true",wmode:"opaque","class":"video",width:"420",height:"350",src:b.mU,"data-poster":b.poster,"data-name":b.lU,"data-videoid":b.kU,"data-sourceurl":b.cT},function(b,c){d.setAttribute(c,b)});b=PC(d);Bs(b,'">')&&(b+="</embed>");var b=fc(b+" "),e=b.firstChild,g=aw(this.B);if(hD(g))g.lg(b),A?document.selection&&(c=document.selection.createRange(),c.move("character",
-1),c.select()):(Yr(e),c.Pa().focus()),Cv(this.B),this.B.Ze();else return k;this.N.Lc()};t.Jn=function(){this.N.Lc()};a.Ms=j,a.WF=yv.prototype.execCommand,a.XF=["+insertOrderedList","+insertUnorderedList","+link"];yv.prototype.execCommand=function(b){var c=this.B;return z.contains(XF,b)&&!c.Ie&&(c.Vf(),!c.Ie)?m:WF.apply(this,arguments)};a.YF=jE.prototype.execCommand,a.ZF=["+equation"];jE.prototype.execCommand=function(b){var c=this.B;return z.contains(ZF,b)&&!c.Ie&&(c.Vf(),!c.Ie)?m:YF.apply(this,arguments)};gD="video";mD=kb?"⌘":"ctrl";FB[gD]={ua:gD,P:"插入视频",Ja:"tr-icon tr-video",factory:FA};
FB["+equation"]={ua:"+equation",P:LA.NV,Ja:"tr-icon tr-equation",factory:FA};FB["+bold"].P="粗体 ("+mD+"+b)";FB["+italic"].P="斜体 ("+mD+"+i)";FB["+underline"].P="下划线 ("+mD+"+u)";FB["+superscript"].P="引用内容";FB["+insertOrderedList"].P="有序列表";FB["+insertUnorderedList"].P="无序列表";FB["+removeFormat"].P="清除格式";FB.image.P="插入图片";FB[gD].P="插入视频";FB["+equation"].P="插入公式";a.$F=function(){};ia($F);
$F.prototype.Fg=function(b,c){this.hC=c;var d,e,g;e=J("zm-editable-toolbar-container",b);d=J("zm-editable-editor-outer",b);g=J("zm-editable-editor-field-element",b);var h=new Cw(g.id);h.iK=89;var l=[];c.enableFullScreen&&l.push("toggleFullScreen");l.push("+bold","+italic","+underline",new OE,"+blockquote","+code","+insertOrderedList","+insertUnorderedList","+equation");c.canUploadMedia_&&l.push(new OE,"image",gD);c.useRemoveFormat_&&l.push(new OE,"+removeFormat");var n=Sb(e);g=[];for(var q=0,r;r=
l[q];q++){if(oa(r)){var x=i;if(r=FB[r]){var x=r.factory||GA,E=r.ua,G=r.P,I=r.caption,Q=r.Ja,X=n||Sb(),x=x(E,G,I,Q,k,X);r.eb&&(x.eb=j)}r=x}r&&g.push(r)}var l=Sb(e),na=new aD(Sz.D(),Eq,l),l=cg(e);na.gi(l);na.Qe(m);for(n=0;q=g[n];n++)xq(q,32,m),q.gi(l),na.M(q,j);na.W(e);new QE(h,na);Rc(h,na);QC(h,new rD);QC(h,new yE);if(c.loremIpsum_&&(QC(h,new zE(c.loremIpsum_)),B))h.on("load",function(){vd(h.h(),"focus",function(){h.execCommand("clearlorem",j)})});QC(h,new KD);QC(h,new AE);QC(h,new IE);e=new FF;QC(h,
e);QC(h,new RF);QC(h,new VF);QC(h,new oF);QC(h,new kF);QC(h,new lF);QC(h,new yF);c.enableFullScreen&&(d=new JB({title:"写作模式",pk:d}),QC(h,d));h.on("load",function(){c.useScraper_&&this.Pr(h,na)},m,this);return[h,na]};$F.prototype.Pr=function(b,c){var d=b.h(),e=new Lw;e.n(d);var g=K("div",{style:"display:none",className:"tr-spinner spinner-gray"});c.h().appendChild(g);e.on("willScrape",function(){R(g,j)}).on("didScrape",function(){R(g,m)});Rc(b,e)};
Ca("ZH.createRichTextEditor",function(b,c){return $F.D().Fg(b,c)});Gf("rich_text_editor");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/rich_text_editor.js