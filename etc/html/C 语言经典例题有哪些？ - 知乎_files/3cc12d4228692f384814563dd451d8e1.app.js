(function(a){with(a){
a.Sr=function(b,c){this.ca=b;this.offset=c},a.Tr=function(b){return b.length||b.childNodes.length},a.Ur=function(b,c,d){for(;1==b.nodeType;){var e=b.childNodes[c];if(!e&&!b.lastChild)break;e?(b=e.previousSibling,d&&b?c=Tr(b):(b=e,c=0)):(b=b.lastChild,c=Tr(b))}return new Sr(b,c)},a.Vr=function(b,c){b!=k&&this.append.apply(this,arguments)};t=Vr.prototype;t.wh="";t.set=function(b){this.wh=""+b};t.append=function(b,c,d){this.wh+=b;if(c!=k)for(var e=1;e<arguments.length;e++)this.wh+=arguments[e];return this};
t.clear=function(){this.wh=""};t.nr=u(49);t.toString=p("wh");a.Wr=function(b){this.type="anon_change";this.jb=b};y(Wr,gd);a.Z=function(b,c){return da[b]=c};Mf.prototype.expand=Z(64,function(b,c,d,e){ra(b)?(this.top-=b.top,this.right+=b.right,this.bottom+=b.bottom,this.left-=b.left):(this.top-=b,this.right+=c,this.bottom+=d,this.left-=e);return this});kq.prototype.expand=Z(63,function(){this.Ia(j)});ph.prototype.Zo=Z(62,function(b){qh(this);this.Kk=b});
vi.prototype.Zo=Z(61,function(b){this.Kk=b;this.xa&&wi(this)});uq.prototype.jm=Z(57,function(b){this.La(b)});Wd.prototype.fi=Z(56,ca("vF"));ph.prototype.Dx=Z(55,function(){return this.wj||150>za()-this.Lx});io.prototype.Db=Z(54,function(){var b=this.uc();return 1==b.nodeType?b:b.parentNode});Wg.prototype.Of=Z(52,ca("qi"));hj.prototype.Of=Z(51,ca("qi"));Tp.prototype.Ne=Z(50,function(b){this.Z.nt(b)});Vr.prototype.nr=Z(49,function(){return this.wh.length});Ik.prototype.fireEvent=Z(38,function(b){this.dispatchEvent(b)});
ol.prototype.Jc=Z(33,function(){return Fc(this.h())});uo.prototype.Jc=Z(32,function(){return this.O.toString()});zo.prototype.Jc=Z(31,function(){return this.O.text});Jo.prototype.Jc=Z(30,function(){return No(this).Jc()});Po.prototype.Jc=Z(29,s(""));Vo.prototype.Jc=Z(28,function(){return z.map(ko(this),function(b){return b.Jc()}).join("")});
Qb.prototype.jv=Z(22,function(b,c,d){for(var e=this.Ca,g=!!d,d=["<tr>"],h=0;h<c;h++)d.push(g?"<td>&nbsp;</td>":"<td></td>");d.push("</tr>");d=d.join("");c=["<table>"];for(h=0;h<b;h++)c.push(d);c.push("</table>");b=e.createElement("DIV");b.innerHTML=c.join("");return b.removeChild(b.firstChild)});Hq.prototype.vf=Z(21,function(b,c){var d=b.Dd(),e=this.K()+"-collapse-left",g=this.K()+"-collapse-right";b.Ti(d?g:e,!!(c&1));b.Ti(d?e:g,!!(c&2))});Jq.prototype.vf=Z(20,function(b){this.L.vf(this,b)});
uh.prototype.ep=Z(19,ca("Oj"));uq.prototype.ep=Z(18,ca("Oj"));
ef.prototype.Yp=Z(15,function(b,c,d){var e=za(),g=d?d:e,h=this.el.Ig.length?this.el.Ig.pop():this.el.Sk();h.cr=2;h.br=g;h.type=c;h.fC=b;b=(b=this.PX)&&b.isTracing()?b.totalVarAlloc:-1;h.KH=b;this.dv++;if(d){d=this.Qf.length;for(b=0;b<d;b++)if(this.Qf[b].br>g){z.Wn(this.Qf,h,b);break}b==d&&this.Qf.push(h)}else this.Qf.push(h);if(g=h.type)h=this.gk.get(g),h||(h=this.rp.Ig.length?this.rp.Ig.pop():this.rp.Sk(),h.type=g,this.gk.set(g,h)),h.count++;this.Lt+=za()-e});Cq.prototype.iw=Z(13,function(){return Fq});
bn.prototype.bm=Z(10,function(){this.Fb.value="";this.zm&&(this.xc.value="");R(this.uo,m);this.Ef.innerHTML="搜索用户";this.wm=-1});cq.prototype.lr=Z(0,p("Ka"));
a.Xr=function(b){b.Bx=j;b.uC=sg(b.h()).height;Ep+=b.uC;z.forEach(Cp,function(b){b&&(!b.Bx&&b.il)&&b.So()})},a.Yr=function(b,c){var d=b.parentNode,e=z.indexOf(d.childNodes,b)+(c?0:1),d=Ur(d,e,c);A&&(Eb("9")&&1==d.ca.nodeType&&"HR"==d.ca.tagName)&&(e=d.ca,d.ca=e.parentNode,d.offset=z.indexOf(d.ca.childNodes,e)+(c?0:1));bp(d.ca,d.offset).select()},a.Zr=function(b,c){if(qm(b))b.selectionStart=c,b.selectionEnd=c;else if(A){var c=tm(b,c),d=b.createTextRange();d.collapse(j);d.move("character",c);d.select()}},
a.$r=function(b,c){b.$x=c==k||c instanceof Mf?c:new Mf(c,i,i,i);b.Q()&&b.na()},a.as=function(b){var c={};z.forEach(b.data.Eb(),function(b){c[b]=this.data.get(b)},b);return c},a.bs=function(b){b.Gb()&&b.fire()},a.cs=function(b,c){return b.Fd.get(c)},a.ds=function(b,c){this.type="answer_reorder";this.LY=c;this.yB=b};y(ds,gd);
a.es=function(b,c,d){var e=Ii,g={title:"确认使用匿名身份？",content:'<p>使用匿名身份后，你将</p><ul style="margin: 5px 0 0 5px;list-style-position: inside;"><li>不能在该问题下评论（你之前的评论将被隐藏）</li><li>不能邀请别人回答该问题</li></ul>'},h={title:"确认放弃匿名身份？",content:"你对该问题的回答、赞同和关注行为将以实名显示。"};Ai(b?g:h,function(g){if(g){var h=new V(j),q="/question/"+(b?"set_anonymous":"set_public"),r="qid="+(d||Cg.V);h.on("success",function(){var c=Ge(h);c&&!c.r&&e.dispatchEvent(new Wr(b))});h.ajax(q,r)}c&&c(g)})},a.fs=function(b,c){return b.Tb&&c?z.indexOf(b.Tb,
c):-1},a.gs=function(b){return b!=k},a.hs=function(b){return!/[^\t\n\r ]/.test(b)},a.is=function(b,c,d){this.CF=b;this.mS=!!d;b&&!c&&this.next()};y(is,Ld);is.prototype.next=function(){var b=this.CF;b||f(O.Za);this.CF=this.mS?b.previousSibling:b.nextSibling;return b};
a.js=function(b){return 1==b.nodeType||3==b.nodeType&&!hs(b.nodeValue)},a.ks=function(b){try{return b.next()}catch(c){return k}},a.ls=function(b,c,d){ka(d)||(d=c&&b.childNodes.length?b.childNodes.length-1:0);is.call(this,b.childNodes[d],j,c)};y(ls,is);
a.ms=function(b){return 1==b.length?"0"+b:b},a.ns=/^#(?:[0-9a-f]{3}){1,2}$/i,a.os=function(b,c){var d=$.extend({all:m},os.R,c||{}),e=$(b).get(0).getBoundingClientRect();return!d.all&&(e.bottom<d.paddingTop||e.bottom>$(window).height())||d.all&&(e.top<d.paddingTop||e.bottom>$(window).height())?m:j};os.R={paddingTop:0};
a.ps=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,a.qs=/#(.)(.)(.)/,a.rs=function(b){var c=b.body,b=b.documentElement;return new Mb(c.scrollLeft||b.scrollLeft,c.scrollTop||b.scrollTop)},a.ss=function(b){for(var c;c=!b||1!=b.nodeType?k:ks(O.filter(new ls(b,m),js));)b=c;return b},a.ts=function(b,c,d){Yn.call(this,b,0,d?"添加父话题":"添加子话题");this.Ex=d;this.Cf=c;this.Mr="";this.KG="/topic/parent/remove";this.sB=j};y(ts,Yn);t=ts.prototype;
t.n=function(b){if(this.isEnabled=!b.getAttribute("data-disabled"))ts.m.n.call(this,b),this.be(j),R(this.jD,m)};t.jf=function(b){var c;this.Ex&&(c="/topic/autocomplete?no_create=true");ts.m.jf.call(this,b,c);this.J.nf.gD=m};t.Zj=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return!this.sB&&3>=b.length?m:d[0]!==b[1]})},this)},this)};
t.Ue=function(b,c){this.Vg||(this.Vg=j,this.xhr=new V(j),P(this.g(),this.xhr,"complete",this.uu),b||(b=-1),this.Ex?this.xhr.ajax("/topic/add","tid="+this.Cf+"&pid="+b+"&topic_text="+encodeURIComponent(c)):this.xhr.ajax("/topic/add","tid="+this.Cf+"&cid="+b+"&topic_text="+encodeURIComponent(c)))};t.qD=function(b){return'<a class="nor" href="/topic/'+b[1]+'/organize">'+b[0]+"</a>"};
t.Io=function(b){if(!this.$||!this.$.Gb()){var c=new V(j);this.g().c(c,"success",function(){var d=Ge(c);d.r?U(d.msg):(ao(this),this.Oe(),this.dispatchEvent({type:"remove_tag",data:{id:b}}))});this.Ex?c.ajax(this.KG,"cid="+this.Cf+"&pid="+b):c.ajax(this.KG,"pid="+this.Cf+"&cid="+b);this.$=c}};a.us=function(b,c){this.Ch=b instanceof Mb?b:new Mb(b,c)};y(us,kl);us.prototype.na=function(b,c,d,e){var g=rs(Rb(b)),h=this.Ch.x+g.x,g=this.Ch.y+g.y,l=hl(b),h=h-l.x,g=g-l.y;il(new Mb(h,g),b,c,d,k,k,e)};
a.vs=function(b,c){"number"===$.type(c)&&(c={offsetTop:c});var d=$.extend({gI:os},xk,c||{});if(!d.gI(b,d)){var e=$(b).offset().top-d.paddingTop-d.offsetTop||0;d.xB?$(document.documentElement).add(document.body).animate({scrollTop:e}):$(window).scrollTop(e)}},a.ws=function(b,c){c.all=j;return os(b,c)},a.xs=function(b){var c=b.match(ps);if(c){var b=Number(c[1]),d=Number(c[2]),c=Number(c[3]);if(0<=b&&255>=b&&0<=d&&255>=d&&0<=c&&255>=c)return[b,d,c]}return[]},a.ys=function(b){ns.test(b)||f(Error("'"+
b+"' is not a valid hex color"));4==b.length&&(b=b.replace(qs,"#$1$1$2$2$3$3"));return b.toLowerCase()},a.zs={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",
darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",
firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",
lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",
mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",
rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},
a.As=/[^\d]+$/,a.Bs=function(b,c){var d=b.length-c.length;return 0<=d&&b.indexOf(c,d)==d},a.Cs=function(b,c,d){T.call(this,d);this.L=c||Cq.D();this.zb=b||this.L.iw()};y(Cs,T);t=Cs.prototype;t.Hx=k;t.nb=k;t.L=k;t.zb=k;t.lb=j;t.fc=j;t.$v=j;t.pb=-1;t.kc=k;t.fg=m;t.IJ=m;t.fR=j;t.zg=k;t.hc=function(){return this.Hx||this.L.hc(this)};t.mr=function(){return this.nb||(this.nb=new um(this.hc()))};t.o=function(){this.e=this.L.o(this)};t.Y=function(){return this.L.Y(this.h())};t.Qc=function(b){return this.L.Qc(b)};
t.ea=function(b){this.e=this.L.n(this,b);"none"==b.style.display&&(this.lb=m)};t.z=function(){Cs.m.z.call(this);mh(this,function(b){b.xa&&Ds(this,b)},this);var b=this.h();this.L.Ge(this);this.w(this.lb,j);this.g().c(this,"enter",this.Fw).c(this,"highlight",this.Kw).c(this,"unhighlight",this.Uw).c(this,"open",this.mN).c(this,"close",this.yM).c(b,"mousedown",this.De).c(Rb(b),"mouseup",this.EM).c(b,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.xM);this.Th()&&Es(this,j)};
a.Es=function(b,c){var d=b.g(),e=b.hc();c?d.c(e,"focus",b.Ce).c(e,"blur",b.Uc).c(b.mr(),"key",b.Vb):d.Ba(e,"focus",b.Ce).Ba(e,"blur",b.Uc).Ba(b.mr(),"key",b.Vb)};t.ib=function(){this.Pb(-1);this.kc&&this.kc.ub(m);this.fg=m;Cs.m.ib.call(this)};t.p=function(){Cs.m.p.call(this);this.nb&&(this.nb.C(),this.nb=k);this.L=this.kc=this.zg=this.Hx=k};t.Fw=s(j);
t.Kw=function(b){var c=fs(this,b.target);if(-1<c&&c!=this.pb){var d=Fs(this);d&&d.qd(m);this.pb=c;d=Fs(this);this.fg&&d.setActive(j);this.fR&&(this.kc&&d!=this.kc)&&(d.Qb&64?d.ub(j):this.kc.ub(m))}Nc(this.h(),Uc.Fm,b.target.h().id)};t.Uw=function(b){b.target==Fs(this)&&(this.pb=-1);Nc(this.h(),Uc.Fm,"")};t.mN=function(b){if((b=b.target)&&b!=this.kc&&b.getParent()==this)this.kc&&this.kc.ub(m),this.kc=b};t.yM=function(b){b.target==this.kc&&(this.kc=k)};
t.De=function(b){this.fc&&(this.fg=j);var c=this.hc();c&&Cc(c)?c.focus():b.preventDefault()};t.EM=function(){this.fg=m};t.xM=function(b){var c;a:{c=b.target;if(this.zg)for(var d=this.h();c&&c!==d;){var e=c.id;if(e in this.zg){c=this.zg[e];break a}c=c.parentNode}c=k}if(c)switch(b.type){case "mousedown":c.De(b);break;case "mouseup":c.Zf(b);break;case "mouseover":c.kd(b);break;case "mouseout":c.Ph(b);break;case "contextmenu":c.Ln(b)}};t.Ce=ba();t.Uc=function(){this.Pb(-1);this.fg=m;this.kc&&this.kc.ub(m)};
t.Vb=function(b){return this.isEnabled()&&this.Q()&&(0!=nh(this)||this.Hx)&&this.gf(b)?(b.preventDefault(),b.stopPropagation(),j):m};
t.gf=function(b){var c=Fs(this);if(c&&"function"==typeof c.Vb&&c.Vb(b)||this.kc&&this.kc!=c&&"function"==typeof this.kc.Vb&&this.kc.Vb(b))return j;if(b.shiftKey||b.ctrlKey||b.metaKey||b.altKey)return m;switch(b.keyCode){case 27:if(this.Th())this.hc().blur();else return m;break;case 36:Gs(this);break;case 35:Hs(this,function(b,c){b--;return 0>b?c-1:b},0);break;case 38:if(this.zb==Fq)Is(this);else return m;break;case 37:if(this.zb==Eq)this.Dd()?Js(this):Is(this);else return m;break;case 40:if(this.zb==
Fq)Js(this);else return m;break;case 39:if(this.zb==Eq)this.Dd()?Is(this):Js(this);else return m;break;default:return m}return j};a.Ds=function(b,c){var d=c.h(),d=d.id||(d.id=c.Wd());b.zg||(b.zg={});b.zg[d]=c};t.M=function(b,c){Cs.m.M.call(this,b,c)};t.Bk=function(b,c,d){b.fk|=2;b.fk|=64;(this.Th()||!this.IJ)&&xq(b,32,m);b.cp(m);Cs.m.Bk.call(this,b,c,d);b.xa&&this.xa&&Ds(this,b);c<=this.pb&&this.pb++};
t.removeChild=function(b,c){if(b=oa(b)?kh(this,b):b){var d=fs(this,b);-1!=d&&(d==this.pb?b.qd(m):d<this.pb&&this.pb--);(d=b.h())&&(d.id&&this.zg)&&F.remove(this.zg,d.id)}b=Cs.m.removeChild.call(this,b,c);b.cp(j);return b};t.dp=function(b){this.h()&&f(Error("Component already rendered"));this.zb=b};t.Q=p("lb");
t.w=function(b,c){if(c||this.lb!=b&&this.dispatchEvent(b?"show":"hide")){this.lb=b;var d=this.h();if(d){R(d,b);if(this.Th()&&(d=this.hc()))d.tabIndex=this.fc&&this.lb?0:-1;c||this.dispatchEvent(this.lb?"aftershow":"afterhide")}return j}return m};t.isEnabled=p("fc");
t.gb=function(b){if(this.fc!=b&&this.dispatchEvent(b?"enable":"disable"))if(b?(this.fc=j,mh(this,function(b){b.jI?delete b.jI:b.gb(j)})):(mh(this,function(b){b.isEnabled()?b.gb(m):b.jI=j}),this.fg=this.fc=m),this.Th()){var c=this.hc();c&&(c.tabIndex=b&&this.lb?0:-1)}};t.Th=p("$v");t.Qe=function(b){b!=this.$v&&this.xa&&Es(this,b);this.$v=b;if(this.fc&&this.lb){var c=this.hc();c&&(c.tabIndex=b?0:-1)}};t.Pb=function(b){(b=oh(this,b))?b.qd(j):-1<this.pb&&Fs(this).qd(m)};
t.qd=function(b){this.Pb(fs(this,b))};a.Fs=function(b){return oh(b,b.pb)},a.Gs=function(b){Hs(b,function(b,d){return(b+1)%d},nh(b)-1)},a.Js=function(b){Hs(b,function(b,d){return(b+1)%d},b.pb)},a.Is=function(b){Hs(b,function(b,d){b--;return 0>b?d-1:b},b.pb)},a.Hs=function(b,c,d){for(var d=0>d?fs(b,b.kc):d,e=nh(b),d=c.call(b,d,e),g=0;g<=e;){var h=oh(b,d);if(h&&b.WB(h)){b.yz(d);break}g++;d=c.call(b,d,e)}};t.WB=function(b){return b.Q()&&b.isEnabled()&&!!(b.Qb&2)};t.yz=function(b){this.Pb(b)};
a.Ks=function(b){bp(ss(b),0).select()},a.Ls=function(b,c){var d=Gc(b);if(b.getElementsByTagName)for(var e in Ap)if(b.tagName==e||0<b.getElementsByTagName(e).length)return m;return!c&&" "==d||hs(d)},a.Ms=j,a.Ns=function(b){if(b=jo(b||window))if(b.empty)try{b.empty()}catch(c){}else try{b.removeAllRanges()}catch(d){}},a.Os=function(b){Yn.call(this);this.vC=k;this.Wc="例如：互联网、医学、法律、数学...";this.data=b||[]};y(Os,Yn);t=Os.prototype;
t.n=function(b){this.e=b;this.Re=J("zm-tag-editor-labels",this.e);this.be(j);this.se();this.Ha();this.Rf=H("zh-expert-topics");this.Km=H("zh-active-topics");if(this.Rf)$(this.Rf).on("click",".del",$.proxy(function(b){var d=$(b.target).parents(".item");d.data("active")?(lc(this.Km,d[0],0),gk(d[0])):L(d[0]);z.forEach(this.data,function(b,c){b+""===d.data("url-token")+""&&this.data.splice(c,1)},this);Ps(this);this.dispatchEvent("remove")},this));if(this.Km)$(this.Km).on("click",".add",$.proxy(function(b){b=
$(b.target).parents(".item");lc(this.Rf,b[0],0);gk(b[0]);Ps(this);this.dispatchEvent("add")},this));this.data=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();this.cm()};t.xn=function(){this.xb||(this.xb=K("div","zm-tag-editor-editor",[this.$e=K("div","zg-section zm-tag-editor-command-buttons-wrap",[this.Sa=H("profile-expert-edit-input")])]),this.Wc&&(this.Jx=new Nl(this.Wc),this.Jx.n(this.Sa),this.Sa.title=this.Wc),kc(this.xb,this.Re),this.jf(this.$e))};
t.jf=function(b){this.J=new an("/topic/autocomplete",this.Sa,k,k,b,j);this.J.yf(j);this.J.Wh=this.ce;this.J.fp(this.Zj());this.J.Ov=[this.Wc];this.g().c(this.J,"select",this.yo);this.g().c(this.J,km.qh.vi,this.tu);this.g().c(this.J,km.qh.vi,this.qu);this.g().c(this.J,km.qh.EI,function(){$(this.J.L.e).hide()})};t.qu=function(){if(0===this.J.fb.length){var b=K("div",{className:"zu-autocomplete-empty"},"没有名字为 "+$(this.Sa).val()+" 的话题");$(this.J.L.e).html(b).show()}};
t.yo=function(){var b=z.slice(this.J.Xf(),1);b&&3<b.length&&(this.zC=b,this.Ue(b))};t.Ue=function(b){this.data.push(b[1]);var c=$(this.Rf).find("[data-url-token='"+b[1]+"']")[0];c?gk(c):(yj("TopicMediumV2",{member_url_token:S[1],topic_url_token:b[1]},this.Gq,this),$(this.Km).find("[data-url-token='"+b[1]+"']").remove(),this.dispatchEvent("add"))};t.Gq=function(b){b=$(b)[0];lc(this.Rf,b,0);gk(b);Ps(this)};t.Oe=ba();
t.cm=function(){if(!Bg.vc){var b=this;this.Nf&&this.Nf.C();var c=new Jn;c.Yq="expert-item-moving";Kn(c,this.Rf,4);c.v();this.Nf=c;this.g().c(this.Nf,"dragend",function(){this.dispatchEvent("sort")});$("a, input, .del, .add",this.Rf).each(function(){b.g().c(this,"mousedown",function(b){b.stopPropagation()})});this.g().c(this.Nf,"beforedragstart",function(){return J("editing",this.Rf)?m:j})}};
a.Ps=function(b){var c=$(b.Rf).children().length;6<c&&L($(b.Rf).children()[6]);R(H("zh-profile-expert-empty"),0>=c);0<c&&R(H("zh-profile-expert-warning"),m);R(H("active-topics-wrap"),$(b.Km).children().length);b.cm()};t.Zj=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return d+""!==b[2]+""&&3<b.length})},this)},this)};a.Qs=function(b){Yn.call(this,b,0);this.Mr="";this.QB="/topic/ignore"};y(Qs,ts);
Qs.prototype.Ue=function(b){this.Vg||(this.Vg=j,this.xhr=new V(j),P(this.g(),this.xhr,"complete",this.uu),this.xhr.ajax(this.QB,"tid="+b+"&method=add"))};Qs.prototype.Io=function(b){this.Vg||(this.Vg=j,this.xhr=new V(j),this.g().c(this.xhr,"complete",function(){ao(this);this.Oe();this.Vg=m}),this.xhr.ajax(this.QB,"tid="+b+"&method=del"))};a.Rs=function(){Yn.call(this,k,k,"搜索话题");this.vC=k;this.Wc="";this.data=[Eg[0]]};y(Rs,Yn);t=Rs.prototype;
t.n=function(b){this.e=b;this.Re=J("zm-tag-editor-labels",this.e);this.be(j);this.se();this.Ha()};t.xn=function(){this.xb||(this.xb=K("div","zm-tag-editor-editor",[this.sn=K("div","zg-section zg-clear"),this.$e=K("div","zg-section zm-tag-editor-command-buttons-wrap",[this.Sa=H("zh-topic-merge-input"),K("a",{"class":"zg-mr15 zg-btn-blue",href:"#",name:"add",style:"display:none;"},"添加"),this.jD=H("zh-topic-merge-btn")])]),kc(this.xb,this.Re),this.jf(this.$e))};
t.jf=function(b){this.J=new an("/topic/autocomplete",this.Sa,k,k,b,j);this.J.yf(j);this.J.Wh=this.ce;this.J.fp(this.Zj());this.J.Ov=[this.Wc];this.g().c(this.J,"select",this.yo);this.g().c(this.J,km.qh.vi,this.tu)};t.Zj=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return d[1]!==b[1]&&3<b.length})},this)},this)};t.yo=function(){var b=z.slice(this.J.Xf(),1);b&&3<b.length&&(this.zC=b,this.Ue(b[3],b[0]))};
t.Ue=function(b,c){var d=this;setTimeout(function(){d.Sa.value=c});this.vC=b};t.Oe=ba();a.Ss=function(b){Yn.call(this,[],0);this.tC=this.bs=k;this.KB="/reviewq/question?queue_id="+b+"&task_id="};y(Ss,Yn);Ss.prototype.VQ=function(){this.locked=m;var b=Ge(this.sA);b&&b.r?U(b.msg):(this.data=b.msg,this.be(j),ao(this))};a.Ts=function(b,c){us.call(this,b,c)};y(Ts,us);Ts.prototype.jo=0;Ts.prototype.mm=ca("jo");
Ts.prototype.na=function(b,c,d,e){var g=Zf(b),g=dg(g),h;h=Sb(b);h=Zb(h.Ca);h=new Mb(this.Ch.x+h.scrollLeft,this.Ch.y+h.scrollTop);var l=c,n=il(h,b,l,d,g,10,e);if(0!=(n&496)){if(n&16||n&32)l^=2;if(n&64||n&128)l^=1;n=il(h,b,l,d,g,10,e);0!=(n&496)&&il(h,b,c,d,g,this.jo,e)}};a.Us=function(b,c,d,e){ll.call(this,b,c);this.jo=d?5:0;this.Iy=e||i};y(Us,ll);Us.prototype.Fn=p("jo");Us.prototype.mm=ca("jo");
Us.prototype.na=function(b,c,d,e){var g=jl(this.element,this.Lf,b,c,k,d,10,e,this.Iy);if(g&496){var h=Vs(g,this.Lf),c=Vs(g,c),g=jl(this.element,h,b,c,k,d,10,e,this.Iy);g&496&&(h=Vs(g,h),c=Vs(g,c),jl(this.element,h,b,c,k,d,this.Fn(),e,this.Iy))}};
a.Vs=function(b,c){b&48&&(c^=2);b&192&&(c^=1);return c},a.Ws={},a.Xs={},a.Ys=function(b){return b.replace(/\n/g,"<br />")},a.Zs=function(b){function c(b){return $.isNumeric(b)?b+" ":b}var d;d=d||+new Date;if(0>=d-b)return"刚刚";b=Math.floor((d-b)/1E3);d=Math.floor(b/31536E3);if(1<=d)return c(d)+"年前";d=Math.floor(b/2592E3);if(1<=d)return c(d)+"月前";d=Math.floor(b/604800);if(1<=d)return c(d)+"周前";d=Math.floor(b/86400);if(1<=d)return c(d)+"天前";d=Math.floor(b/3600);if(1<=d)return c(d)+"小时前";d=Math.floor(b/
60);if(1<=d)return c(d)+"分钟前";d=Math.floor(b);return c(d)+"秒前"},a.$s=function(){var b=S;return 1===b||0===b?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',b[1],'" title="'+b[0]+'" class="','zm-item-link-avatar">','<img class="zm-item-img-avatar" src="'+b[2]+'" />',"</a>"].join("")},a.at=function(b,c){return!la(b)?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',b[1],'"',c?' class="'+c+'"':"",' title="',b[0],'">',b[0],"</a>"].join("")},a.bt=function(b){if(0===b||1===b)return"匿名用户";var c=K("a",
{href:"/people/"+b[1],title:b[0]},b[0]);c.setAttribute("data-tip","p$t$"+b[1]);return c},a.ct=function(b){if(0===b||1===b)return K("span");if(la(b)){var c=K("a",{href:"/people/"+b[1],title:b[0],"class":"zm-item-link-avatar"},K("img",{src:b[2],"class":"zm-list-avatar"}));c.setAttribute("data-tip","p$t$"+b[1]);return c}},a.dt=function(b){return 1===b?j:la(b)?b[3]===S[3]:m},a.et=function(b,c,d,e,g,h){h&&(e&&(e=$.proxy(e,h)),g&&(g=$.proxy(g,h)));$.post("/node/"+b,{method:c,params:d},function(b){b&&b.r?
g&&g(b):e&&e(b)})},a.ft=function(b){return $.get("/node/FavlistCommentListV2",{params:{favlist_id:b}})},a.gt=function(b){return $.get("/node/FavlistCommentBoxV2",{params:{favlist_id:b}})},a.ht=function(b){return $.post("/node/FavlistCommentAddV2",{method:"add_comment",params:b})},a.it=function(b,c){return $.post("/question/askpeople",{qid:b,uid:c,op:"remove"})},a.jt=function(b,c,d){return $.post("/question/askpeople",{qid:b,uid:c,_source_type:d,op:"add"})},a.kt=function(b){return $.post("/node/QuestionCommentAddV2",
{method:"add_comment",params:b})},a.lt=function(b){return $.get("/node/QuestionCommentListV2",{params:{question_id:b}})},a.mt=function(b){return $.get("/node/QuestionCommentBoxV2",{params:{question_id:b}})},a.nt=function(b,c){return $.post("/node/CommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},a.ot=function(b){return $.post("/node/CommentV2",{method:"remove_comment",params:{comment_id:b}})},a.pt=function(b){return $.get("/node/CommentV2",{params:{comment_id:b}})},
a.qt=function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},a.rt=function(b,c){return $.post("/node/AnswerVoteBarV2",{method:c,params:{answer_id:b}})},a.st=function(b,c){return $.get(c?"/node/AnswerFullVoteInfoV2":"/node/AnswerVoteInfoV2",{params:{answer_id:b}})},a.tt=function(b){return $.get("/node/AnswerCommentListV2",{params:{answer_id:b}})},a.ut=function(b,c){return $.get("/node/AnswerCommentBoxV2",{params:{answer_id:b,load_all:c}})},a.vt=function(b,c,d,e,g){kj.call(this,
b,[c],[d],e,g)};y(vt,kj);vt.prototype.oh=function(){this.element.style.height=Math.round(this.coords[0])+"px"};a.wt=function(b,c,d,e,g){kj.call(this,b,[c],[d],e,g)};y(wt,kj);wt.prototype.oh=function(){this.element.style.width=Math.round(this.coords[0])+"px"};a.xt=function(b,c,d,e,g){(2!=c.length||2!=d.length)&&f(Error("Start and end points must be 2D"));kj.apply(this,arguments)};y(xt,kj);
xt.prototype.oh=function(){var b=this.qi&&this.Dd()?"right":"left";this.element.style[b]=Math.round(this.coords[0])+"px";this.element.style.top=Math.round(this.coords[1])+"px"};
a.yt=function(b){var c={},b=String(b),d="#"==b.charAt(0)?b:"#"+b;if(ns.test(d))return c.zr=ys(d),c.type="hex",c;d=xs(b);if(d.length){var e=d[0],b=d[1],d=d[2],e=Number(e),b=Number(b),d=Number(d);(isNaN(e)||0>e||255<e||isNaN(b)||0>b||255<b||isNaN(d)||0>d||255<d)&&f(Error('"('+e+","+b+","+d+'") is not a valid RGB color'));e=ms(e.toString(16));b=ms(b.toString(16));d=ms(d.toString(16));c.zr="#"+e+b+d;c.type="rgb";return c}if(zs&&(d=zs[b.toLowerCase()]))return c.zr=d,c.type="named",c;f(Error(b+" is not a valid color string"))},
a.zt=void 0,a.At=function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||112<=b.keyCode&&123>=b.keyCode)return m;switch(b.keyCode){case 18:case 20:case 93:case 17:case 40:case 35:case 27:case 36:case 45:case 37:case 224:case 91:case 144:case 12:case 34:case 33:case 19:case 255:case 44:case 39:case 145:case 16:case 38:case 224:case 92:return m;case 0:return!B;default:return 166>b.keyCode||183<b.keyCode}},a.Bt={},a.Ct=function(b,c){var d=Sb(c),e=k;if(A)d=e=d.za().createStyleSheet(),A?d.cssText=b:d.innerHTML=
b;else{var g=Tb(d.Ca,"head",i,i)[0];g||(e=Tb(d.Ca,"body",i,i)[0],g=d.o("head"),e.parentNode.insertBefore(g,e));var h=e=d.o("style");A?h.cssText=b:h.innerHTML=b;d.appendChild(g,e)}},a.Dt=function(b,c){var d=b.style[eb(c)];return"undefined"!==typeof d?d:b.style[Sf(b,c)]||""},a.Et=function(b,c,d){return Math.min(Math.max(b,c),d)},a.Ft=function(){M.call(this)};y(Ft,Hk);
Ft.prototype.v=function(){this.Kr=H("help-index");(new Dp).n(this.Kr);var b=window.location.href,c="";0<b.indexOf("#")&&(c=b.substring(b.indexOf("#")),b=b.substring(0,b.indexOf("#")));"/help"===b.substring(b.length-5)&&(b+="/faq");var d=Ub("a",k,this.Kr);z.forEach(d,function(d){(d.href===b||d.href===b+c)&&Hc(d,function(b){"UL"===b.tagName&&D.add(b,"force-display");"LI"===b.tagName&&D.add(b,"current")})},this);this.g().c(this.Kr,"click",this.VM)};
Ft.prototype.VM=function(b){if((b=kk(this.Kr,b.target))&&0<b.href.indexOf("#")){var c=Ic(b,"ul",k),c=Ub("li",k,c);z.forEach(c,function(b){D.remove(b,"current")},this);D.add(b.parentNode,"current")}};a.Gt=function(b){M.call(this);this.view=this.name=k;F.extend(this.options={},this.R,b||{})};y(Gt,Fd);a.Ht={},a.It=function(b,c){function d(c){Gt.call(this,c);this.name=b}y(d,Gt);ya(d.prototype,c);Ht[b]=d};Gt.prototype.R={};Gt.prototype.g=function(){return this.Mg||(this.Mg=new le(this))};Gt.prototype.v=ba();Gt.prototype.p=function(){Gt.m.p.call(this);this.view&&(F.remove(this.view.nd,this.name),this.view=k);this.Mg&&(this.Mg.C(),this.Mg=k)};a.Jt=function(b){T.call(this);F.extend(this.F={},this.R,b||{});this.source=this.F.source;this.promise=$.Deferred().resolve();this.nd={}};y(Jt,T);t=Jt.prototype;t.R={source:k,Ya:["autoload","shortcut"],Iz:j,$m:"zg-btn-white zu-button-more"};t.Ya=function(b,c){var d,e=Ht[b];e||f(Error("Cannot find constructor"));d=new e(c);d.view=this;this.xa?d.v(this):this.g().c(this,"initialized",function(){d.v(this)});this.nd[b]=d;return this};
t.Fi=function(){!this.Jf&&this.F.Iz&&(this.Jf=this.Pu(),kc(this.Jf,this.e),this.g().c(this.Jf,"click",this.Vx))};t.z=function(){Jt.m.z.call(this);this.Fi();z.forEach(this.Mb(),this.Gq,this);z.forEach(this.F.Ya,this.Ya,this);this.dispatchEvent("initialized")};t.p=function(){F.forEach(this.nd,function(b){b.C()});this.nd=k;Jt.m.p.call(this)};t.Mb=function(){return oc(this.e)};t.Gq=function(b){this.Ij(b);this.dispatchEvent({type:"itemcreated",item:b})};t.Ij=ha;
a.Kt=function(b){b.Jf&&(L(b.Jf),b.Jf=k);b.dispatchEvent("complete")};t.uQ=function(b){if(b){var c=b.results,d=!c||!c.length;d||this.W(c);this.dispatchEvent("next");(d||b.next===m)&&Kt(this)}};t.W=function(b,c){var b=$.isArray(b)?b.join(""):b,d=fc(b+" ");z.forEach(oc(d),this.Gq,this);lc(this.e,d,c)};t.Vx=function(){"pending"!==this.promise.state()&&(this.oH(j),this.promise=this.source().done(v(this.uQ,this)).always(v(xa(this.oH,m),this)))};t.hd=p("Jf");
t.Pu=function(){return K("a",{"aria-role":"button","class":this.F.$m},"更多")};t.oH=function(b){this.Jf&&(this.Jf.innerHTML=b?'<i class="spinner-gray"></i> 加载中':"更多",D.enable(this.Jf,"loading",b))};a.Mt=function(b,c){var d=Array.prototype.slice.call(arguments),e=d.shift();"undefined"==typeof e&&f(Error("[goog.string.format] Template required"));return e.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(b,c,e,n,q,r,x,E){if("%"==r)return"%";var G=d.shift();"undefined"==typeof G&&f(Error("[goog.string.format] Not enough arguments"));arguments[0]=G;return Lt[r].apply(k,arguments)})},a.Lt={s:function(b,c,d){return isNaN(d)||""==d||b.length>=d?b:b=-1<c.indexOf("-",0)?b+Array(d-b.length+
1).join(" "):Array(d-b.length+1).join(" ")+b},f:function(b,c,d,e,g){e=b.toString();isNaN(g)||""==g||(e=b.toFixed(g));var h;h=0>b?"-":0<=c.indexOf("+")?"+":0<=c.indexOf(" ")?" ":"";0<=b&&(e=h+e);if(isNaN(d)||e.length>=d)return e;e=isNaN(g)?Math.abs(b).toString():Math.abs(b).toFixed(g);b=d-e.length-h.length;0<=c.indexOf("-",0)?e=h+e+Array(b+1).join(" "):(c=0<=c.indexOf("0",0)?"0":" ",e=h+Array(b+1).join(c)+e);return e},d:function(b,c,d,e,g,h,l,n){return Lt.f(parseInt(b,10),c,d,e,0,h,l,n)}};Lt.i=Lt.d;
Lt.u=Lt.d;It("activeSource",{R:{UB:"%d 条新动态",$m:"zu-main-feed-fresh-button",aZ:ha},v:function(b){this.data=[];this.button=this.Pu();jc(this.button,b.h());this.g().c(this.button,"click",function(){b.W(this.data,0);this.setData([])});var c=this,d=this.options.source(function(b){b&&b.length&&c.setData(b.concat(c.data))},function(){return c.data});(!d||!qa(d.C))&&f(Error("Source must return a disposable object."));this.BL=d},setData:function(b){this.data=b;this.bQ()},bQ:function(){var b=this.data.length;xc(this.button,
Mt(this.options.UB,b));R(this.button,!!b)},Pu:function(){return K("a",{href:"javascript:;",style:"display:none","class":this.options.$m})},C:function(){Gt.prototype.C.call(this);Tc(this.BL);this.options=k;this.button&&(L(this.button),this.button=k)}});a.Nt=function(){M.call(this);this.size=k;this.gX=vg(document.body).top;this.ga=new le(this);this.up=k;this.sL=250;this.kf()};y(Nt,Fd);ia(Nt);Nt.prototype.kf=function(){this.size=Yb();var b=this.up=new bl(this.update,this.sL,this);this.ga.c(window,"scroll",b.fire,m,b).c(window,"resize",b.fire,m,b)};Nt.prototype.g=p("ga");Nt.prototype.p=function(){Nt.m.p.call(this);this.ga.C();this.ga=k;this.up.C();this.up=k};Nt.prototype.update=function(){this.size=Yb();this.dispatchEvent("update")};
a.Pt=function(b,c,d){var e=Ot;e.ga.c(e,"update",function h(){b.getBoundingClientRect().bottom<this.size.height&&(c.call(d),this.ga.Ba(this,"update",h))})},a.Ot=Nt.D();$(function(){Ot.update()});It("autoload",{R:{rS:function(b){return 0!==b%3}},v:function(b){if(b.hd()){var c=this,d=Ot;c.g().c(d,"update",function(d){var e;e=ua(c);var l=rd[e];if(l){var n=ka("abouttosee"),q=ka(i);n&&q?(l=qd.abouttosee,e=!!l&&!!l[i]&&e in l[i]):e=!n&&!q?j:z.some(l,function(b){return n&&"abouttosee"==b.type||q&&b.capture==i})}else e=m;e&&(pg(b.hd())&&400>=b.hd().getBoundingClientRect().top-d.target.size.height)&&c.dispatchEvent("abouttosee")});var e=0;this.g().c(b,"complete",this.C).c(b,"next",function(){e+=1;
this.options.rS(e)&&this.enable()});this.enable()}},enable:function(){P(this.g(),this,"abouttosee",function(){this.view.Vx()})}});It("childConstructor",{R:{Eh:k},v:function(b){if(qa(this.options.Eh)){var c=this.VK,d=this;b.xa&&z.forEach(b.Mb(),c,d);b.g().c(b,"itemcreated",function(b){c.call(d,b.item)})}},VK:function(b){var c=new this.options.Eh;this.view.M(c);c.n(b)}});It("locationSource",{R:{Rx:20,param:k,Gs:m,offset:function(b){return b.length}},v:function(b){function c(b){return{start:e.Gs?z.rf(b).id.split("-")[1]:0,offset:e.offset(b)}}var d=location.href,e=this.options,g=b.Mb().length;(!g||g<e.Rx)&&Kt(b);b.source=function(){return $.post(d,(e.param||c)(b.Mb())).then(function(c){if(!c.r){var c=c.msg,d=c[0];pa(d)&&d<e.Rx&&Kt(b);return{results:c[1]}}})}}});It("nodeSource",{v:function(b){var c=$(b.h()).data("init"),d="/node/"+c.nodename,e=c.params,g=e.offset||0;b.source=function(){return $.post(d,{method:"next",params:$.extend(e,{offset:g+b.Mb().length})}).then(function(b){return!b.r&&{results:b.msg}})}}});It("shortcut",{R:{items:">div"},v:function(b){b.Mb().length&&(this.wo=new Yk(this.options),this.wo.n(b.h()),this.g().c(this.wo,"action",function(c){c.data.index>=c.data.size&&b.hd()&&pg(b.hd())&&b.hd().click()}))},C:function(){Gt.prototype.C.call(this);this.wo&&(this.wo.C(),this.wo=k)}});a.Qt=function(b){Jt.call(this,b)};y(Qt,Jt);a.St=function(){this.Fc=k;this.hz&&"pending"===this.hz.state()||(this.hz=$.getJSON("/report/reason?type=question").done(function(b){Rt.question.tb=b}))};ia(St);
a.Tt={"0":"其他",501:"不构成问题",502:"广告等垃圾信息",503:"违法违规内容",504:"不宜公开讨论的政治内容",505:"不友善内容",506:"个人信息不合规范",507:"发布不友善内容",508:"发布广告等垃圾信息"},a.Rt={question:{title:"为什么举报这个问题？",tb:[]},comment:{title:"为什么举报这个评论？",tb:[505,502,503,504,0]},answer:{title:"为什么举报这个回答？",tb:[505,502,503,504,0]},favlist:{title:"为什么举报这个收藏？",tb:[505,503,0]},member:{title:"为什么举报这个用户？",tb:[506,507,508,0]},message:{title:"为什么举报这个私信？",tb:[505,502,0]}};t=St.prototype;t.className="report-form-dialog";
t.Sn=function(){if(this.Fc)return this.Fc;var b=new vi;zh(b,j);Fh(b,Hh);b.addEventListener(Gh,this.CM,m,this);return this.Fc=b};t.CM=function(b){if("ok"===b.key)return this.submit()};
t.am=function(b,c,d){var e=this;this.cL=b;this.hz.done(function(){var g=Rt[b],h=e.Sn();h.Xa(g.title);h.La("<form>"+("question"===b?Ut(g.tb):Vt(g.tb))+'<p class="input-container"><input placeholder="请填写举报或申诉原因" type="text" name="detail" class="reason-text hidden zg-form-text-input"></p><p class="error-container"></p><p class="footnote">'+(d||"")+"</p></form>");h.w(j);e.NL={type:b,id:c};var l=$(e.Fc.Y()),g=$("form",l),n=$(".reason-text",l);l.on("change",":radio",function(b){l.find("li").removeClass("checked");
$(b.target).parents("li").addClass("checked");b="0"===this.value;n.toggle(b);b&&n.placeholder()});"question"===e.cL&&n.appendTo(l.find("li").has('input[value="0"]'));g.validate({rules:{reason:"required",detail:{rangelength:[2,100],required:function(){return!!$("input[name=reason]:checked",l).length}}},messages:{reason:"请选择举报理由",detail:"举报理由为 2-100 字"},errorLabelContainer:$(".error-container",g)});D.add(h.h(),St.prototype.className);h.na();h.qm(450);W.X({type:"ga_click_report_box",data:{type:b}})})};
t.submit=function(){var b=this.Fc,c=this.NL,d=$("form",b.h()),e=d.valid();e&&($.post("/report",d.serialize()+"&"+$.param(c)).done(function(c){b.w(m);c.r?U(c.msg):U("您的举报我们已经收到，处理完成后会私信告知处理结果。",2E3)}),W.X({type:"ga_click_report",data:{type:c.type}}));return e};
a.Vt=function(b){var c=['<ul class="options clearfix">'];z.forEach(b,function(b){c.push('<li><label><input value="'+b+'" name="reason" type="radio"> '+Tt[b]+"</label></li>")});c.push("</ul>");return c.join("")},a.Ut=function(b){var c=['<div><a href="http://www.zhihu.com/question/19806261" class="zg-right zg-link-gray">知乎提问规范</a>请选择举报原因</div>','<ul class="question-options clearfix">'];z.forEach(b,function(b){b.nodes?(c.push('<li><label><input name="reason" value="'+b.id+'" type="radio"> '+b.text+'</label><ul class="sub-list">'),
z.forEach(b.nodes,function(e){c.push('<li><label><input required data-msg-required="请选择举报理由" name="reason-'+b.id+'" value="'+e.id+'" type="radio"> '+e.text+"</label>");e.note&&c.push('<div class="note">'+e.note+"</div>");c.push("</li>")}),c.push("</ul></li>")):(c.push('<li><label><input value="'+b.id+'" name="reason" type="radio"> '+b.text+"</label>"),b.note&&c.push('<div class="note">'+b.note+"</div>"),c.push("</li>"))});c.push("</ul>");return c.join("")},a.Wt=St.D();a.Xt=function(){M.call(this);this.Ke="zm-pm-item"};y(Xt,Hk);Xt.prototype.v=function(){var b=H("zh-create-pm");b&&this.g().c(b,"click",this.$P);var b=H("zh-pm-item-wrap"),c=new Qt;c.Ya("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}});c.n(b);this.g().c(b,"click",this.fa);$(function(){$("#zh-change-pm-admin").change(function(){var b=$(this).find("option:selected").attr("data-token");location.href="self"===b?"/admin_feedback":"/admin_feedback/"+b})})};
Xt.prototype.$P=function(){var b;this.Tn();this.Yb.show();gn(this.Yb,-1);(b=Va(location.pathname,"admin_inbox")?"admin":$("#zh-change-pm-admin option:selected").attr("data-token"))&&this.Yb.nt(b)};Xt.prototype.Tn=function(){this.Yb||(this.Yb=new bn)};
Xt.prototype.fa=function(b){if(b=kk(this.GY,b.target)){var c=b.name,d=Ic(b,k,this.Ke);if(!d||!b.name)return j;var b=$(d).data(),e=b.member,g=b.name;switch(c){case "reply":d.getAttribute("data-adminmessagetoken");this.Tn();this.Yb.show();c=this.Yb;d=b.type;c.wm=b.token;c.kA=d;gn(this.Yb,e,g,m);this.Yb.Fb.focus();break;case "delete":var h=d.getAttribute("data-token");Ai("删除私信会话","你确定要删除与 "+g+"的所有会话吗？",function(b){if(b){var c=new V(j);c.on("success",function(){var b=Ge(c);b.r?U(b.msg):window.location.reload()});
c.ajax("/inbox/delete","type=thread&token="+h)}},this);break;case "edit":b=this.Ef,R(this.xc,j),R(b,m),this.ki=-1}}};a.Yt=function(){M.call(this);this.Ke="zm-pm-item"};y(Yt,Hk);
Yt.prototype.v=function(){this.ks=H("zh-pm-detail-item-wrap");this.g().c(this.ks,"click",this.fa);var b=H("zh-pm-editor-form");if(b){this.Yb=new bn;this.Yb.zm=m;this.Yb.dh(b);this.Yb.show();if(b=this.Mb()[0]){var b=$(b).data(),c=this.Yb,d=b.type;c.wm=b.token;c.kA=d;gn(this.Yb,b.member,b.name)}else b=Fg,gn(this.Yb,b.id,b.ew);this.Yb.focus()}this.Mb().length&&(b=new Qt,b.Ya("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}}),b.n(this.ks))};Yt.prototype.Mb=function(){return oc(this.ks)};
Yt.prototype.fa=function(b){var c=kk(this.ks,b.target);if(c&&(b=c.name,c=Ic(c,k,this.Ke))){var c=$(c).data(),d=c.token;switch(b){case "reply":this.Yb.show();var b=this.Yb,e=c.type;b.wm=d;b.kA=e;gn(this.Yb,c.member,c.name,m);this.Yb.focus();break;case "delete":Ai("删除私信","你确定要删除这封私信吗？",function(b){if(b){var c=new V(j);P(this.g(),c,"success",function(){var b=Ge(c);b.r?U(b.msg):window.location.reload()});c.ajax("/inbox/delete","type=single&token="+d)}},this);break;case "report":Wt.am("message",d,"被举报私信将会被管理员查阅")}}};a.Zt=function(){};y(Zt,mq);ia(Zt);Zt.prototype.K=s("goog-menuheader");a.$t=function(b,c,d){uq.call(this,b,d||Zt.D(),c);xq(this,1,m);xq(this,2,m);xq(this,4,m);xq(this,32,m);this.da=1};y($t,uq);sq("goog-menuheader",function(){return new $t(k)});a.au=function(){this.Wu=[]};y(au,mq);ia(au);a.bu=function(b,c){var d=b.Wu[c];if(!d){switch(c){case 0:d=b.K()+"-highlight";break;case 1:d=b.K()+"-checkbox";break;case 2:d=b.K()+"-content"}b.Wu[c]=d}return d};t=au.prototype;t.tc=function(){return Vc.JI};t.o=function(b){var c=b.H().o("div",this.ef(b).join(" "),cu(this,b.bb(),b.H()));du(this,b,c,!!(b.Qb&8)||!!(b.Qb&16));oq(this,b,c);return c};t.Y=function(b){return b&&b.firstChild};
t.n=function(b,c){var d=qc(c),e=bu(this,2);d&&D.has(d,e)||c.appendChild(cu(this,c.childNodes,b.H()));D.has(c,"goog-option")&&(b.$o(j),this.$o(b,c,j));return au.m.n.call(this,b,c)};t.La=function(b,c){var d=this.Y(b),e=eu(this,b)?d.firstChild:k;au.m.La.call(this,b,c);e&&!eu(this,b)&&d.insertBefore(e,d.firstChild||k)};a.cu=function(b,c,d){b=bu(b,2);return d.o("div",b,c)};t.hi=function(b,c,d){c&&(Mc(c,d?Vc.LI:this.tc()),du(this,b,c,d))};t.$o=function(b,c,d){c&&(Mc(c,d?Vc.KI:this.tc()),du(this,b,c,d))};
a.eu=function(b,c){var d=b.Y(c);if(d){var d=d.firstChild,e=bu(b,1);return!!d&&D.has(d,e)}return m},a.du=function(b,c,d,e){e!=eu(b,d)&&(D.enable(d,"goog-option",e),d=b.Y(d),e?(b=bu(b,1),d.insertBefore(c.H().o("div",b),d.firstChild||k)):d.removeChild(d.firstChild))};t.Dn=function(b){switch(b){case 2:return bu(this,0);case 16:case 8:return"goog-option-selected";default:return au.m.Dn.call(this,b)}};
t.sw=function(b){var c=bu(this,0);switch(b){case "goog-option-selected":return 16;case c:return 2;default:return au.m.sw.call(this,b)}};t.K=s("goog-menuitem");a.fu=function(b,c,d,e){uq.call(this,b,e||au.D(),d);this.sa(c)};y(fu,uq);t=fu.prototype;t.U=function(){var b=this.gy;return b!=k?b:this.Jg()};t.sa=ca("gy");t.hi=function(b){xq(this,8,b);this.He()&&!b&&this.Zc(m);var c=this.h();c&&this.L.hi(this,c,b)};t.$o=function(b){xq(this,16,b);var c=this.h();c&&this.L.$o(this,c,b)};
t.Jg=function(){var b=this.bb();return la(b)?(b=z.map(b,function(b){var d=D.get(b);return z.contains(d,"goog-menuitem-accel")||z.contains(d,"goog-menuitem-mnemonic-separator")?"":Gc(b)}).join(""),Ja(b)):fu.m.Jg.call(this)};t.Zf=function(b){var c=this.getParent();if(c){var d=c.dG;c.dG=k;if(c=d&&pa(b.clientX))c=new Mb(b.clientX,b.clientY),c=d==c?j:!d||!c?m:d.x==c.x&&d.y==c.y;if(c)return}fu.m.Zf.call(this,b)};t.gf=function(b){return b.keyCode==this.ey&&this.ee(b)?j:fu.m.gf.call(this,b)};t.kM=p("ey");
sq("goog-menuitem",function(){return new fu(k)});a.gu=function(){};y(gu,Cq);ia(gu);t=gu.prototype;t.tc=function(){return Vc.II};t.Qc=function(b){return"UL"==b.tagName||gu.m.Qc.call(this,b)};t.En=function(b){return"HR"==b.tagName?new Bq:gu.m.En.call(this,b)};t.Kf=function(b,c){return sc(b.h(),c)};t.K=s("goog-menu");t.Ge=function(b){gu.m.Ge.call(this,b);Nc(b.h(),Uc.zk,"true")};a.hu=function(b){Bq.call(this,Aq.D(),b)};y(hu,Bq);sq("goog-menuseparator",function(){return new Bq});a.iu=function(b,c){Cs.call(this,Fq,c||gu.D(),b);this.Qe(m)};y(iu,Cs);t=iu.prototype;t.Lm=j;t.JJ=m;t.K=function(){return this.L.K()};t.Kf=function(b){if(this.L.Kf(this,b))return j;for(var c=0,d=nh(this);c<d;c++){var e=oh(this,c);if("function"==typeof e.Kf&&e.Kf(b))return j}return m};t.Da=function(b){this.M(b,j)};t.wi=function(b,c){this.Bk(b,c,j)};t.removeItem=function(b){(b=this.removeChild(b,j))&&b.C()};t.Nh=function(b){return oh(this,b)};t.nl=function(){return nh(this)};
t.Mb=function(){var b=[];mh(this,function(c){b.push(c)});return b};t.$c=function(b,c){var d=this.Q();d||R(this.h(),j);jg(this.h(),b,c);d||R(this.h(),m)};t.w=function(b,c,d){(c=iu.m.w.call(this,b,c))&&(b&&this.xa&&this.Lm)&&this.hc().focus();this.dG=b&&d&&pa(d.clientX)?new Mb(d.clientX,d.clientY):k;return c};t.Fw=function(b){this.Lm&&this.hc().focus();return iu.m.Fw.call(this,b)};t.WB=function(b){return(this.JJ||b.isEnabled())&&b.Q()&&!!(b.Qb&2)};
t.ea=function(b){var c=this.L,d;d=this.H();d=Tb(d.Ca,"div",c.K()+"-content",b);for(var e=d.length,g=0;g<e;g++)Dq(c,this,d[g]);iu.m.ea.call(this,b)};t.gf=function(b){var c=iu.m.gf.call(this,b);c||mh(this,function(d){!c&&(d.kM&&d.ey==b.keyCode)&&(this.isEnabled()&&this.qd(d),c=d.Vb(b))},this);return c};t.Pb=function(b){iu.m.Pb.call(this,b);(b=oh(this,b))&&fg(b.h(),this.h())};a.ju=function(b,c,d){T.call(this);this.offset=this.dk=0;this.QS=d;this.IL=b;this.url=c||window.location.href;this.Rg="zm-item";this.de={}};y(ju,T);t=ju.prototype;t.Pt=!sb;t.Mt=!sb;t.wf=ca("Rg");t.v=function(){this.Xb=H("zh-load-more");this.n(this.IL)};
t.z=function(){ju.m.z.call(this);this.Pm=1;ku(this);this.xk=$(this.Xb);var b;if(b=this.Xb)a:if(b=this.Mb(),this.offset=this.xs?this.xs(b):b.length,this.yr)b=this.yr(),R(this.Xb,b);else{if(this.Xb){if("-1"===this.xk.attr("data-next")||!b||10>b.length){this.xk.hide();b=m;break a}this.xk.removeClass("hidden").show()}b=j}b&&(this.g().c(this.Xb,"click",function(){this.$n=j;this.ui&&"pending"===this.ui.state()&&1===this.Pm?(this.ui.done(v(this.of,this)),this.Jz=j,lu(this,j)):this.Ay()}),this.Pt&&(this.lA=
new bl(this.xy,100,this),this.g().c(window,"scroll",function(){this.lA.fire()})));mu(this,this.Mb())};a.lu=function(b,c){c?b.xk.html('<i class="spinner-gray"></i>正在加载').prop("disabled",j):b.xk.html("更多").prop("disabled",m)};t.xy=function(){var b=this.Xb;if(b&&pg(b)&&1E3>=b.getBoundingClientRect().top-Yb().height&&!(this.Ls||this.ui&&"pending"===this.ui.state()))this.Mt&&(3===this.Pm?(this.Pm=1,this.Jz=m):(this.$n=m,this.Pm++,this.Jz=j)),nu(this)};
t.Ay=function(){this.Pt&&this.Ls?(this.of(this.Ls),this.Ls=k):(lu(this,j),nu(this))};a.nu=function(b){if(!(b.ui&&"pending"===b.ui.state())){var c=b.sG($.extend(b.de,{offset:b.offset,start:b.dk}));b.ui=$.post(b.url,c).done($.proxy(function(b){this.Pt?this.Jz?this.of(b):(this.Ls=b,lu(this,m)):this.of(b)},b));1!==b.Pm&&lu(b,j)}};t.sG=aa();
t.of=function(b){if(b&&!b.r){var c=b.msg,d=c[0],e=c[1],g;2<c.length&&(g=c[2],this.Xb.setAttribute("data-next",g));0<d&&(this.Fu(e),this.offset=this.xs?this.xs(this.Mb()):this.offset+d);c=j;c=this.yr?this.yr(b):!(-1===g||10>d);R(this.Xb,c);lu(this,m);ou(this)}};a.ou=function(b){b.dispatchEvent({data:{$n:b.$n,Mt:b.Mt},type:"afterload"})};t.Mb=function(){return Vb(this.Rg,this.e)};t.mG=function(b){return b.id.split("-")[1]};
a.ku=function(b){var c=b.Mb(),d;if(b.QS)if(b.Xb&&(d=b.Xb.getAttribute("data-next")),d)b.dk=d;else if(c=z.rf(c))b.dk=b.mG(c)};t.Fu=function(b){var b=la(b)?b.join(""):b,b=fc(b+" "),c=Vb(this.Rg,b);mu(this,c);this.e.appendChild(b);ku(this)};a.mu=function(b,c){z.forEach(c,function(b){var c=this.Ij(b);this.dispatchEvent({data:{item:b,TO:c},type:"itemcreated"})},b)};t.Ij=ha;a.pu=function(b){M.call(this);this.e=b;b=A||C&&!Eb("531")&&"TEXTAREA"==b.tagName;this.N=new le(this);this.N.c(this.e,b?["keydown","paste","cut","drop","input"]:"input",this)};y(pu,Fd);pu.prototype.oa=k;
pu.prototype.handleEvent=function(b){if("input"==b.type)qu(this),(!rb||this.e==Rb(this.e).activeElement)&&this.dispatchEvent(ru(b));else if("keydown"!=b.type||At(b)){var c="keydown"==b.type?this.e.value:k;A&&229==b.keyCode&&(c=k);var d=ru(b);qu(this);this.oa=Jd(function(){this.oa=k;this.e.value!=c&&this.dispatchEvent(d)},0,this)}};a.qu=function(b){b.oa!=k&&(Gd.clearTimeout(b.oa),b.oa=k)},a.ru=function(b){b=new kd(b.Ub);b.type="input";return b};
pu.prototype.p=function(){pu.m.p.call(this);this.N.C();qu(this);delete this.e};a.tu=function(b,c,d,e){M.call(this);this.Pd=b;this.Gh=c;this.eg=d;this.OC=e||su;this.rj=new pu(b);N(this.rj,"input",this.Bo,m,this);this.Di()};y(tu,Fd);a.su=0;t=tu.prototype;t.Bo=function(){this.Di()};t.Di=function(){var b=this.nr();this.Gh&&(0>this.eg-b?(xc(this.Gh,"已超出 "+(b-this.eg)+" 字"),D.add(this.Gh,"zg-text-error")):(xc(this.Gh,"还可以输入 "+(this.eg-b)+" 字"),D.remove(this.Gh,"zg-text-error")))};t.p=function(){tu.m.p.call(this);delete this.Pd;this.rj.C();this.rj=k};t.vj=u(27);t.nr=function(){return this.Pd.value.length};
a.uu=function(b,c,d,e){tu.call(this,b,c,d,e)};y(uu,tu);uu.prototype.nr=function(){return pk(this.Pd.value)};a.vu=function(){M.call(this);this.S=k;this.uH=m;this.Cg={};this.ET=["分享答案","分享问题","分享收藏夹","分享文章"];this.LS=["/answer/share","/question/share","/collection/share","/post/share"]};y(vu,Hk);ia(vu);a.wu={xI:"a",cW:"q",bV:"f",$V:"p"};t=vu.prototype;t.v=function(){this.Sh||(this.g().c(Ii,"question_title_change",function(){this.Cg[this.nh]=k;this.bm()}),this.Sh=j,this.o(),this.Ha(),this.qf())};
t.show=function(){this.v();this.bm();this.yc&&(this.yc.checked=m,this.qf());this.wc&&(this.wc.checked=m,this.qf());iq.D().refresh();this.S.w(j)};t.hide=function(){this.S.w(m)};a.xu=function(b,c,d,e){b.id=c;b.url=d;b.ii=z.indexOf(F.Fa(wu),e);b.nh=e+c;b.wx=e===wu.xI;b.title=b.ET[b.ii];b.MS=e};
t.bm=function(){this.S.Xa(this.title);z.forEach(Vb("zm-webshare-tips-answer",this.e),function(b){R(b,this.wx)},this);z.forEach(Vb("zm-webshare-tips-question",this.e),function(b){R(b,!this.wx)},this);this.Cg[this.nh]||(this.xhr=new V(j),P(this.g(),this.xhr,"success",this.JS),this.xhr.ajax(this.url+"/sharetext","","GET"));H("zh-webshare-sina-pm").value=this.Cg[this.nh]&&this.Cg[this.nh].sina||"加载中...";this.sH.Di();dm(this.Rz);this.Rz.Ap();H("zh-webshare-mail-content").value=this.Cg[this.nh]&&this.Cg[this.nh].mail||
"加载中...";dm(this.XC);this.XC.Ap();var b=this.tk;b.v();b.bm();b.Fb.value=this.Cg[this.nh]&&this.Cg[this.nh].pm||"加载中...";b.vK&&b.vK.Di();dm(b.oG);b.oG.Ap();R(b.xc,j);R(b.Ef,m)};t.JS=function(){var b=Ge(this.xhr);b&&b.r?U(b.msg):(this.Cg[this.nh]=b,this.bm())};t.o=function(){var b=H("zh-webshare-dialog");b?(this.e=b,this.S=new vi(k,m),Fh(this.S,k),this.S.Y().appendChild(this.e),this.tk=new bn,this.tk.sc=this.S,this.tk.dh(H("tb-webshare-letter-content")),this.tk.Ok=m,this.tk.v()):qk("module WebshareDialog does not exist!")};
t.Cz=function(){this.yc.checked=j;this.qf()};t.Bz=function(){this.wc.checked=j;this.qf()};a.yu=function(b,c){var d=H(c+"-content"),e=H(c);z.forEach(b.tT,function(b){D.remove(b,"zm-common-nav-bar-current-light")});z.forEach(b.sT,function(b){R(b,m)});D.add(e,"zm-common-nav-bar-current-light");R(d,j);b.gS||(b.S.na(),b.gS=j)};
t.Ha=function(){var b=J("zm-common-nav-bar",this.e);this.g().c(b,"click",this.QQ);this.tT=Vb("zm-common-nav-bar-link",this.e);this.sT=Vb("zm-tab-content",this.e);this.bv=Vb("zm-command",this.e);this.g().c(this.bv[0],"click",this.fa);this.g().c(this.bv[1],"click",this.fa);this.g().c(this.bv[2],"click",this.fa);this.No=H("zh-webshare-sina-pm");this.Rz=new fm(this.No);this.sH=new uu(this.No,H("zg-webshare-sina-counter"),140,su);this.Ev=H("zh-webshare-mail-reciiver");this.Dv=H("zh-webshare-mail-content");
this.XC=new fm(this.Dv);this.g().c(W,"sina_callback",function(b){this.Cz(b.sb.id,b.sb.name)}).c(W,"qq_callback",function(b){this.Bz(b.sb.id,b.sb.name)});this.Iu();this.g().c(J("zg-btn-blue",this.tk.h()),"click",this.fa)};t.Iu=function(){this.yc=J("sina-checkbox",this.e);this.g().c(this.yc,"change",this.Ko);this.wc=J("qq-checkbox",this.e);this.g().c(this.wc,"change",this.Ko)};
t.qf=function(){var b=J("weibo-share-button",this.e),c=this.yc.checked||this.wc.checked;D.enable(b,"zg-btn-blue",c);D.enable(b,"zg-btn-disabled",!c)};t.Ko=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.yc&&!Qg.id||b===this.wc&&!Rg.id?(window.open(c),b.checked=m):this.qf()};t.QQ=function(b){(b=this.df(b.target))&&yu(this,b.id)};
t.fa=function(b){var c=this.df(b.target);if(c&&c.name)switch(c.name){case "cancel":this.hide();break;case "send_sina":if(!D.has(c,"zg-btn-disabled")&&this.No.value&&zu(this.No.value)){c=new lk(j);c.add("content",Ys(Ua(this.No.value)));var d=[];this.yc.checked&&d.push("sina");this.wc.checked&&d.push("qq");c.add("via",d.join(","));this.Nj(c);0===this.ii?W.X({type:"ga_click_share_answer_weibo",data:{EA:d}}):1===this.ii&&W.X({type:"ga_click_share_question_weibo",data:{EA:d}})}break;case "send_mail":this.Ev.value&&
zu(this.Dv.value)&&(c=new lk(j),c.add("via","email"),c.add("email",this.Ev.value),c.add("title",""),c.add("content",Ys(Ua(this.Dv.value))),this.Nj(c),0===this.ii?W.X("ga_click_share_answer_email"):1===this.ii&&W.X("ga_click_share_question_email"));break;case "send":if(c=this.tk,"-1"===String(c.ki))fn(c,"请填写收信人。");else if(d=c.Fb.value,zu(d))if(Ka(d)){var e=new lk(j);e.add("talker_id",c.ki);e.add("content",Ys(Ua(d)));e.add("via","pm");this.Nj(e);0===this.ii?W.X("ga_click_share_answer_message"):1===
this.ii&&W.X("ga_click_share_question_message")}else fn(c,"请填写私信内容。")}b.stopPropagation();b.preventDefault()};a.zu=function(b){return 0!==b.indexOf("加载中")};t.Nj=function(b){b.add(this.MS+"id",this.id);this.xhr=new V(j);P(this.g(),this.xhr,"complete",this.wu);this.xhr.ajax(this.LS[this.ii],b.Ic())};t.wu=function(){var b=Ge(this.xhr);b&&b.r?U(b.msg):(this.S.w(m),U("分享发送完毕"),this.Ev.value="")};t.Q=function(){return this.S.Q()};a.Au=void 0,a.Bu=[],a.Cu=[].slice,a.Du=zk(550,function(){if(Bu.length){var b={items:JSON.stringify(Bu)};$.post("/lastread/touch",b);Bu=[]}});Au=function(){Bu.push(Cu.call(arguments));Du()};a.Eu=function(b,c,d,e){Us.call(this,b,c,d||e);if(d||e)this.mm(65|(e?32:132))};y(Eu,Us);a.Fu=function(){};y(Fu,Hq);ia(Fu);t=Fu.prototype;t.o=function(b){var c={"class":"goog-inline-block "+this.ef(b).join(" "),title:b.Yf()||""},c=b.H().o("div",c,this.Fi(b.bb(),b.H()));oq(this,b,c);return c};t.tc=function(){return Vc.Pp};t.Y=function(b){return b&&b.firstChild.firstChild};t.Fi=function(b,c){return c.o("div","goog-inline-block "+(this.K()+"-outer-box"),c.o("div","goog-inline-block "+(this.K()+"-inner-box"),b))};t.Qc=function(b){return"DIV"==b.tagName};
t.n=function(b,c){Gu(c,j);Gu(c,m);var d;a:{d=b.H().xD(c);var e=this.K()+"-outer-box";if(d&&D.has(d,e)&&(d=b.H().xD(d),e=this.K()+"-inner-box",d&&D.has(d,e))){d=j;break a}d=m}d||c.appendChild(this.Fi(c.childNodes,b.H()));D.add(c,"goog-inline-block",this.K());return Fu.m.n.call(this,b,c)};t.K=s("goog-custom-button");
a.Gu=function(b,c){if(b)for(var d=c?b.firstChild:b.lastChild,e;d&&d.parentNode==b;){e=c?d.nextSibling:d.previousSibling;if(3==d.nodeType){var g=d.nodeValue;if(""==Ka(g))b.removeChild(d);else{d.nodeValue=c?g.replace(/^[\s\xa0]+/,""):La(g);break}}else break;d=e}};a.Hu=function(){};y(Hu,Fu);ia(Hu);B&&(Hu.prototype.La=function(b,c){var d=Hu.m.Y.call(this,b&&b.firstChild);d&&mc(this.createCaption(c,Sb(b)),d)});t=Hu.prototype;t.Y=function(b){b=Hu.m.Y.call(this,b&&b.firstChild);B&&(b&&b.__goog_wrapper_div)&&(b=b.firstChild);return b};t.n=function(b,c){var d=Ub("*","goog-menu",c)[0];if(d){R(d,m);Rb(d).body.appendChild(d);var e=new iu;e.n(d);b.eh(e)}return Hu.m.n.call(this,b,c)};
t.Fi=function(b,c){return Hu.m.Fi.call(this,[this.createCaption(b,c),c.o("div","goog-inline-block "+(this.K()+"-dropdown")," ")],c)};t.createCaption=function(b,c){return Iu(b,this.K(),c)};a.Iu=function(b,c,d){return d.o("div","goog-inline-block "+(c+"-caption"),b)};t.K=s("goog-menu-button");a.Ju=function(b,c,d,e){Jq.call(this,b,d||Hu.D(),e);xq(this,64,j);this.Kl=new Eu(k,5);c&&this.eh(c);this.jF=k;this.oa=new Hd(500);if((fi||gi)&&!Eb("533.17.9"))this.Wr=j};y(Ju,Jq);t=Ju.prototype;t.Wr=m;t.Ys=m;t.z=function(){Ju.m.z.call(this);this.qa&&Ku(this,this.qa,j);Nc(this.h(),Uc.zk,"true")};t.ib=function(){Ju.m.ib.call(this);if(this.qa){this.ub(m);this.qa.ib();Ku(this,this.qa,m);var b=this.qa.h();b&&L(b)}};t.p=function(){Ju.m.p.call(this);this.qa&&(this.qa.C(),delete this.qa);delete this.CR;this.oa.C()};
t.De=function(b){Ju.m.De.call(this,b);this.Gb()&&(this.ub(!this.qb(),b),this.qa&&(b=this.qb(),this.qa.fg=b))};t.Zf=function(b){Ju.m.Zf.call(this,b);this.qa&&!this.Gb()&&(this.qa.fg=m)};t.ee=function(){this.setActive(m);return j};t.DM=function(b){this.qa&&(this.qa.Q()&&!this.Kf(b.target))&&this.ub(m)};t.Kf=function(b){return b&&sc(this.h(),b)||this.qa&&this.qa.Kf(b)||m};
t.gf=function(b){if(32==b.keyCode){if(b.preventDefault(),"keyup"!=b.type)return j}else if("key"!=b.type)return m;if(this.qa&&this.qa.Q()){var c=this.qa.Vb(b);return 27==b.keyCode?(this.ub(m),j):c}return 40==b.keyCode||38==b.keyCode||32==b.keyCode||13==b.keyCode?(this.ub(j),j):m};t.Mn=function(){this.ub(m)};t.dN=function(){this.Gb()||this.ub(m)};t.Uc=function(b){this.Wr||this.ub(m);Ju.m.Uc.call(this,b)};t.Wa=function(){this.qa||this.eh(new iu(this.H()));return this.qa||k};
t.eh=function(b){var c=this.qa;if(b!=c&&(c&&(this.ub(m),this.xa&&Ku(this,c,m),delete this.qa),b)){this.qa=b;lh(b,this);b.w(m);var d=this.Wr;(b.Lm=d)&&b.Qe(j);this.xa&&Ku(this,b,j)}return c};t.Da=function(b){this.Wa().M(b,j)};t.wi=function(b,c){this.Wa().Bk(b,c,j)};t.removeItem=function(b){(b=this.Wa().removeChild(b,j))&&b.C()};t.Nh=function(b){return this.qa?oh(this.qa,b):k};t.nl=function(){return this.qa?nh(this.qa):0};t.w=function(b,c){var d=Ju.m.w.call(this,b,c);d&&!this.Q()&&this.ub(m);return d};
t.gb=function(b){Ju.m.gb.call(this,b);this.isEnabled()||this.ub(m)};a.Lu=function(b){b.Kl.mm&&b.Kl.mm(33)};t.nH=function(){this.ub(j)};
t.ub=function(b,c){Ju.m.ub.call(this,b);if(this.qa&&!!(this.da&64)==b){if(b)this.qa.xa||(this.Ys?this.qa.W(this.h().parentNode):this.qa.W()),this.qk=dg(this.h()),this.Ai=ng(this.h()),Mu(this),this.qa.Pb(-1);else if(this.setActive(m),this.qa.fg=m,this.h()&&Nc(this.h(),Uc.Fm,""),this.Fs!=k){this.Fs=i;var d=this.qa.h();d&&kg(d,"","")}this.qa.w(b,m,c);if(!this.Mf){var d=this.g(),e=b?d.c:d.Ba;e.call(d,this.H().za(),"mousedown",this.DM,j);this.Wr&&e.call(d,this.qa,"blur",this.dN);e.call(d,this.oa,Id,this.Pl);
b?this.oa.start():this.oa.stop()}}};a.Mu=function(b){if(b.qa.xa){var c=b.Kl;b.Kl.element=b.CR||b.h();var d=b.qa.h();b.qa.Q()||(d.style.visibility="hidden",R(d,j));!b.Fs&&(b.Kl.Fn&&b.Kl.Fn()&32)&&(b.Fs=mg(d));c.na(d,c.Lf^1,b.jF,b.Fs);b.qa.Q()||(R(d,m),d.style.visibility="visible")}};
t.Pl=function(){var b=ng(this.h()),c=dg(this.h());if(!(this.Ai==b||(!this.Ai||!b?0:this.Ai.left==b.left&&this.Ai.width==b.width&&this.Ai.top==b.top&&this.Ai.height==b.height))||!(this.qk==c||(!this.qk||!c?0:this.qk.top==c.top&&this.qk.right==c.right&&this.qk.bottom==c.bottom&&this.qk.left==c.left)))this.Ai=b,this.qk=c,Mu(this)};a.Ku=function(b,c,d){var e=b.g(),d=d?e.c:e.Ba;d.call(e,c,"action",b.Mn);d.call(e,c,"highlight",b.Kw);d.call(e,c,"unhighlight",b.Uw)};t.Kw=function(b){Nc(this.h(),Uc.Fm,b.target.h().id)};
t.Uw=function(){Fs(this.qa)||Nc(this.h(),Uc.Fm,"")};sq("goog-menu-button",function(){return new Ju(k)});a.Nu=function(b,c){iu.call(this,b,c);this.Lm=j;this.Qe(j);this.w(m,j);this.Af=new Md};y(Nu,iu);t=Nu.prototype;t.HT=m;t.LE=0;t.xe=k;t.ea=function(b){Nu.m.ea.call(this,b);(b=b.getAttribute("for")||b.htmlFor)&&this.attach(this.H().h(b),1)};t.z=function(){Nu.m.z.call(this);Kd.forEach(this.Af,this.FB,this);var b=this.g();b.c(this,"action",this.KP);b.c(this.H().za(),"mousedown",this.KF,j);C&&b.c(this.H().za(),"contextmenu",this.KF,j)};
t.attach=function(b,c,d,e,g){if(!b||!this.Af.Md(ua(b)))b?(c={e:b,DH:c,tP:d,bD:e?"contextmenu":"mousedown",$x:g},this.Af.set(ua(b),c),b=c):b=k,this.xa&&this.FB(b)};t.FB=function(b){this.g().c(b.e,b.bD,this.$F)};t.detach=function(b){(!b||!this.Af.Md(ua(b)))&&f(Error("Menu not attached to provided element, unable to detach."));b=ua(b);if(this.xa){var c=this.Af.get(b);this.g().Ba(c.e,c.bD,this.$F)}this.Af.remove(b)};
a.Ou=function(b,c,d,e,g){var h=b.Q();b.Dx()&&b.HT?b.hide():(b.xe=g||k,b.dispatchEvent("beforeshow")&&(d="undefined"!=typeof d?d:4,h||(b.h().style.visibility="hidden"),R(b.h(),j),c.na(b.h(),d,e),h||(b.h().style.visibility="visible"),b.Pb(-1),b.w(j)))};t.nH=function(b,c,d){c=ka(b.DH)?new Us(b.e,b.DH,j):new Ts(c,d);c.mm&&c.mm(5);Ou(this,c,b.tP,b.$x,b.e)};t.hide=function(){this.Q()&&(this.w(m),this.Q()||(this.LE=za(),this.xe=k))};t.Dx=function(){return this.Q()||150>za()-this.LE};t.KP=function(){this.hide()};
t.$F=function(b){for(var c=this.Af.Eb(),d=0;d<c.length;d++){var e=this.Af.get(c[d]);if(e.e==b.currentTarget){this.nH(e,b.clientX,b.clientY);b.preventDefault();b.stopPropagation();break}}};t.KF=function(b){this.Q()&&!this.Kf(b.target)&&this.hide()};t.Uc=function(b){Nu.m.Uc.call(this,b);this.hide()};t.p=function(){Nu.m.p.call(this);this.Af&&(this.Af.clear(),delete this.Af)};a.Pu=function(b){cq.call(this,j,"/topic/bio/update","bio");this.pg=b[0];this.de=["tid="+this.pg[3]];this.content=b[1];this.Ab='<a href="javascript:;" name="edit">描述你关于 '+this.pg[0]+" 的经验</a>";this.Ot=j};y(Pu,cq);Pu.prototype.Gi=function(){Pu.m.Gi.call(this);this.hn.innerHTML="更新"};Pu.prototype.ea=function(b){Pu.m.ea.call(this,b);var b=this.H(),c=b.o("strong",k,K("a",{href:"/topic/"+this.pg[1],title:this.pg[0],"class":""},this.pg[0]));b.Xn(c,this.nc)};a.Qu=function(b,c){M.call(this);this.nO=c;this.Wk=b;this.items=[];this.kZ="/url_to_fetch_question_related_topic_bio_items";this.Qx=m};y(Qu,Hk);
a.Ru=k,a.Su=function(){Ru||(Ru=new Qu(Dg,m));return Ru},a.Tu=function(b){if(!b.locked)if(!b.vP&&b.Qx){b.locked=j;var c=new V(j);b.g().c(c,"success",function(b){this.vP=j;this.locked=m;b=Ge(b.target);b.r||(this.Wk=b.msg,Tu(this))});c.ajax("/question/"+b.GG+"/bios",k,"GET")}else b.S||(b.S=new vi,b.S.Xa("修改话题经验"),Fh(b.S,k),zh(b.S,m),c=b.S.Y(),c.innerHTML='<div class="zg-section-title">修改每个话题旁边靠近你名字的简介：</div>',b.W(c)),b.S.w(j)};
Qu.prototype.W=function(b){this.e=K("div","zu-bio-editor-wrap",[this.qO=K("div","zu-bio-editor-inner-wrap"),this.fd=K("div","zm-command",[this.hn=K("a",{name:"save",href:"javascript:;",className:"zg-r3px zg-btn-blue"},"完成")])]);z.forEach(this.Wk,function(b){b=new Pu(b);b.W(this.qO);this.items.push(b)},this);this.nO&&R(this.fd,m);b.appendChild(this.e);this.g().c(this.fd,"click",this.fa)};
Qu.prototype.fw=function(){var b=this.items.length,c;if(!b&&this.Wk.length)for(c=0;c<this.Wk.length;c++)if(this.Wk[c][1])return this.Wk[c][1];var d=k;for(c=0;c<b;c++)if(d=this.items[c].bb())return d};Qu.prototype.fa=function(b){if((b=this.df(b.target))&&"save"===b.name)this.S&&this.S.w(m),this.dispatchEvent("change")};a.Uu=function(){M.call(this);this.S=k;this.ka=0;this.Sx=[];this.js=[];this.nA="最多输入 20 字";this.wv="最多输入 256 字"};y(Uu,Hk);a.Vu=k,a.Wu=function(){Vu||(Vu=new Uu);return Vu};t=Uu.prototype;t.v=function(b){b||this.or()};
t.o=function(){this.RC=j;this.e=K("div",k,[this.yj=K("div",k,[this.Ug=K("div","zm-favo-list-content"),this.jB=K("div","zh-favo-add-new-wrap zm-command",this.iT=K("a",{"class":"zm-favo-dialog-create zg-left",href:"javascript:;"},"+ 创建收藏夹"),this.$u=K("a",{href:"javascript:;","class":"zg-btn-blue"},"关闭")),this.ru=K("div","zh-favo-add-new-wrap zm-command",this.IK=K("a",{href:"javascript:;","class":""},"取消"),this.jT=K("a",{"class":"zm-favo-dialog-create zg-btn-blue",href:"javascript:;"},"创建收藏夹"))]),this.jl=
K("div",{style:"display:none"},[K("div",k,"标题"),K("div","zg-section",this.Il=K("input",{"class":"zg-form-text-input",style:"width:97%;font-size:13px"})),K("div",k,"描述（可选）"),K("div","zg-section zg-editor-simple-wrap zg-form-text-input",this.Hl=K("textarea",{"class":"zg-editor-input",style:"height:66px"})),this.KR=K("label",k,[this.LO=K("input",{type:"radio",checked:"checked",value:"public",name:"mode"}),K("strong",k," 公开 "),K("span","zg-gray-normal","公开后不能设置为私密")]),this.VO=K("br"),this.IR=K("label",
k,[this.KO=K("input",{type:"radio",value:"private",name:"mode"}),K("strong",k," 私密 "),K("span","zg-gray-normal","只有你可以查看这个收藏夹")]),K("div","zm-command",[this.Zz=K("a",{href:"javascript:;","class":"zg-mr10"},"取消"),this.xq=K("a",{href:"javascript:;","class":"zg-mr10"},"完成"),this.iB=K("a",{"class":"zg-btn-blue"},"确认创建")])])]);R(this.ru,m);(new Nl(this.nA)).n(this.Il);(new Nl(this.wv)).n(this.Hl);z.forEach(this.Sx,function(b){Xu(this,b)},this);this.Sx.length||(this.Ug.innerHTML='<div id="zh-fav-list-item-place-holder" class="zg-r5px zm-fav-list-item-place-holder">你可以创建多个收藏夹，将答案分类收藏</div> ',
R(this.ru,j),R(this.jB,m));this.S=new vi(k,m);Fh(this.S,k);this.S.Y().appendChild(this.e);this.g().c(this.S,"afterhide",function(){this.ye()})};
a.Xu=function(b,c,d){var e=H("zh-fav-list-item-place-holder");e&&R(e,m);b.Wy=c[5]?"":K("a","zm-fav-list-item-lock zg-locked");e=K("span","zm-favo-list-item-title");e.innerHTML=c[1];e=K("a",{"class":"zg-r5px zm-favo-list-item-link",href:"javascript:;"},[b.Wy,e,K("span",{className:"zg-gray",innerHTML:'<span class="num">'+c[3]+'</span> 条答案 <span class="zg-bull">•</span> '+c[4]+" 人关注"})]);b.Wy&&b.Wy.setAttribute("data-tip","s$b$私密收藏夹");e.setAttribute("data-lid",c[0]);z.contains(b.js,c[0])&&D.add(e,"zm-favo-list-item-link-active");
c=J("zm-favo-list-item-link",b.Ug);d&&c?jc(e,c):b.Ug.appendChild(e)};t.Ha=function(){this.g().c(this.Zz,"click",function(){this.ka?Yu(this,0):Zu(this)}).c(this.iT,"click",function(){W.X({type:"ga_click_add_collection"});Yu(this,1)}).c(this.$u,"click",function(){Zu(this)}).c(this.jT,"click",function(){W.X({type:"ga_click_add_collection"});Yu(this,1)}).c(this.IK,"click",function(){Zu(this)}).c(this.xq,"click",function(){Zu(this)}).c(this.iB,"click",this.pf).c(this.Ug,"click",this.KQ)};
t.KQ=function(b){var c=Ic(b.target,"A");if(c&&!this.locked){var b=c.getAttribute("data-lid"),d=m;D.has(c,"zm-favo-list-item-link-active")?(d=j,this.xC=b):this.rC=b;c=new lk;c.add("answer_id",this.ka);c.add("favlist_id",b);this.tz=new V(j);this.locked=j;P(this.g(),this.tz,"complete",this.CJ);this.tz.ajax(d?"/collection/remove":"/collection/add",c.Ic())}};
t.CJ=function(){this.locked=m;this.$u.innerHTML="关闭";var b=Ge(this.tz);b&&!b.r?(b=Vb("zm-favo-list-item-link",this.Ug),z.forEach(b,function(b){var d=b.getAttribute("data-lid"),e=J("num",b),g=parseInt(e.innerHTML,10);d===this.xC?(e.innerHTML=g-1+"",D.remove(b,"zm-favo-list-item-link-active")):d===this.rC&&(e.innerHTML=g+1+"",D.add(b,"zm-favo-list-item-link-active"))},this),this.rC=this.xC=k,rk("Favorite","add_favorite")):U("添加失败: "+b.msg)};
t.show=function(b){this.v(b);this.dy&&(this.S.w(j),this.$u.innerHTML="关闭",this.ka?(R(this.xq,m),Yu(this,0)):(Yu(this,1),R(this.Zz,m),this.xq.innerHTML="取消"))};
a.bv=function(b,c,d,e){b.title=Ya(c||H("zh-fav-head-title").innerHTML);c=H("zh-fav-head-description-source");b.vv=d||(c?c.innerHTML:"");b.vv=bk(b.vv);b.wC=e||Gg;b.RC?$u(b):b.o();b.dy=j;b.Ha();Yu(b,1);R(b.Zz,m);b.xq.innerHTML="取消";b.iB.innerHTML="保存";b.S.Xa("编辑收藏夹");b.Il.value=b.title;b.Hl.value=b.vv;b.wC[1]?(R(b.KR,m),R(b.IR,m),R(b.VO,m)):b.KO.setAttribute("checked",j);b.mO=av(b);b.S.w(j);b.Vr=j};t.or=function(){(this.ka||!this.dy)&&$.get("/collections/json",{answer_id:this.ka}).done(v(this.yQ,this))};
a.$u=function(b){var c=Vb("zm-favo-list-item-link",b.Ug);z.forEach(c,function(b){var c=b.getAttribute("data-lid");D.remove(b,"zm-favo-list-item-link-active");z.contains(this.js,+c)&&D.add(b,"zm-favo-list-item-link-active")},b)};t.yQ=function(b){b&&!b.r&&(this.Sx=b.msg[0],this.js=b.msg[1],this.RC?$u(this):this.o(),this.dy=j,this.Ha(),this.show(j))};
a.Yu=function(b,c){var d=!!c;b.S.Xa(0===c?"添加到收藏夹":"创建新收藏夹");R(b.yj,!d);R(b.jl,d);new Rm(b.Il,b.nA);new Rm(b.Hl,b.wv);if(1===c)$(b.jl).on("change.FavoDiag","input, textarea, select",function(){b.Qd()});else $(b.jl).off("change.FavoDiag"),b.ye()},a.av=function(b){var c=new lk,d=ak(b.Il.value),e=Ua(b.Hl.value===b.wv?"":b.Hl.value);e||(e=-1);c.add("title",d);c.add("description",e);c.add("is_public",b.LO.checked?1:0);return c};
t.pf=function(){var b=ak(this.Il.value);if(b&&b!==this.nA){b=av(this);this.ka&&b.add("answer_id",this.ka);if(this.Vr){if(this.mO.Ic()===b.Ic()){Zu(this);return}b.add("favlist_id",this.wC[0])}this.xhr=new V(j);P(this.g(),this.xhr,"complete",this.mJ);this.xhr.ajax(this.Vr?"/collection/update":"/collection/create",b.Ic())}};
t.mJ=function(){var b=Ge(this.xhr);b&&!b.r?this.Vr?(Zu(this),U("编辑成功"),setTimeout(function(){window.location.reload()},1E3),this.Vr=m):this.ka?(R(this.ru,m),R(this.jB,j),Yu(this,0),this.js.push(b.msg[0]),Xu(this,b.msg,j),this.Il.value="",this.Hl.value=""):(Zu(this),U("创建成功"),setTimeout(function(){window.location.href="/collections/mine"},1E3)):U(b.msg)};t.Q=function(){return this.S.Q()};
a.Zu=function(b){b.S.w(m);b.dispatchEvent(cv);W.X({type:"ga_click_collect_answer",data:{count:$(".zm-favo-list-item-link-active",b.Ug).length}})},a.cv="close";Uu.prototype.Qd=function(){$(window).on("beforeunload.FavoDiag",v(s("你对收藏夹的修改还未保存，确认离开该页面吗？"),this))};Uu.prototype.ye=function(){$(window).off("beforeunload.FavoDiag")};a.dv=function(b,c){return $.post("/node/ColumnPostVoteBarV2",{method:c,params:{post_id:b}})},a.ev=function(b,c){return $.get(c?"/node/ColumnPostFullVoteInfoV2":"/node/ColumnPostVoteInfoV2",{params:{post_id:b}})},a.fv=function(b){return $.get("/node/PostCommentV2",{params:{comment_id:b}})},a.gv=function(b){return $.post("/node/PostCommentV2",{method:"add_comment",params:b})},a.hv=function(b,c){return $.post("/node/PostCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},
a.iv=function(b){return $.post("/node/PostCommentV2",{method:"remove_comment",params:{comment_id:b}})},a.jv=function(b,c){return $.get("/node/PostCommentBoxV2",{params:{post_id:b,load_all:c}})},a.kv=function(b){return $.get("/node/PostCommentListV2",{params:{post_id:b}})};a.lv=function(b,c,d){T.call(this);this.Sc=b;this.entryType=c||"answer";this.xd=k;this.F=$.extend({},this.R,d||{})};y(lv,T);a.mv={Te:1,wg:-1,WA:0};lv.prototype.R={aU:"up",DL:"down",Ms:"pressed"};F.extend(lv.prototype,mv);t=lv.prototype;t.da=mv.WA;
t.n=function(b){lv.m.n.call(this,b);var c=this.F,b=this.G=$(b);this.du=$("."+c.aU,b);this.Yt=$("."+c.DL,b);c=this.Yt.hasClass(this.F.Ms);this.du.hasClass(this.F.Ms)?this.da=mv.Te:c&&(this.da=mv.wg);nv(this);this.du.click($.proxy(this.pA,this));this.Yt.click($.proxy(this.oA,this));return this};t.Xd=p("da");
t.Zb=function(b){S.Ma()?b!==this.da&&F.Bg(mv,b)&&(this.dispatchEvent({type:"action",data:{state:b}}),this.xd&&"pending"===this.xd.state()&&this.xd.abort(),this.da=b,nv(this),b={},b[mv.Te]="vote_up",b[mv.wg]="vote_down",b[mv.WA]="vote_neutral",this.xd=("post"===this.entryType?dv:rt)(this.Sc,b[this.da]),this.xd.done(v(function(b){b.r||(this.zs(),Ii.dispatchEvent(new ds(this.Sc,b.msg)))},this))):(b=b===mv.Te?"question_answer_vote_up":"question_answer_vote_down",nk.D().Ga=b,nk.D().w(j),nk.D().fh(""))};
t.ST=function(b){b===mv.Te?rk("vote","voteup","side_vote"):b===mv.wg&&rk("vote","votedown","side_vote")};t.pA=function(){this.Zb(this.da===mv.wg?mv.Te:this.da^mv.Te)};t.oA=function(){this.Zb(this.da===mv.Te?mv.wg:this.da^mv.wg)};
a.nv=function(b){var c=b.da,d=b.F,e="",g=c===mv.Te,c=c===mv.wg;b.du.toggleClass(d.Ms,g).html('<i class="icon vote-arrow"/>'+(e=g?"取消赞同":"赞同")).attr("aria-pressed",g).attr("data-tip","s$r$"+e);b.Yt.toggleClass(d.Ms,c).html('<i class="icon vote-arrow"/>'+(e=c?"取消反对":"反对，不会显示你的姓名")).attr("aria-pressed",c).attr("data-tip","s$r$"+e)};t.zs=function(){this.dispatchEvent("change")};a.ov=function(b,c){this.Sc=b;this.entryType=c;this.Xl=k;this.yd=m};y(ov,T);t=ov.prototype;t.ic=p("yd");t.Ia=function(b){this.yd=!!b};t.cb=function(){return this.Ip.data("votecount")};a.pv=function(b){b=b.cb();return 1E3>b?b:Math.round(b/1E3)+"K"};t.Tj=function(){this.Xl&&"pending"===this.Xl.state()||(this.Xl=("post"===this.entryType?ev:st)(this.Sc,this.yd).done(v(this.Zs,this)))};t.Zs=function(b){if(b=Ka(b))b=$(b),this.Ip.replaceWith(b),this.Ip=b,this.dispatchEvent("change")};
t.z=function(){this.Ip=$(this.e);var b=this;$("a.more",this.Ip).click(function(){b.Ia(j);b.Tj()})};a.qv=function(){M.call(this);this.tb=[];this.WW="";this.dl=this.Fc=k;this.kf()};y(qv,Hk);ia(qv);
a.rv=Ng,a.sv={"remove-question":{Ff:"删除",title:"确定要删除该问题吗？",tb:[300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,99,0]},"mute-question":{Ff:"隔离",title:"确定要隔离该问题吗？",tb:[130,131,132,0]},"unmute-question":{Ff:"解除隔离",title:"确定要解除隔离该问题吗？",tb:[0]},"lock-question":{Ff:"锁定",title:"确定要锁定该问题吗？",tb:[140]},"unlock-question":{Ff:"解除锁定",title:"确定要解除锁定该问题吗？",tb:[0]},"remove-answer":{Ff:"删除",title:"确定要删除该答案吗？",tb:[300,301,302,303,304,305,99,0]},"collapse-answer":{Ff:"折叠",title:"确定要折叠该答案吗？",tb:[220,
221,222,223,224,225]},"uncollapse-answer":{Ff:"解除折叠",title:"确定要解除折叠该答案吗？",tb:[0]},"remove-comment":{Ff:"删除",title:"确定要删除该评论吗？",tb:[300,301,302,303,304,305,99,0]},"remove-image":{Ff:"删除",title:"确定要删除该图片吗？",tb:[180,181,182,183,184]},"remove-video":{Ff:"删除",title:"确定要删除该视频吗？",tb:[200,201,202,203,204]}},a.tv={"delete":'<span class="zg-gray-normal">删除后将私信通知作者并备份该内容</span>'},a.uv=function(b,c,d){var e=new V(j);e.addEventListener("success",function(b){b=Ge(b.target);if(b.r)U(b.msg);else{var c=b.msg;if(c){if(c.refresh){setTimeout(function(){window.location.reload()},
2E3);return}if(c.redirect){window.location.href=c.redirect;return}}U("操作成功！");d&&d(b)}});e.ajax(b,c)};t=qv.prototype;t.kf=function(){this.o();this.Ha()};
t.o=function(){var b=K("div",{style:"min-height:80px;padding:15px 0 0 0"},[this.BY=K("div","zg-section",[this.Rj=K("select",{style:"min-width: 250px; max-width: 100%;"}),this.yn=K("label",{className:"zg-error-text",style:"display:none;margin-left:.5em;white-space: nowrap;"},"请填写修改理由")]),this.su=K("div"),this.sP=K("div",{"class":"zg-gray-normal"}),this.BG=K("div",{"class":"zg-form-text-input",style:"display:none"},this.Zg=K("textarea",{style:"width:100%"}))]);this.Fc=new vi;zh(this.Fc,j);Fh(this.Fc,
Hh);this.Fc.Y().appendChild(b)};t.Ha=function(){this.g().c(this.Zg,["change","input"],function(){R(this.yn,!Ka(this.Zg.value))}).c(this.Rj,"change",this.tN).c(this.Fc,Dh,this.Jw).c(this.Fc,Gh,function(b){if("ok"===b.key)return this.gj();if(b.key===Ih)return this.Jn()})};t.Jw=function(){this.dl=this.Mq=k;vv(this)};t.Jn=function(){this.$&&this.$.Gb()&&this.$.abort();this.Fc.w(m);this.dispatchEvent("cancel")};
t.gj=function(){if(this.$&&this.$.Gb())return m;var b="0"===this.Rj.value,c=this.Zg.value;if(this.Mq&&this.Rj){if(b&&!c)return R(this.yn,j),this.Zg.focus(),m;R(this.yn,m);var d=this.Mq.getAttribute("data-action"),e=this.Mq.getAttribute("data-content");e&&this.ju&&(e=e+"&"+this.ju);e=new Qi(e||this.ju);e.add("reason",this.Rj.value);b&&e.add("detail",c);uv(d,e.toString(),v(this.vN,this))}};t.vN=function(b){this.Fc.w(m);this.mb&&this.mb(b)};t.w=function(b){this.Fc.w(b)};
a.vv=function(b){b.Zg.value="";b.Rj.innerHTML="";b.su.innerHTML="";R(b.yn,m)},a.xv=function(b,c,d,e,g){vv(b);b.mb=d;b.ju=g;b.Mq=c;(c=sv[c.getAttribute("data-op")])?(b.Fc.Xa(c.title),xc(b.Fc.qc.hd("ok"),c.Ff||"确定"),c=c.tb,R(b.BG,1===c.length&&0===c[0]),e="delete"===e||z.contains(c,99),b.su.innerHTML=e?tv["delete"]:"",z.forEach(c,function(b){this.Rj.appendChild(K("option",{value:b},rv[+b]))},b),wv(b,Number(b.Rj.firstChild.value))):qk("no op code!")},a.wv=function(b,c){var d=b.sP;b.dl&&z.contains([300,
301,302],c)?$.post("/manage",$.extend({action:"get_member_info",reason:c},b.dl)).done(function(b){d.innerHTML="用户已被警告 "+b.warn_num+" 次，禁言 "+b.ban_num+" 次"}):d.innerHTML=""};t.tN=function(b){var b=Number(b.target.value),c=0===b,d=99===b;R(this.BG,c);c||R(this.yn,m);wv(this,b);R(this.su,!d);return j};a.yv=function(){M.call(this);this.fc=this.Xp()};y(yv,Fd);t=yv.prototype;t.B=k;t.$J=j;t.Nb=ke("goog.editor.Plugin");t.VH=function(){this.B&&(this.disable(this.B),this.B=k)};t.enable=function(b){this.B==b?this.fc=j:this.Nb.log(ae,"Trying to enable an unregistered field with this plugin.",i)};t.disable=function(b){this.B==b?this.fc=m:this.Nb.log(ae,"Trying to disable an unregistered field with this plugin.",i)};t.isEnabled=function(b){return this.B==b?this.fc:m};t.Xp=kf;t.OO=kf;
t.p=function(){this.B&&this.VH(this.B);yv.m.p.call(this)};a.zv=F.ym({Mw:1,YM:2,ur:3,ij:4,vr:5,execCommand:6,queryCommandValue:7,rG:8,DK:10,CK:11}),a.Av=F.Dh(8,10,11);yv.prototype.execCommand=function(b,c){var d=this.OO(b);d||(B&&Bv(this.B,j,j),this.B.Fh());try{var e=this.bf.apply(this,arguments)}finally{d||(this.B.Ze(),Cv(this.B))}return e};yv.prototype.Je=s(m);a.Dv=function(b,c,d,e,g){this.fD=b;this.Uz=c;this.mq=d;this.kD=e;this.Rv=g||{}},a.Ev=function(b,c){this.tU=b;this.pC=c},a.Fv=function(b,c,d,e){var g=[];b.mq&&b.Uz&&g.push("<!DOCTYPE HTML>");g.push('<html style="background:none transparent;min-width:0;');b.mq&&g.push("height:",b.kD?"100%":"auto");g.push('">');g.push("<head><style>");d&&d.pC&&g.push(d.pC);B&&b.Uz&&g.push(" img {-moz-force-broken-image-icon: 1;}");g.push("</style></head>");g.push('<body g_editable="true" hidefocus="true" ');Ms&&g.push("contentEditable ");
g.push('class="editable ');g.push('" id="',b.fD,'" style="min-width:0;');B&&b.mq&&(g.push(";width:100%;border:0;margin:0;background:none transparent;",";height:",b.Uz?"100%":"auto"),b.kD?g.push(";overflow:auto"):g.push(";overflow-y:hidden;overflow-x:auto"));rb&&g.push(";outline:hidden");for(var h in b.Rv)g.push(";"+h+":"+b.Rv[h]);g.push('">',c,"</body></html>");b=g.join("");e=e.contentDocument||e.contentWindow.document;e.open();e.write(b);e.close()};a.Mv=function(b,c){M.call(this);this.Ng=this.id=b;this.hb=k;this.nd={};this.oj={};for(var d in zv)this.oj[d]=[];this.Tk="";this.jk={};this.jk[Gv]=1;this.jk[Hv]=1;this.zx=this.Xr=m;this.Pq=new cj(this.MC,Iv,this);this.Nq={};for(var e in Jv)this.Nq[Jv[e]]=0;B&&(this.re=new cj(this.Kn,Kv,this));this.gc=new le(this);this.uU=[];this.Aj=Lv;this.Rl=Sb(c||document);this.Kc=this.Rl.h(this.id);this.Ik=this.Rl.Pa()};y(Mv,Fd);Mv.prototype.field=k;Mv.prototype.Kc=k;Mv.prototype.Nb=ke("goog.editor.Field");
a.Gv="change",a.Hv="delayedchange",a.Jv={PU:"cvc",GV:"load",SW:"unload",GU:"beforechange",NU:Gv,UU:Hv,HU:"beforefocus",dV:"focus",JU:"blur",IU:"beforetab",tV:"ifrsz",uW:"selectionchange"},a.Lv=0,a.Nv=k;t=Mv.prototype;t.Og=m;t.bI=m;t.Rt=m;t.h=p("field");t.addListener=function(b,c,d,e){var g=this.h();jp&&(g&&this.pc())&&(g=g.ownerDocument);this.gc.c(g,b,c,d,e)};t.aj=function(b){return this.nd[b]};a.Kv=15,a.Iv=250;Mv.prototype.pc=lf;Mv.prototype.ao=lf;Mv.prototype.kH=kf;a.Ov={46:j,8:j};A||(Ov[9]=j);
a.Pv={86:j,88:j};A&&(Ov[229]=j);a.Qv=function(b){var c=!(b.ctrlKey||b.metaKey)&&b.keyCode in Ov;return(b.ctrlKey||b.metaKey)&&b.keyCode in Pv||c},a.Rv=function(b,c){b.Aj=2;b.field=c;b.hb=Sb(c);b.Xr=m;b.zx=m;c.setAttribute("g_editable","true")};
Mv.prototype.Zu=function(){this.gc&&this.gc.Lc();if((fi||gi)&&this.pc()&&this.kH()){try{var b=this.hb.Pa();b.removeEventListener("keydown",this.Xm,m);b.removeEventListener("touchend",this.Xm,m)}catch(c){}delete this.Xm}if(rb&&this.pc()){try{b=this.hb.Pa(),b.removeEventListener("focus",this.Mu,m),b.removeEventListener("blur",this.Lu,m)}catch(d){}delete this.Mu;delete this.Lu}this.re&&this.re.stop();this.Pq.stop()};
Mv.prototype.p=function(){(1==this.Aj||this.Zd())&&this.Nb.rk("Disposing a field that is in use.");this.Kc&&this.execCommand("clearlorem");this.Aj=Lv;for(var b in this.nd){var c=this.nd[b];c.Xp()||c.disable(this)}this.hb=this.field=k;this.Zu();this.gl&&(yd(this.gl),this.gl=k);this.Rl=k;this.gc&&(this.gc.C(),this.gc=k);for(;b=this.uU.pop();)b.C();Nv==this.id&&(Nv=k);for(var d in this.nd)b=this.nd[d],b.$J&&b.C();delete this.nd;Mv.m.p.call(this)};
a.Sv=["DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMCharacterDataModified"];Mv.prototype.Fz=function(){if(gp||!this.pc())this.gc.c(this.h(),"DOMSubtreeModified",this.Nw);else{var b=this.hb.za();this.gc.c(b,Sv,this.Nw,j);this.gc.c(b,"DOMAttrModified",v(this.ED,this,this.Nw),j)}};
a.Tv=function(b,c){if(9==c.keyCode&&!b.dispatchEvent({type:"beforetab",shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.ctrlKey})||B&&c.metaKey&&(37==c.keyCode||39==c.keyCode))return c.preventDefault(),m;var d;if(!(d=c.charCode))d=Qv(c)?j:!(!B||c.ctrlKey||c.metaKey||B&&!c.charCode);b.vw=d;b.vw&&b.Fh();return j},a.Uv={8:1,9:1,13:1,33:1,34:1,35:1,36:1,37:1,38:1,39:1,40:1,46:1},a.Vv={65:j,86:j,88:j},a.Wv={8:1,9:1,13:1,27:1,33:1,34:1,37:1,38:1,39:1,40:1};t=Mv.prototype;
t.Zn=function(b,c){for(var d=this.oj[b],e=z.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];if((h.isEnabled(this)||Av[b])&&h[zv[b]].apply(h,e))return j}return m};t.BO=function(b,c){for(var d=this.oj[b],e=z.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];(h.isEnabled(this)||Av[b])&&h[zv[b]].apply(h,e)}};t.Ts=function(b,c,d){for(var e=this.oj[b],g=z.slice(arguments,1),h=0;h<e.length;++h){var l=e[h];if(l.isEnabled(this)||Av[b])g[0]=l[zv[b]].apply(l,g)}return g[0]};
a.Xv=function(b,c,d){var e={},b=b.Ts(8,c||"",e);Rf(d,e);d.innerHTML=b};t.ff=function(b){(B||Tv(this,b))&&!this.Zn(1,b)&&qp&&Yv(this,b)};t.ZM=function(b){if(B){if(!Tv(this,b))return}else this.vw=j,this.Fh();!this.Zn(2,b)&&!qp&&Yv(this,b)};t.$M=function(b){!B&&(this.vw||Qv(b))&&this.Kn();this.Zn(3,b);Zv(this,"selectionchange")||(Uv[b.keyCode]||(b.ctrlKey||b.metaKey)&&Vv[b.keyCode])&&this.cH.start()};
a.Yv=function(b,c){if(!c.altKey){var d=kb?c.metaKey:c.ctrlKey;if(d||Wv[c.keyCode]){var e=c.charCode||c.keyCode;17!=e&&b.Zn(5,c,String.fromCharCode(e).toLowerCase(),d)&&c.preventDefault()}}};t.execCommand=function(b,c){for(var d=arguments,e,g=this.oj[6],h=0;h<g.length;++h){var l=g[h];if(l.isEnabled(this)&&l.Je(b)){e=l.execCommand.apply(l,d);break}}return e};
t.queryCommandValue=function(b){var c=this.Zd()&&this.Ie;if(oa(b))return this.Ps(b,c);for(var d={},e=0;e<b.length;e++)d[b[e]]=this.Ps(b[e],c);return d};t.Ps=function(b,c){for(var d=this.oj[7],e=0;e<d.length;++e){var g=d[e];if(g.isEnabled(this)&&g.Je(b)&&(c||g.Xp()))return g.queryCommandValue(b)}return c?k:m};t.ED=function(b,c){if(!Zv(this,Gv)){var d=c.Ub;try{if(d.originalTarget.prefix||"scrollbar"==d.originalTarget.nodeName)return}catch(e){return}d.prevValue!=d.newValue&&b.call(this,d)}};
t.Nw=function(b){Zv(this,Gv)||(b=b.tD?b.Ub:b,b.target.firebugIgnore||(this.zx=this.Xr=j,this.re.start()))};t.sr=function(){A&&this.execCommand("clearlorem",j);B&&this.zv();this.Ze()};a.$v=function(b){var c;return b.pc()&&(c=b.hb)?(b=c.Pa())&&b.frameElement:k},a.aw=function(b){return(b=b.hb&&b.hb.Pa())&&$o(b)},a.Cv=function(b,c,d){if(!Zv(b,"selectionchange")){var e=aw(b),e=e&&e.Db();b.Ie=!!e&&sc(b.h(),e);b.dispatchEvent("cvc");b.dispatchEvent({type:"selectionchange",EY:c&&c.type});b.Zn(4,c,d)}};
t.uN=function(){var b=this.bH;this.bH=k;Cv(this,i,b)};t.Fh=function(){Zv(this,"beforechange")||this.dispatchEvent("beforechange")};a.Bv=function(b,c,d){c&&(b.re&&bs(b.re),b.jk[Gv]=1);d&&(bw(b),b.jk[Hv]=1)},a.cw=function(b,c,d){!c&&b.re&&bs(b.re);b.jk[Gv]=0;b.jk[Hv]=0;c&&b.Kn();d&&b.MC()},a.Zv=function(b,c){return!!b.jk[c]||b.Nq[c]&&500>=za()-b.Nq[c]};t.Ze=function(b){cw(this,j,b)};t.Kn=function(){Zv(this,Gv)||(this.re&&this.re.stop(),this.zx=this.Xr=j,Zv(this,Hv)||this.Pq.start())};
t.MC=function(){Zv(this,Hv)||(this.Pq.stop(),this.Xr=m,this.dispatchEvent(Hv))};a.bw=function(b){b.re&&bs(b.re);bs(b.Pq)};t.zv=function(){this.LC();this.NC()};t.LC=function(){Zv(this,"beforefocus")||(this.execCommand("clearlorem",j),this.dispatchEvent("beforefocus"))};t.NC=function(){if(!Zv(this,"focus")){Nv=this.id;this.Ie=j;this.dispatchEvent("focus");if(B){var b=this.h(),c=aw(this);if(c){var d=mo(c);0==no(c)&&(!d||d==b||"BODY"==d.tagName)&&Ks(b)}}!hp&&this.pc()&&this.hb.Pa().parent.getSelection().removeAllRanges()}};
t.Vq=function(){Zv(this,"blur")||(Nv==this.id&&(Nv=k),this.Ie=m,this.dispatchEvent("blur"))};a.dw=function(b){Ic(b.target,"A")&&b.preventDefault()};t.ej=function(b){Nv=this.id;if(A){var c=b.target;c&&("A"==c.tagName&&b.ctrlKey)&&this.Rl.Pa().open(c.href)}this.Rt=j};t.Ew=function(){this.Rt=m};t.KD=function(b){if(!this.bI||this.Rt)this.Rt=m,Cv(this,b),A&&(this.bH=b.target,this.cH.start())};t.eN=function(b){Cv(this,b)};
t.ll=function(){if(this.queryCommandValue("usinglorem"))return" ";if(!this.Zd()){var b=this.Kc;b||this.Nb.log($d,"Couldn't get the field element to read the contents",i);return b.innerHTML}var c=this.h(),b=c.cloneNode(m),c=c.innerHTML;A&&c.match(/^\s*<script/i)&&(c=" "+c);b.innerHTML=c;this.BO(11,b);return this.Ts(10,b.innerHTML)};
t.ge=function(b,c,d,e){if(1==this.Aj)this.Nb.log(ae,"Can't set html while loading Trogedit",i);else{e&&this.execCommand("clearlorem");c&&b&&(c="<p>"+c+"</p>");d&&Bv(this,m,j);b=c;if(c=this.h()){if(this.pc()&&C)for(var g=c.ownerDocument.getElementsByTagName("HEAD"),h=g.length-1;1<=h;--h)g[h].parentNode.removeChild(g[h])}else c=this.Kc;c&&Xv(this,b,c);e&&this.execCommand("updatelorem");this.Zd()&&(d?(B&&bs(this.re),cw(this)):this.Ze())}};
t.uA=function(){var b=this.hb.za();b.designMode="on";mp&&b.execCommand("styleWithCSS",m,m)};t.tE=function(){this.Tk&&ew(this)&&Ct(this.Tk,this.h())};t.Zd=function(){return 2==this.Aj};t.focus=function(){if(!Ms&&this.pc())this.hb.Pa().focus();else{if(rb)var b=this.Ik.pageXOffset,c=this.Ik.pageYOffset;this.h().focus();rb&&this.Ik.scrollTo(b,c)}};t.Vf=function(){(ep||C)&&fw(this);this.focus()};a.fw=function(b){var c=b.h();if(c){var d=ss(c);c==d?bp(c,0).select():Yr(d,j);Cv(b)}};
t.be=function(b){this.Aj=1;var c=this.Kc;this.nodeName=c.nodeName;this.VY=c.className;this.cssText=c.style.cssText;c.className+=" editable";this.Yx(b)};t.Yx=function(b){var c=this.Kc;if(c){var c=c.innerHTML,d={},c=this.Ts(8,c,d),e=this.Rl.o("IFRAME",this.zD());if(ew(this)){var g=v(this.fE,this,e,c,d);this.gl=N(e,"load",g,j);b&&(e.src=b)}this.GB(e);ew(this)||this.fE(e,c,d)}};
t.tr=function(){A&&Ns(this.hb.Pa());Nv!=this.id&&this.execCommand("updatelorem");if((fi||gi)&&this.pc()&&this.kH()){var b=this.hb.Pa();this.Xm=v(b.focus,b);b.addEventListener("keydown",this.Xm,m);b.addEventListener("touchend",this.Xm,m)}rb&&this.pc()?(this.Mu=v(this.zv,this),this.Lu=v(this.Vq,this),b=this.hb.Pa(),b.addEventListener("focus",this.Mu,m),b.addEventListener("blur",this.Lu,m)):(pp?(this.addListener("focus",this.NC),this.addListener(id,this.LC)):this.addListener("focus",this.zv),this.addListener("blur",
this.Vq,B));if(B)this.Fz();else{this.addListener(["beforecut","beforepaste","drop","dragend"],this.Fh);var c=this.Ze,d;d=d||0;this.addListener(["cut","paste"],function(){return c.apply(this,Array.prototype.slice.call(arguments,0,d))});this.addListener("drop",this.sr)}this.addListener(C?"dragend":"dragdrop",this.sr);this.addListener("keydown",this.ff);this.addListener("keypress",this.ZM);this.addListener("keyup",this.$M);this.cH=new cj(this.uN,250,this);np&&this.addListener("click",dw);this.addListener("mousedown",
this.ej);this.bI?(this.gc.c(this.hb.za(),"mouseup",this.KD),this.addListener("dragstart",this.Ew)):this.addListener("mouseup",this.KD);this.addListener("mouseover",this.eN);this.tE();cw(this);this.Nb.info("Dispatching load "+this.id);this.dispatchEvent("load");for(var e in this.nd)this.nd[e].enable(this)};a.ew=function(b){if(!ka(b.Cx)&&(b.Cx=m,A&&b.pc())){for(var c=b.Rl.Pa();c!=c.parent;)try{c=c.parent}catch(d){break}c=c.location;b.Cx="https:"==c.protocol&&-1==c.search.indexOf("nocheckhttps")}return b.Cx};
t.GB=function(b){var c=this.Kc;b.className=c.className;b.id=c.id;mc(b,c)};t.jw=function(b){var c=Kc(Sb(this.Kc));return new Dv(this.id,c,m,m,b)};t.nI=function(b,c,d){d=this.jw(d);ew(this)?(b=(b.contentDocument||b.contentWindow.document).body,Ms&&(b.contentEditable=j),b.className="editable",b.setAttribute("g_editable",j),b.hideFocus=j,b.id=d.fD,Rf(b,d.Rv),b.innerHTML=c):Fv(d,c,new Ev(this.h(),this.Tk),b)};
t.fE=function(b,c,d){this.gl&&(yd(this.gl),this.gl=k);b.XW="true";this.nI(b,c,d);Rv(this,(b.contentDocument||b.contentWindow.document).body);!Ms&&this.pc()&&this.uA();this.tr()};t.zD=function(){var b="padding:0;"+this.Kc.style.cssText;Bs(b,";")||(b+=";");b+="background-color:white;";A&&(b+="overflow:visible;");return{frameBorder:0,style:b}};a.gw=function(b){T.call(this);this.ob=b;this.HX=this.ob.lr();this.gr=this.ob.Ad?this.ob.Ka:this.ob.Ka.h();this.isContentEditable=this.ob.isContentEditable();this.CT=30;this.zc=new Hd(1E3*this.CT);this.V=Cg?Cg.V:0};y(gw,T);t=gw.prototype;t.p=function(){hw(this);this.zc.C();gw.m.p.call(this)};
t.n=function(b){this.e=b;this.pj=J("draft-saved-info",b);R(this.pj,m);this.kx=J("draft-saved-time",b);this.FK=J("draft-clear-button",b);this.tX=this.isContentEditable?Hv:["change","input"];b=this.g().c(this.zc,Id,this.nz).c(this.FK,"click",this.GK).c(this.gr,"keydown",this.UO);"oninput"in this.gr&&!A?b.c(this.gr,"input",this.sO):b.c(this.gr,"keydown",this.tO);var c=Ig&&1E3*Ig[1];c&&(iw(this,c),this.mA=setInterval(v(function(){iw(this,c)},this),22E3))};
t.UO=function(b){if((b.metaKey||b.ctrlKey)&&"s"===Ej[b.keyCode])this.fP(),this.isContentEditable||b.preventDefault()};a.jw=function(b){R(b.pj,j);xc(b.kx,"保存中…");b.rO()};t.sO=function(){jw(this)};t.tO=function(b){Sg(b.keyCode)&&jw(this)};t.Xz=function(){this.zc.start()};t.aA=function(){this.zc.stop()};t.La=function(b){this.ob.La(b);this.ob.bp()};t.bb=function(){return this.ob.Wf()};
t.UG=function(){if(!this.Mf){var b=this.bb();b&&(b=(new Qi).add("qid",this.V).add("content",b),Ci("/answer/draft/save",k,"POST",b.toString()),this.pf())}};t.nU=150;t.nz=zk(gw.prototype.nU,gw.prototype.UG);t.gP=350;t.fP=zk(gw.prototype.gP,gw.prototype.UG);t.uO=3E3;t.rO=zk(gw.prototype.uO,function(){this.Mf||(this.bb()?this.nz():kw(this))});a.hw=function(b){b.mA&&(clearInterval(b.mA),b.mA=k)};t.pf=function(){hw(this);R(this.pj,j);R(this.pj,j);xc(this.kx,"已保存");this.dispatchEvent("saveContent")};
a.iw=function(b,c){var d=Zs(c||za());/^\d/.test(d)&&(d=" "+d);d="已存于"+d;R(b.pj,j);xc(b.kx,d)};t.GK=function(b){b.preventDefault();Ai("清除草稿","你确定要清除保存的草稿吗？",function(b){b&&(this.La(""),kw(this),this.ob.ready(function(){var b=this.Ka;this.Ad?Zr(b,b.value.length):b.field.lastChild?Yr(b.field.lastChild):b.Vf();this.al&&(this.al.scrollTop=this.al.scrollHeight)}))},this)};a.kw=function(b){Ci("/answer/draft/delete",k,"POST","qid="+b.V);hw(b);R(b.pj,m);b.dispatchEvent("clearContent")};a.lw=function(b,c,d){fq.call(this,m);this.jb=!!b;this.cI=c;this.Ab="&nbsp;";this.Wm=d;this.Nt=this.Fv=this.pD=this.enabled=j;this.ky=m;if(!this.ky&&S.Ld||!S.Ma())this.Xx='<span style="font-style: normal;color: #999;">写回答…</span>'};y(lw,fq);t=lw.prototype;t.yD=function(){var b=Ub("h2","zm-editable-content",H("zh-question-title"))[0];return{title:b&&(/answer\/\d+$/.test(location.pathname)?Fc(b):b.firstChild.nodeValue)||"",pk:this.Si}};t.fw=p("Wm");t.Yo=ca("jb");
t.kt=function(b){this.Wm=b?b:S[4];this.Sh&&b&&(b=Za(b,20),this.jK.innerHTML="，"+Ua(b)+'<a name="edit_bio" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a>')};t.gb=function(b,c){this.enabled=b;this.Sh?(this.gh(),this.Ab=c,this.nc.innerHTML=this.Ab):c&&(this.Ab=c)};t.ea=function(b){lw.m.ea.call(this,b);this.Sh=j;D.add(this.nc,"zu-answer-form-disabled-wrap")};t.p=function(){this.Nr&&(L(this.Nr),this.dI=this.Nr=k);lw.m.p.call(this)};
t.dj=function(b){this.Yo(b.jb);this.cq&&(this.cq.checked=b.jb)};t.z=function(){lw.m.z.call(this);this.g().c(Ii,"anon_change",this.dj)};
t.Fg=function(){lw.m.Fg.call(this);var b=this.H(),c=S.Ma();this.Nr=b.o("div","zh-answer-form clearfix",[c?ct(this.cI):"",this.dI=b.o("div",k,[b.o("div","zu-answer-form-title",[c?bt(this.cI):"我来回答这个问题",this.jK=b.o("span")])])]);this.kt(this.Wm);b.Xn(this.Nr,this.Si);this.g().c(this.dI,"click",this.fa);S.Ld&&this.ky&&mw(this,'<div class="add-answer-guide"><p>知乎是一个重视质量的社区，          鼓励专业、认真与友善的回答，请在回答问题时遵守 <a href="http://www.zhihu.com/question/19550695">知乎回答规范</a>，          避免与问题本身无关或没有意义的回答。</p></div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要回答</a></div>',
function(b,c){var g=this;c.on("click","a",function(){$(g.fd).show();c.hide();b.slideUp()})});S.Ma()||mw(this,'<div class="signin-mask-tip-answer"></div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要回答</a></div>',function(b,c){function g(){nk.D().w(j);nk.D().Ga="question_answer_add_start";nk.D().fh()}b.on("click",g);c.on("click",g)});S.Ma()&&!S.Ld&&mw(this,'<div class="active-mask-tip-answer">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>',
function(b,c){function g(){Vn.D().w(j)}b.on("click",g);c.on("click",g)})};a.mw=function(b,c,d,e){c=$(c).css("top",0).css("z-index",9);$(b.fd).hide();d=$(d);$(b.Si).append(c).after(d);e&&e.call(b,c,d)};t.tl=function(b){switch(b){case "edit_bio":b=Su();if(!this.Ju){var c=Cg.Ac;b.Qx=j;b.GG=c;this.g().c(b,"change",this.ry)}this.Ju=j;Tu(b);break;case "cancel_delete":this.dispatchEvent("cancel_delete_answer")}return j};
t.se=function(){"editing"===this.status?this.Lb&&R(this.Lb,j):this.Lb&&R(this.Lb,m);R(this.wd,m);this.nc&&R(this.nc,!this.enabled)};t.NK='<div class="zm-command clearfix"><div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div><% if (questionStatus !== "normal") { %><span class="zg-gray-normal" style="margin-right:5px;">被<%= statusText %>的问题不允许添加新的回答</span><a class="zg-right" data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a><% } %><span class="<%= (questionStatus !== "normal" ? "hidden" : "") %>"><label style="cursor:pointer"><input name="anno-checkbox" type="checkbox">匿名</label> <a class="submit-button zg-btn-blue" name="save" href="javascript:;">发布回答</a></span></div>';
t.Gi=function(){var b=tk(this.NK);this.fd=fc(b({questionStatus:Cg.status,statusText:{suggest:"建议修改",evaluate:"建议修改",close:"关闭"}[Cg.status]}));this.hn=$(".submit-button",this.fd)[0];var b=$("input[name=anno-checkbox]",this.fd)[0],c=$("label",this.fd)[0];this.cq=b;Cg.jb&&(this.cq.checked=j);rg(c,j);this.Lb.appendChild(this.fd);this.ready(function(){if(this.Ka&&this.Ka.on)this.Ka.on("load",this.jO,m,this)})};
t.jO=function(){var b=new gw(this);Rc(this,b);this.g().c(b,"saveContent",function(){var b=!this.Ad&&this.Ka.aj("FullScreenPlugin");if(b&&b.wp){var c=$(b.wp);c.stop().text("草稿已经保存").fadeTo(600,0.5).delay(3E3).fadeOut(600,function(){c.text("")})}},m,this);var c=this.Ad?this.Ka:this.Ka.h();this.g().c(c,"focus",function(){b.Xz()}).c(c,"blur",function(){b.aA();b.nz()});b.n(this.fd)};t.ry=function(){var b=Su().fw();b&&this.kt(b)};a.nw=function(b){var c=k;try{c=b.rules||b.cssRules}catch(d){15==d.code&&(d.styleSheet=b,f(d))}return c},a.ow=function(b){var c=[],b=b||document.styleSheets,d=ka(i)?i:m;if(b.imports&&b.imports.length)for(var e=0,g=b.imports.length;e<g;e++)z.extend(c,ow(b.imports[e]));else if(b.length){e=0;for(g=b.length;e<g;e++)z.extend(c,ow(b[e]))}else{var h=nw(b);if(h&&h.length)for(var e=0,g=h.length,l;e<g;e++)l=h[e],l.styleSheet&&z.extend(c,ow(l.styleSheet))}(b.type||b.rules||b.cssRules)&&(!b.disabled||d)&&c.push(b);
return c};a.pw=/a(:(link|visited|active|hover))?/,a.qw=function(){this.qn="";this.bh=[]};qw.prototype.clone=function(){var b=new qw;b.bh=this.bh.concat();b.qn=this.qn;return b};
a.rw=function(b,c,d){var e=[],g;for(g in c){var h=c[g];h&&e.push(g,":",h,d?" !important":"",";")}b.qn=e.join("")},a.sw=/(^|;|{)\s*color:([^;]+);/g,a.uw=function(b){this.Oy=[];this.Bu={};if(b){for(var c=[],b=b.split(/\s+/gm),d=0;d<b.length;d++)if(b[d]){var e=new tw(b[d]);c.push(e)}this.ai=c}},a.tw=function(b){var c=vw[b];if(c)return c;for(var c=b.match(/[#\.]/)?b.split(/(?=[#\.])/):[b],d={},e=0;e<c.length;e++){var g=c[e];"."==g.charAt(0)?d.className=g.substring(1,g.length):"#"==g.charAt(0)?d.id=g.substring(1,
g.length):d.tagName=g.toUpperCase()}this.rE=b;this.nP=d;this.EH={};vw[b]=this},a.vw={},a.ww=function(b,c){var d=c.uid,e=b.EH[d];if("undefined"!=typeof e)return e;var g=b.nP,e=g.tagName,h=g.className,g=g.id,l=j;e&&"*"!=e&&e!=c.nodeName?l=m:g&&g!=c.id?l=m:h&&!c.BK[h]&&(l=m);return b.EH[d]=l},a.yw=function(b){var c=ua(b),d=xw[c];if(d)return d;d=[];do{var e={id:b.id,nodeName:b.nodeName};e.uid=ua(e);var g={};if(b.className)for(var h=D.get(b),l=0;l<h.length;l++)g[h[l]]=1;e.BK=g;d.unshift(e)}while(b=b.parentNode);
this.DF=d;this.uid=ua(this);xw[c]=this},a.xw={},a.zw={},a.Aw="color visibility quotes list-style-type list-style-image list-style-position list-style page-break-inside orphans widows font-family font-style font-variant font-weight text-indent text-align text-transform white-space caption-side border-collapse border-spacing empty-cells cursor".split(" "),a.Bw="font-family font-size font-weight font-variant font-style color text-align text-decoration text-indent text-transform letter-spacing white-space word-spacing".split(" ");a.Cw=function(b,c){Mv.call(this,b,c)},a.Dw=void 0;y(Cw,Mv);t=Cw.prototype;t.Nb=ke("goog.editor.SeamlessField");t.zE=m;t.GO=m;t.ao=p("zE");t.MD=function(){Zv(this,Gv)||Ew(this)};
t.Sz=function(){if(this.mp?0:this.mp=j){var b=m,c=$v(this);if(c){var d,e=$v(this),g=e.contentDocument.body;d=g.parentNode;0===parseInt(Dt(e,"height"),10)&&Rf(e,"height","1px");if(Kc(Sb(g)))e=d.offsetHeight;else if(e=d.scrollHeight,d.clientHeight!=d.offsetHeight){d=e;if(!(e=Dw))e=document.createElement("div"),e.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px",g=document.createElement("div"),kg(g,"200px","200px"),e.appendChild(g),document.body.appendChild(e),g=e.offsetWidth-
e.clientWidth,L(e),e=Dw=g;e=d+e}d=e;this.wP&&(d=Math.max(d,this.wP));parseInt(Dt(c,"height"),10)!=d&&(c.style.height=d+"px",b=j)}this.mp=m;b&&this.dispatchEvent("ifrsz")}};
a.Ew=function(b){if(b.mp?0:b.mp=j){var c=$v(b),d=b.h(),e=m;if(c&&d){var g,h=c.parentNode,l=h.offsetWidth;parseInt(Dt(c,"width"),10)!=l&&(g=vg(d),c.style.width=l+"px",d.style.width=l-g.left-g.right+"px",e=j);h=h.offsetHeight;b.ao()&&parseInt(Dt(c,"height"),10)!=h&&(g||(g=vg(d)),c.style.height=h+"px",d.style.height=h-g.top-g.bottom+"px",e=j)}b.mp=m;e&&b.dispatchEvent("ifrsz")}},a.Fw=function(b){b.h()&&(Ew(b),b.ao()||b.Sz())};t.ax="";a.Gw=m;t=Cw.prototype;t.pc=function(){return!Ms};
t.Fz=function(){Cw.m.Fz.call(this);if(this.pc()){var b=$v(this).ownerDocument;this.gc.c(b,Sv,this.MD,j);this.ZO=vd(this.hb.Pa(),"load",this.Sz,j,this);this.gc.c(b,"DOMAttrModified",v(this.ED,this,this.MD),j)}};t.Kn=function(){Zv(this,Gv)||(Cw.m.Kn.call(this),this.pc()&&this.Sz())};
t.Vq=function(){if(!Zv(this,"blur")&&(Cw.m.Vq.call(this),!Ms&&!hp)){var b=this.hb.Pa(),c=m;yd(this.SE);this.SE=vd(b.document.body,"dragover",function(){c=j});fa.setTimeout(v(function(){if(!c&&this.hb){var b=aw(this),e=this.hb.Pa();Ns(e);b&&(b.collapse(j),b.select())}},this),0)}};t.uA=function(){Cw.m.uA.call(this);var b=this.hb.za();b.execCommand("enableInlineTableEditing",m,"false");b.execCommand("enableObjectResizing",m,"false")};
t.tE=function(){!this.pc()&&!Gw&&(this.Tk&&Ct(this.Tk,this.h()),Gw=j)};t.Yx=function(b){if(this.pc())Cw.m.Yx.call(this,b);else if(b=this.Kc)Rv(this,b),b.contentEditable=j,Xv(this,b.innerHTML,b),this.tr()};t.tr=function(){if(this.pc()){var b=this;fa.setTimeout(function(){Fw(b)},0)}Cw.m.tr.call(this)};t.zD=function(){return{frameBorder:0,style:"padding:0;"}};
t.GB=function(b){if(!this.GO){var c=this.Kc;c&&(this.zE="auto"==Vf(c,"overflowY"))}var c=this.Kc,d=Sb(c),e=c.style.width,g=c.style.height;Rf(c,"visibility","hidden");var d=d.o("DIV",{style:"height:0;clear:both",innerHTML:"&nbsp;"}),h=d.cloneNode(j);c.insertBefore(d,c.firstChild);c.appendChild(h);h=Rb(c);if((d=A&&c.currentStyle)&&Kc(Sb(h))&&"auto"!=d.width&&"auto"!=d.height&&!d.boxSizing)h=tg(c,d.width,"width","pixelWidth"),d=tg(c,d.height,"height","pixelHeight"),h=new Ob(h,d);else var d=sg(c),h=vg(c),
l=eg(c),h=new Ob(d.width-l.left-h.left-h.right-l.right,d.height-l.top-h.top-h.bottom-l.bottom);d=h.width;h=h.height;l="";this.ao()&&(l="&nbsp;",Rf(c,"position","relative"),Rf(c,"overflow","visible"),Rf(b,"position","absolute"),Rf(b,"top","0"),Rf(b,"left","0"));kg(c,d,h);Kc(Sb(c))&&(this.DY=c.style.lineHeight,Rf(c,"lineHeight","0"));c.innerHTML=l;kg(b,d,h);kg(c,e,g);Rf(c,"visibility","");c.appendChild(b);ew(this)||(c=b.contentWindow.document,Kc(Sb(b.ownerDocument))&&(c.open(),c.write("<!DOCTYPE HTML><html></html>"),
c.close()))};t.jw=function(b){var c=this.Kc;if(c)return new Dv(this.id,Kc(Sb(c)),j,this.ao(),b);f(Error("no field"))};
t.nI=function(b,c,d){Rf(b,"visibility","hidden");var d=this.jw(d),e=this.Kc,g=this.Tk;if(!this.ax){var h=this.Kc;if(h){var l=h.ownerDocument,n=ua(l);if(!zw[n]){for(var q=ua(l),r=[],l=ow(l.styleSheets),x=0,E;E=l[x];x++)if((E=nw(E))&&E.length)for(var G=0,I=E.length;G<I;G++){var Q=new qw,X;X=Q;var na=E[G],Xa=na.style;if(Xa){var Na=i,Ta=i;Xa&&(Na=na.selectorText)&&(Ta=Xa.cssText)?A&&(Ta+="/* */"):na.cssText&&(Ta=/([^\{]+)\{/,Na=Ta.exec(na.cssText)[1],Ta=na.cssText.replace(Ta,"").replace(/\}[^\}]*$/g,
""));if(Na){na=X;na.bh=[];Na=Na.split(/,\s*/gm);for(Xa=0;Xa<Na.length;Xa++){var ce=Na[Xa];0<ce.length&&na.bh.push(new uw(ce))}X.qn=Ta;X=j}else X=m}else X=m;X&&r.push(Q)}zw[q]=r}q=zw[n];n=[];for(r=0;r<q.length;r++)n.push(q[r].clone());l=new yw(h);x=new tw("body");for(q=0;q<n.length;q++){E=n[q].bh;r=E.length;for(G=0;G<r;G++){I=E[G];Q=I;X=l.uid;if(Q.Bu[X])X=Q.Bu[X];else{for(var Ta=0,Xa=Na=na=k,ce=l.DF,nD=ce.length,Sj=0;Sj<=Q.ai.length;Sj++){for(Na=Q.ai[Sj];Ta<nD;){var ly=ce[Ta];if(Na&&ww(Na,ly)){na=
{WC:Ta,dH:Sj};Ta++;break}else Xa&&ww(Xa,ly)&&(na={WC:Ta,dH:Sj-1});Ta++}Xa=Na}X=Q.Bu[X]=na}X&&(Q=X.dH,I=I.ai,Ta=I.length-1,X.WC==l.DF.length-1||Q<Ta?(I=I.concat(),I.splice(0,Q+1,x),Q=new uw,Q.ai=I,E.push(Q)):0<Q&&Q==Ta&&(Q=new uw,Q.ai=[x,I[Ta]],E.push(Q)))}}l=new qw;h=h.currentStyle||Rb(h).defaultView.getComputedStyle(h,"")||{};q=new uw;q.ai=[new tw("html")];l.bh=[q];x={};for(q=0;r=Aw[q];q++)x[r]=h[eb(r)];rw(l,x);n.push(l);l=new qw;x=new uw;x.ai=[new tw("body")];E={position:"relative",top:"0",left:"0",
right:"auto",display:"block",visibility:"visible"};for(q=0;r=Bw[q];q++)E[r]=h[eb(r)];rw(l,E,j);l.bh=[x];n.push(l);h=[];r=n.length;for(q=0;q<r;q++){E=n[q];l=h;G=E.bh.length;x=m;for(I=0;I<G;I++){Q=E.bh[I].ai;X=Q.length;for(Ta=0;Ta<X;Ta++)l.push(Q[Ta].rE," ");I<G-1&&l.push(",");B&&!Eb("1.9a")&&(x=x||pw.test(Q[X-1].rE))}E=E.qn;x&&(E=E.replace(sw,"$1 color: $2 ! important; "));l.push("{",E,"}\n")}this.ax=h.join("")}}e=new Ev(e,g+this.ax);d.mq&&(g=vg(e.tU),(g.top||g.left||g.right||g.bottom)&&Rf(b,"margin",
-g.top+"px "+-g.right+"px "+-g.bottom+"px "+-g.left+"px"));Fv(d,c,e,b);Fw(this);Rf(b,"visibility","visible")};t.Zu=function(){yd(this.SE);yd(this.ZO);Cw.m.Zu.call(this)};a.Iw=function(b,c){var d=b.split("!");this.type=d[0]+"!";this.namespace=d[1];this.bd=new Hw(c)};y(Iw,gd);a.Hw=function(b){this.category=b.category;this.action=b.action;this.label=b.label;this.value=b.value};Hw.prototype.fill=function(b,c){this[b]=this[b].replace("?",c);return this};a.Jw=function(b){T.call(this);F.extend(this.F={},this.R,b||{});this.rh=new Md;this.Gf=k};y(Jw,T);t=Jw.prototype;t.R={trigger:{A:"data-editable"},fJ:"hc-actionbar",RO:"checked",VS:100,RN:100};
t.z=function(){Jw.m.z.call(this);this.Sm=K("div");document.body.appendChild(this.Sm);var b=this.F,c=new Dl(b.trigger,m,k,this.e);c.st=b.VS;c.Br=b.RN;c.dh(this.Sm);N(c,"trigger",function(b){c.$c(new ll(b.anchor,1))});N(c,"beforeshow",function(b){this.Gf=b.target.anchor;this.W()},m,this);c.className=b.fJ;this.XN=c};t.lw=p("XN");
a.Kw=function(b,c){var d=b.F.RO,e=oc(b.Sm),g=z.find(e,function(b){return b.getAttribute("data-action")===c});if(!g||D.has(g,d))return m;z.forEach(e,function(b){D.remove(b,d)});D.add(g,d);return j};t.oK=function(b,c,d){c=K("div",{title:b.P,"data-action":b.name,className:"button "+b.name+(0===c?" first":c===d.length-1?" last":"")},[K("i","icon icon-actionbar-"+b.name)]);rg(c,j);this.g().c(c,"click",function(){Kw(this,b.name)&&b.Nk(this.Gf)});return c};
t.W=function(){this.Sm.innerHTML="";hc(this.Sm,z.map(F.Fa(this.rh.It()),this.oK,this))};a.Lw=function(b){T.call(this);F.extend(this.F={},this.R,b||{})};y(Lw,T);Lw.prototype.R={XD:{},XJ:j};
Lw.prototype.z=function(){Lw.m.z.call(this);var b=this,c=this.e;if(this.F.XJ){var d=new Jw({});d.rh.set("link",{name:"link",P:"链接",Nk:function(b){xc(b,b.href)}||ha});d.rh.set("text",{name:"text",P:"文本",Nk:function(b){xc(b,b.getAttribute("data-title"))}||ha});d.n(c);var e=d.lw();$r(e,new Mf(2,0,0,0));e.Al=new Mf(2,0,0,0)||k;var g=d.g();g.c(e,"beforeshow",function(b){var b=b.target.anchor,c=Fc(b);c===b.href?Kw(d,"link"):(c!==b.getAttribute("data-title")&&b.setAttribute("data-title",c),Kw(d,"text"))}).c(e,
"beforehide",function(b){if((b=b.target)&&c.contains(b)&&Mw(b))return m});var h;g.c(e,"show",function(b){h=b.target.anchor;D.add(h,"hover")}).c(e,"hide",function(){h&&(D.remove(h,"hover"),h=k)});this.Wp=d}this.g().c(c,"paste",function(){setTimeout(function(){var c=b.F,d=b.e,e=zc(d,function(b){return 3===b.nodeType&&!Nw(b,d,function(b){return Mw(b)||"CODE"===b.nodeName||"PRE"===b.nodeName})}),g,h=$o(),E=h&&lo(h);z.forEach(e,function(b){var c=b.nodeValue,d=c.replace(Ow,function(b){Ea(b,"http")||(b=
"http://"+b);return b.link(b)});d!==c&&(c=fc(d),E===b&&(g=c.lastChild),mc(c,b))});g&&Yr(g);var G=c.XD,c=z.filter(d.getElementsByTagName("A"),function(b){var c=b.getAttribute("href");if(c=!(!c||"#"===c))if(c=!b.getAttribute("data-editable"))if(c=z.contains(Pw,b.protocol))c=Fc(b),Ea(b.href,c)?b=i:(b.setAttribute("data-editable",j),b.setAttribute("data-title",c),b=j),c=!b;return c}),c=z.map(c,function(b){return Qw(b.href).done(function(c){var e=G;if(c&&d.contains(b)){var e=e||{},g=function(b,c,d){var e=
$o();if(e){var g=e.T(),h=e.ra(),l=e.ha(),n=e.Ea();sc(c,g)&&(g=b,h=0);sc(c,l)&&(l=b,n=0);d(function(){g===b&&l===b?Yr(b):Mo(g,h,l,n).select()})}else d(ha)},h={link:function(b,c){b.setAttribute("data-editable",j);c.title===b.href?b.setAttribute("data-title",b.hostname.split(".").slice(/(.com|.edu|.gov|.net|.org)$/.test(b.hostname)?-2:-3).join(".").replace(/^www\./,"")+" 的页面"):(b.setAttribute("data-title",c.title),g(b,b,function(d){xc(b,c.title);d()}))},image:function(b,c){var d=document.createElement("img");
d.src=c.src;d.setAttribute("data-rawwidth",c.width);d.setAttribute("data-rawheight",c.height);g(d,b,function(c){mc(d,b);c()})}};(e=e[c.type]||h[c.type])&&e(b,c)}})});c.length&&(b.dispatchEvent("willScrape"),$.when.apply($,c).always(function(){b.dispatchEvent("didScrape")}))})}).c(c,"keydown",this.KN)};
Lw.prototype.KN=function(b){var c=Sg(b.keyCode),d=8===b.keyCode;if(!(b.ctrlKey||(b.altKey||b.metaKey)||!c&&!d)){var c=$o(),e=c.T(),g=c.ha(),h=this.e,l,n=Nw(e,h,Mw)||g!==e&&(l||(l=Nw(g,h,Mw)));if(n){var q=Fc(n),r=c.ra(),x=c.Ea();if(n.getAttribute("data-editable")&&q===n.href){var E=m;l=l||Nw(g,h,Mw)||n;var h=n.contains(e),G=l.contains(g);if(d)h&&(e=n,r=0,E=j),G&&(g=l,x=Tr(l),E=j),E&&Mo(e,r,g,x).select();else if(h&&G&&l===n){if(!c.isCollapsed()||!(0===r||q.length===r))b.preventDefault(),Yr(n)}else h&&
(e=n.nextSibling,r=0,E=j),G&&(g=l.previousSibling,x=Tr(g),E=j),E&&Mo(e,r,g,x).select()}}}};a.Ow=/\b(?:(?:https?):\/\/|www\.)(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[\-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/ig,a.Pw=["http:","https:"],a.Nw=function(b,c,d){for(;b&&b!==c;){if(d(b))return b;b=b.parentNode}},a.Mw=function(b){return"A"===b.nodeName},a.Qw=Qr(function(b){return $.post("/scraper",{url:b})});a.Rw=function(b,c,d){T.call(this);this.id=b;this.type=c;this.field=k;this.Sd=this.kg=m;this.fe="写下你的评论…";this.placeholder='<p style="color:#999">'+this.fe+"</p>";this.Gl="";this.ia=0;this.ZE=$.Deferred().resolve();this.Vy=this.ms=k;this.cC="zm-comment-box";this.xm=k;F.extend(this.F={},this.R,d||{})};y(Rw,T);t=Rw.prototype;t.R={WE:m,autofocus:j,JL:"empty",Ke:"zm-item-comment"};
a.Uw=function(b,c,d){var e=J(b.cC,c);d&&(b.xm=d);if(e){b.n(e);Sw(b);var c=location.hash.slice(1).split("-"),g="comment"===c[0]&&c[1];g&&(c=z.find(Tw(b),function(b){return b.getAttribute("data-id")===g}),gk(c));b.Sd=j;z.forEach(Tw(b),b.uy,b)}else b.kg=j,b.W(c)};t.VJ="zm-comment-bubble";t.CB="."+Rw.prototype.VJ;t.Wt=function(b){return $(b,this.e)};t.o=function(){this.e=K("div",{"class":this.cC,style:"display:none"});this.Qd()};t.Hi=s('<i class="icon icon-spike zm-comment-bubble"></i><div class="zm-comment-spinner">正在加载，请稍等 <i class="spinner-lightgray"></i></div>');
t.p=function(){Rw.m.p.call(this);this.field=this.xb=this.gn=this.rB=this.xm=this.Vy=this.XE=k};a.Vw=function(b){var c=b.Zk,d=c.h();if(c.ll()!==b.placeholder){c.ge(m,b.placeholder);var e=["click","focus","keydown"],g=function(){c.ge(m,this.Gl||"");this.field.lastChild?Yr(this.field.lastChild):c.Vf();wd(d,e,g,m,this)};N(d,e,g,m,b);var h;window.getSelection?(h=window.getSelection(),h.anchorNode&&sc(b.field,h.anchorNode)&&h.removeAllRanges()):document.selection&&b.field.blur()}};
t.Pr=function(b){(b=b.h&&b.h())&&(new Lw({XD:{image:ha}})).n(b)};t.Or=function(b,c){if(b.h){var d=(new Qi).add("type",this.type+"_comment").add("resource_id",this.id),e=b.h();this.sY=d=new Vp(e,{Im:{content:d.toString()},Mj:J("zu-main")});new Np(e,{iz:Xp});qa(c)&&c(d)}};a.Ww=function(b){b.focus();b=oo(b);b.collapse();b.select()},a.Tw=function(b){return $(b.gn).children(".zm-item-comment").get()};t.lH=function(b){D.enable(this.xb,"zm-comment-form-expanded",b)};
t.mi=function(b,c){this.dispatchEvent(new Iw("click!comment",{category:"?",action:this.type+"_comments",label:"?_"+b,value:pa(c)?c:this.cb()}))};t.dj=function(){this.Sd?Xw(this):this.kg=j};t.sQ=function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))this.Yp(),$(this.field).blur(),b.preventDefault();27===b.keyCode&&Yw(this)};
t.fa=function(b){var c=kk(this.e,b.target);if(c&&c.name){var d=Ic(c,k,this.F.Ke);b.preventDefault();switch(c.name){case "reply_comment":a:if(S.Ma()){var c=J("zm-comment-content-wrap",d),e=J("zm-comment-form",c),g=d.getAttribute("data-id"),h=this,l;if(e){l=J("zm-comment-editable",e);if(pg(e)){if(os(e)){R(e,m);break a}}else R(e,j);Ww(l)}else{e=fc('<div class="zm-comment-form zm-comment-form-editing">            <div class="zm-comment-editable-wrap">                <div class="zm-comment-editable" aria-label="写下你的回复"></div>            </div>            <div class="zm-command zg-clear">                <a href="javascript:;" class="zm-comment-submit zg-right zg-btn-blue">评论</a>                <a href="javascript:;" class="zm-comment-close zm-command-cancel">取消</a>            </div>        </div>');
c.appendChild(e);l=J("zm-comment-editable",e);var n=new Cw(l);n.be();this.Or(n,function(){Ww(l)});this.Pr(n);var d=J("zm-comment-close",e),c=J("zm-comment-submit",e),q=function(){var b=Ka(n.ll()),c=Ka(Fc(l));b&&c?Zw(h,{content:b,cO:g},function(b){b.r||(R(e,m),n.ge(m,""),(b=z.rf(Tw(h)))&&vs(b,{offsetTop:100,xB:j}))}):(U("请填写内容"),l.focus())};N(d,"click",function(){R(e,m)});N(c,"click",q);N(l,"keydown",function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))q(),b.preventDefault()})}vs(e,100)}else d=nk.D(),
"question"===this.type?d.Ga="question_comment_reply":"answer"===this.type&&(d.Ga="question_answer_comment_reply"),d.w(j);break;case "cancelanon":d=$(this.e).parents(".feed-item-hook").data("qid");es(0,k,d);break;case "delcomment":this.ul(c);break;case "like_comment":if(S.Ma()){var d=$(c),b=Ic(c,k,this.F.Ke),c=$(".like-num",b),r=b.getAttribute("data-id"),b=!d.hasClass("liked");("post"===this.type?hv:nt)(r,b);var r=$("em",c),x=+r.text()+(b?1:-1);c.toggleClass("liked",b).toggleClass("nil",0>=x).attr("data-tip",
"s$r$"+x+" 人觉得这个很赞");r.text(x);d.toggleClass("liked",b);Yj(d[0],b?"取消赞":"赞")}else nk.D().w(j);break;case "author_delcomment":var E=Ic(c,k,this.F.Ke),G=E.getAttribute("data-id"),I=Ai("删除评论",'你确定要删除这条评论吗？<p style="margin-top: 0.2em;color:#999;"><label><input type="checkbox">同时将此人屏蔽</label></p>',function(b){if(b){var b=$(":checkbox",I.h()).prop("checked"),c=xa(L,E);$.post("/node/AnswerCommentV2",{method:"author_remove_comment",params:{comment_id:G,is_block:Number(b)}}).done(v(function(){qa(c)&&c();this.ia-=
1;$w(this)},this))}},this);break;case "admin_delcomment":var d=qv.D(),Q=Ic(c,k,this.F.Ke),b={id:Q.getAttribute("data-id"),type:"comment"};d.dl=b;xv(d,c,v(function(){L(Q);this.ia-=1;$w(this)},this),"delete");d.w(j);break;case "closeform":Yw(this);break;case "report":this.Qw(c);b.stopPropagation();break;case "addnew":this.Yp();break;case "load-more":this.mi("comments_all"),this.XE(c)}}};
t.XE=function(b){this.ms&&"pending"===this.ms.state()||(b&&D.add(b,"loading"),this.ms=this.Vy||this.YE(),this.ms.done(v(function(c){c=$(c).filter(".zm-item-comment").get();if(c.length){var d=Tw(this);d.length&&(c=z.filter(c,function(b){return!z.find(d,function(c){return c.getAttribute("data-id")===b.getAttribute("data-id")})}),c=z.concat(d,c).sort(function(b,c){return b.getAttribute("data-id")-c.getAttribute("data-id")}),z.forEach(c,this.EB,this),b&&L(b));hc(this.gn,c)}},this)))};
a.Yw=function(b){0<b.cb()?(b.Gl=b.bb(),b.lH(m),Vw(b)):b.collapse();b.ye()};t.expand=function(){this.Ia(j)};t.collapse=function(){this.Ia(m)};t.ic=p("Sd");t.Ia=function(b){if(b!==this.Sd){b&&(this.Wt(this.CB).hide(),this.Qd());this.Sd=b;this.dispatchEvent(b?"beforeexpand":"beforecollapse");R(this.e,this.Sd);var c=v(function(){b&&ax(this);this.dispatchEvent(b?"expand":"collapse")},this);b&&this.kg?Xw(this).done(c):c()}};t.he=function(){this.Ia(!this.Sd)};
a.ax=function(b){if(b.xm){var c=$(b.xm);b.Wt(b.CB).show().css("left",c.position().left+c.width()/2)}},a.Xw=function(b){if("pending"!==b.ZE.state()){b.ib();b.e.innerHTML=b.Hi();b.expand();var c={post:jv,answer:ut,question:mt,favlist:gt}[b.type](b.id,b.F.WE).done(v(b.ZR,b));return b.ZE=c}};t.YE=function(){return{post:kv,answer:tt,question:lt,favlist:ft}[this.type](this.id)};
a.bx=function(b,c,d,e){var c=$(c),g=$(d);d?($(".zm-command, .zm-comment-info",b.e).hide(),$(b.field).hide().after(g).after(c)):c.insertAfter(b.field);e&&e.call(b,c,g)};t.ZR=function(b){b=fc(Ka(b));z.forEach($("."+this.F.Ke,b).get(),this.uy,this);this.kg=m;this.ib();mc(b,this.e);this.e=b;Sw(this)};
a.Sw=function(b){F.forEach({rB:".load-more",gn:".zm-comment-list",xb:".zm-comment-form",field:".zm-comment-editable"},function(b,c){this[c]=$(b,this.e)[0]},b);b.field.setAttribute("aria-label",b.fe);if(ki){var c=b.field;c.setAttribute("contentEditable",j);var d=b.Zk={h:function(){return c},ll:function(){return c.innerHTML},ge:function(b,d){c.innerHTML=d},Vf:function(){Ks(c)}};b.Or(d);b.Pr(d)}else{var e=K("textarea",{placeholder:b.fe,"class":"zm-comment-textarea"});mc(e,b.field);new fm(e,22);b.field=
e;b.Zk={h:function(){return e},ll:function(){return e.value},ge:function(){e.value="";e.style.height=Xf(22,j)},Vf:function(){e.focus()}}}b.g().c(b.field,["change","keyup"],function(b){27!==b.keyCode&&(this.Gl=Ls(this.field)?"":this.bb())});S.Ma()&&!S.Ld&&bx(b,'<div class="active-mask-tip-comment">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>',function(b,c){function d(){Vn.D().w(j)}b.on("click",d);c.on("click",d)});
S.Ma()||bx(b,'<div class="signin-mask-tip-comment"></div>',k,function(c,d){function e(){nk.D().w(j);"question"===b.type?nk.D().Ga="question_comment_box":"answer"===b.type&&(nk.D().Ga="question_answer_comment_box");nk.D().fh()}c.on("click",e);d.on("click",e)});Vw(b);b.g().c(b.e,"click",b.fa).c(b.field,"keydown",b.sQ).c(Ii,"anon_change",b.dj).c(b.Zk.h(),["click","focus"],xa(b.lH,j)).c(b.Zk.h(),"focus",xa(b.mi,"add_comment_start"));b.ia=Number(b.e.getAttribute("data-count"));$(b.e).on("focusin focusout",
"."+b.F.Ke,function(b){$(this).toggleClass("focusin","focusin"===b.type)});!sb&&b.rB&&(b.Vy=$.Deferred(function(b){setTimeout(b.resolve,2E3)}).promise().then($.proxy(b.YE,b)));$w(b);ax(b)},a.$w=function(b){var c=b.F,d=!b.cb();D.enable(b.e,c.JL,d);if(b.xm){var e=b.cb();Yj(b.xm,e?e+" 条评论":"添加评论")}d&&b.field&&c.autofocus&&b.field.focus();b.dispatchEvent("change")};t.bb=function(){var b=Ka(this.Zk.ll());return b===this.placeholder?"":b};
t.Yp=function(){var b=this.bb(),c=Ka(Fc(this.field));b&&"TEXTAREA"===this.field.tagName&&c||b?Zw(this,b):(U("请填写内容"),this.field.focus())};t.cb=p("ia");a.Zw=function(b,c,d){if(!(b.Xl&&"pending"===b.Xl.state())){var e;ra(c)&&(e=c.cO,c=c.content);var c=Ma(c),g=new Md,h=b.type,l={post:gv,answer:qt,question:kt,favlist:ht}[h];g.set(h+"_id",b.id);g.set("content",c);e&&g.set("in_reply_to",e);c=l(g.It());c.done($.proxy(b.rM,b)).done(d);b.Xl=c;b.Gl=b.bb();b.mi("add_comment_submit")}};
t.rM=function(b){if(b.r)return U(b.msg);("post"===this.type?fv:pt)(b.msg).done($.proxy(this.$R,this));this.Zk.ge("");Vw(this);D.remove(this.xb,"zm-comment-form-expanded")};t.uy=function(b){this.EB(b)};
t.EB=function(b){if(Pg("auth_f_manage")&&!("favlist"===this.type||$(".del",b).length)){var c=b.getAttribute("data-id");$("<a>",{href:"#",name:"admin_delcomment","class":"del zm-comment-op-link needsfocus",html:'<i class="zg-icon zg-icon-comment-del"></i>删除',"data-op":"remove-comment","data-action":"/manage?"+$.param({comment_id:c,action:"remove_comment2"})}).appendTo($(".zm-comment-ft",b))}};t.$R=function(b){this.Gl="";b=fc(b);this.gn.appendChild(b);this.uy(b);this.ia+=1;$w(this)};
t.Qw=function(b){b=Ic(b,k,this.F.Ke).getAttribute("data-id");Wt.am("comment",b)};t.ul=function(b){var c=Ic(b,k,this.F.Ke),d=c.getAttribute("data-id");Ai("删除评论","你确定要删除这条评论吗？",function(b){if(b){var g=xa(L,c);("post"===this.type?iv:ot)(d).done(v(function(){qa(g)&&g();this.ia-=1;$w(this)},this))}},this)};t.Qd=function(){$(window).on("beforeunload.CommentForm",v(function(){if(this.Gl)return"你的评论还未保存，确认离开该页面吗？"},this))};t.ye=function(){$(window).off("beforeunload.CommentForm")};a.cx=function(b){this.G=$(b);this.kf()};cx.prototype.kf=function(){var b=[this.G.get(0)].concat(this.G.parents().get()),c=$.map(b,function(b){return $(b).data("navigable")})[0],d=c&&$.grep(c.items(),function(c){return~$.inArray(c,b)})[0];this.vY=c;this.FP=d};cx.prototype.getItem=p("FP");a.dx=function(b,c,d,e){fq.call(this,b,c,d,e)};y(dx,fq);dx.prototype.Qd=function(){$(window).on("beforeunload.AnswerEditor",v(s("你的修改还未保存，确认离开该页面吗？"),this))};dx.prototype.ye=function(){$(window).off("beforeunload.AnswerEditor")};dx.prototype.gh=function(){dx.m.gh.call(this);this.ye()};dx.prototype.Gd=function(){dx.m.Gd.call(this);this.Qd()};a.ex=function(){this.Wu=[]};y(ex,au);ia(ex);ex.prototype.o=function(b){var c=ex.m.o.call(this,b);D.add(c,"goog-submenu");fx(this,b,c);return c};ex.prototype.n=function(b,c){c=ex.m.n.call(this,b,c);D.add(c,"goog-submenu");fx(this,b,c);var d=Ub("div","goog-menu",c);if(d.length){var e=new iu(b.H()),d=d[0];R(d,m);b.H().za().body.appendChild(d);e.n(d);b.eh(e,j)}return c};
ex.prototype.La=function(b,c){var d=this.Y(b),e=d&&d.lastChild;ex.m.La.call(this,b,c);e&&(d.lastChild!=e&&D.has(e,"goog-submenu-arrow"))&&d.appendChild(e)};ex.prototype.Ge=function(b){ex.m.Ge.call(this,b);var c=b.Y(),d=b.H(),d=Tb(d.Ca,"span","goog-submenu-arrow",c)[0];gx(b,d);d!=c.lastChild&&c.appendChild(d);Nc(b.h(),Uc.zk,"true")};
a.fx=function(b,c,d){var e=c.H().o("span");e.className="goog-submenu-arrow";gx(c,e);b.Y(d).appendChild(e)},a.gx=function(b,c){b.Dd()?(D.add(c,"goog-submenu-arrow-rtl"),xc(c,b.aq?"◄":"►")):(D.remove(c,"goog-submenu-arrow-rtl"),xc(c,b.aq?"►":"◄"))};a.hx=function(b,c,d,e){fu.call(this,b,c,d,e||ex.D())};y(hx,fu);a.ix=218;t=hx.prototype;t.Nd=k;t.Lz=k;t.ZD=m;t.mc=k;t.dr=m;t.aq=j;t.JO=m;t.z=function(){hx.m.z.call(this);this.g().c(this.getParent(),"hide",this.UF);this.mc&&jx(this,this.mc,j)};t.ib=function(){this.g().Ba(this.getParent(),"hide",this.UF);this.mc&&(jx(this,this.mc,m),this.dr||(this.mc.ib(),L(this.mc.h())));hx.m.ib.call(this)};t.p=function(){this.mc&&!this.dr&&this.mc.C();this.mc=k;hx.m.p.call(this)};
t.qd=function(b,c){hx.m.qd.call(this,b);c&&(this.Wa().fg=j);b||(this.Nd&&Gd.clearTimeout(this.Nd),this.Nd=Jd(this.Gg,ix,this))};t.tt=function(){var b=this.getParent();b&&Fs(b)==this&&(kx(this,j),lx(this),this.lY=m)};t.Gg=function(){var b=this.mc;b&&b.getParent()==this&&(kx(this,m),mh(b,function(b){"function"==typeof b.Gg&&b.Gg()}))};a.mx=function(b){b.Nd&&Gd.clearTimeout(b.Nd);b.Lz&&Gd.clearTimeout(b.Lz)};t.w=function(b,c){var d=hx.m.w.call(this,b,c);d&&!this.Q()&&this.Gg();return d};
a.lx=function(b){mh(b.getParent(),function(b){b!=this&&"function"==typeof b.Gg&&(b.Gg(),mx(b))},b)};t.Vb=function(b){var c=b.keyCode,d=this.Dd()?37:39,e=this.Dd()?39:37;if(this.ZD){if(!this.Wa().Vb(b))if(c==e)this.Gg();else return m}else if(this.isEnabled()&&(c==d||c==this.ey))this.tt(),Gs(this.Wa()),mx(this);else return m;b.preventDefault();return j};t.YP=function(){this.mc.getParent()==this&&(mx(this),this.Sl.qd(this),lx(this))};t.UF=function(b){b.target==this.Sl&&(this.Gg(),mx(this))};
t.kd=function(b){this.isEnabled()&&(mx(this),this.Lz=Jd(this.tt,ix,this));hx.m.kd.call(this,b)};t.ee=function(b){mx(this);if(this.Qb&8)return hx.m.ee.call(this,b);this.tt();return j};
a.kx=function(b,c){b.dispatchEvent(ih(64,c));var d=b.Wa();if(c!=d.Q()&&(c&&(d.xa||d.W(),d.Pb(-1)),b.ZD=c,D.enable(b.h(),"goog-submenu-open",c),d.w(c),c)){var d=new Us(b.h(),b.aq?6:4,b.JO),e=b.Wa(),g=e.h();e.Q()||(g.style.visibility="hidden",R(g,j));d.na(g,b.aq?4:6);e.Q()||(R(g,m),g.style.visibility="visible")}},a.jx=function(b,c,d){var e=b.g();(d?e.c:e.Ba).call(e,c,"highlight",b.YP)};t.Da=function(b){this.Wa().M(b,j)};t.wi=function(b,c){this.Wa().Bk(b,c,j)};
t.removeItem=function(b){(b=this.Wa().removeChild(b,j))&&b.C()};t.Nh=function(b){return oh(this.Wa(),b)};t.nl=function(){return nh(this.Wa())};t.Mb=function(){return this.Wa().Mb()};t.Wa=function(){this.mc?this.dr&&this.mc.getParent()!=this&&lh(this.mc,this):this.eh(new iu(this.H()),j);this.mc.h()||this.mc.o();return this.mc};t.eh=function(b,c){var d=this.mc;b!=d&&(d&&(this.Gg(),this.xa&&jx(this,d,m)),this.mc=b,this.dr=!c,b&&(lh(b,this),b.w(m,j),b.Lm=m,b.Qe(m),this.xa&&jx(this,b,j)))};t.Kf=function(b){return this.Wa().Kf(b)};
sq("goog-submenu",function(){return new hx(k)});a.nx=function(b,c,d,e){hx.call(this,b,c,d,e)};y(nx,hx);nx.prototype.Vb=function(b){var c=nx.m.Vb.call(this,b),b=parseInt(Ej[b.keyCode],10);isNaN(b)||this.Wa().Pb(b-1);return c};a.ox=function(b){F.extend(this.F={},this.R,b||{});this.content="";this.cd=this.sd=this.ph=k;this.Sd=m;this.valid=j};y(ox,T);t=ox.prototype;t.R={xT:"textarea.content",pK:".toggle-expand",pT:".summary",XK:"zm-editable-content"};
t.z=function(){ox.m.z.call(this);var b=this.e,c=this.F;this.content=$(c.xT,b).remove().val();this.ph=$(c.pT,b);this.cd=$(c.pK,this.ph);if(this.ph.length){if(this.cd.length)this.cd.click(m).on("click",$.proxy(this.expand,this));this.ph.on("click",$.proxy(this.xN,this))}else this.valid=m,this.expand=this.collapse=ha,this.dispatchEvent("invalid")};t.hd=function(){return this.cd.get(0)};t.bb=p("content");t.Ia=function(b){b?this.expand():this.collapse()};
t.xN=function(b){var c=$o();if(!c||!c.Jc())c=$(b.target).closest("a").get(0),c&&"javascript:"!==c.protocol||(b.preventDefault(),b.stopPropagation(),this.expand())};t.expand=function(){this.Sd||(this.Sd=j,this.sd?this.sd.show():this.ph.length&&(this.sd=$("<div>",{html:this.content,"class":this.F.XK}).insertBefore(this.ph)),this.ph.hide(),this.dispatchEvent("expand"))};t.collapse=function(){this.Sd&&(this.Sd=m,this.sd.hide(),this.ph.show())};a.px=function(b,c){T.call(this);this.Sc=b;this.entryType=c};y(px,T);px.prototype.ea=function(b){px.m.ea.call(this);this.e=b;this.g().c(this.e,"click",this.ZK)};
px.prototype.ZK=function(){if(!this.ab){this.ab=new vi(k,m);this.ab.Zo(j);this.ab.aM=j;var b=this.ab.Y(),c=$(this.e).siblings(".zm-votebar").clone().addClass("votebar-mobile")[0];b.appendChild(c);var d=$("<div class='text zg-clear'><label class='zg-left'>赞同</label><label class='zg-right'>反对</label></div>")[0];b.appendChild(d);this.Sb=new lv(this.Sc);this.Sb.n(c);D.add(this.ab.e,"votebar-mobile-container");this.g().c(this.Sb,"change",function(){this.dispatchEvent("change");this.ab.w(m)});this.g().c(this.Sb,
"action",function(b){this.dispatchEvent(b)})}this.ab.w(j)};a.qx=function(b,c,d){T.call(this);this.V=b;this.ka=d;this.gL=c||Cg;this.ev=k};y(qx,T);a.rx={all_can_comment:"允许任何人评论",followee_can_comment:"允许我关注的人评论",nobody_can_comment:"关闭评论"};t=qx.prototype;
t.My=function(){var b=J("zm-item-answer",this.e)||this.e;this.ka=b.getAttribute("data-aid");this.Me="1"===b.getAttribute("data-isowner");this.Ac=b.getAttribute("data-atoken");this.ag="1"===b.getAttribute("data-deleted");this.kv=+b.getAttribute("data-created");this.QN=+b.getAttribute("data-helpful");this.Qg="1"===b.getAttribute("data-collapsed");this.jb=k};t.jP=function(){Au("answer",this.Ac,"read")};t.kP=function(){Au("answer",this.Ac,/^\/question\//.test(location.pathname)?"read":"touch")};
t.z=function(){function b(){c();var b=h.Zp.Nh(0);b.Wa&&b.Wa()&&(b.tt(),b.Wa().Pb(0))}function c(){sx(h);h.Zp.Pb(0)}qx.m.z.call(this);this.My();this.yg=J("zm-item-answer-author-info",this.e);var d=this.tp=new ox;this.M(d);d.n(this.e);d.hd()&&P(this.g(),d,"expand",this.jP);Pt(this.e,this.kP,this);(this.Wb=this.Wb||J("zm-item-meta",this.e))&&this.g().c(this.Wb,"click",this.Ol);if(this.Me)this.yg&&(this.fG=(this.jb=Va(this.yg.innerHTML,"匿名用户"))?k:this.yg.innerHTML.replace(/src=".+?"/g,'src="'+S[2]+'"'),
this.g().c(this.yg,"click",function(b){"cancel-anon"===b.target.name&&es(m)}));else{var e;if(d=J("zm-votebar",this.e))e=new lv(this.ka),e.n(d),this.g().c(e,"change",this.HG),this.g().c(e,"action",function(b){b.data.state===mv.Te?W.X({type:"ga_click_vote_up",target:this}):b.data.state===mv.wg&&W.X({type:"ga_click_vote_down",target:this})});this.Sb=e;this.hI=d;if(d=J("votenum-mobile",this.Wb))e=new px(this.ka),e.n(d);e&&(this.g().c(e,"change",this.HG),this.g().c(e,"action",function(b){b.data.state===
mv.Te?W.X({type:"ga_click_vote_up",target:this}):b.data.state===mv.wg&&W.X({type:"ga_click_vote_down",target:this})}))}if(e=J("zm-item-vote-info",this.e)){this.Am=new ov(this.ka);this.M(this.Am);this.Am.n(e);var g=$(".zm-item-vote-count",this.e);g[0]||(g=$(".zm-item-vote-count",this.Wb));if(g.length)this.Am.on("change",function(){var b=g.find("label");b[0]?b.text(pv(this)):g.text(pv(this))})}this.Qr();this.nx();this.Ha();e=new cx(this.e);e=Uj.GA(e.getItem()||this.e);Tj(Rj(Tj(Rj(Tj(Rj(Tj(Rj(Tj(Rj(Tj(Rj(Tj(Rj(e,
"v",function(){this.Sb&&this.Sb.pA()},this),{group:"操作",name:"赞同"}),"d",function(){this.Sb&&this.Sb.oA()},this),{group:"操作",name:"反对"}),"f x",this.hf,this),{group:"操作",name:"分享"}),"s c",this.Cw,this),{group:"操作",name:"收藏"}),"t",this.RD,this),{group:"操作",name:"感谢"}),"c",this.Dw,this),{group:"操作",name:"打开评论"}),"shift+c",this.xw,this),{group:"操作",name:"定位到评论框"});var d=kb?"⌘":"ctrl",h=this;Bg.xE&&$("a[name=admin]",this.Wb)[0]&&Tj(Rj(Tj(Rj(e,"meta+.",c),{group:"管理",name:"展开菜单",key:d+"+."}),"meta+k",b),
{group:"管理",name:"展开折叠子菜单 (Kill)",key:d+"+k"});if(e=J("more-actions",this.Wb)){var l={share:{label:"分享",action:this.hf},fav:{label:"收藏",action:this.Cw},report:{label:"举报",action:this.Qw},nohelp:{label:this.QN?"没有帮助":"撤销没有帮助",action:this.jN}},n=new iu,d=function(b){nh(n)&&n.Da(new hu);var c=new fu(l[b].label);c.sa(b);n.Da(c)};sb&&!gi&&(d("share"),d("fav"));this.Me||(d("nohelp"),S.Ma()&&d("report"));d=new Ju("operation",n);d.Ys=j;Lu(d);d.jF=new Mf(7,0,7,0);d.Pl=ba();d.Qc=lf;d.n(e);D.add(n.h(),"zh-answer-more-actions");
this.g().c(n,"action",function(b){var c=l[b.target.U()];c&&c.action.call(this,b)})}};t.Ez=function(b){var c=this.Qr();c&&Ip(c,b)};t.Qr=function(){if(this.ke)return this.ke;var b=J("zm-editable-content",this.e);!this.Me&&(!sb&&S.Ma())&&(this.Sb&&$(this.hI).is(":visible")&&b&&230<$(b).height())&&(this.ke=new Lp(k,b),this.M(this.ke),this.ke.ji="votebar",this.ke.Jy=50,this.ke.n(this.hI))};t.HG=function(){this.Am&&this.Am.Tj()};
a.tx=function(b){if(!b.qe&&b.Me&&Cg&&b.ka){b.qe=new dx(m,"/answer/content","content");Rc(b,b.qe);b.qe.Nt=j;b.qe.Fv=j;b.qe.yD=lw.prototype.yD;var c=J("zm-item-rich-text",b.e);b.qe.de=["id="+b.V];b.qe.n(c);b.g().c(b.qe,"shouldUpdateContent",function(b){if(la(b.data))return m});b.g().c(b.e,"click",function(b){"suggest_edit"===b.target.name&&this.qe.Gd();return j})}};
t.Ha=function(){this.yg&&this.g().c(this.yg,"click",this.fa);this.Me&&(this.YJ=S);this.g().c(Ii,"anon_change",function(b){this.Me?this.Yo(b.jb):this.Sb.Xd()===mv.Te&&this.Am.Tj()});tx(this);$(this.e).on("focusin focusout",function(b){$(this).toggleClass("focusin","focusin"===b.type)})};t.df=function(b){return kk(this.e,b)};
t.fa=function(b){if(b=(b=this.df(b.target))&&b.name)if("edit"===b){b=Su();if(!this.Ju){var c=Cg.Ac;b.Qx=j;b.GG=c;this.g().c(b,"change",this.ry)}this.Ju=j;Tu(b)}else"complex"===b&&(b=J("zm-item-answer-summary",this.e),c=J("zm-item-rich-text",this.e),R(b,m),R(c,j))};t.ry=function(){var b=Su().fw()||S[4]||"";b&&this.kt(b)};t.kt=function(b){this.Wm=b;this.Yo(m)};t.nx=function(){var b=J("zm-item-answer-author-wrap",this.e),b=J("zm-list-avatar",b);Wj.add(b)};
t.Yo=function(b){b?this.yg.innerHTML='<h3 class="zm-item-answer-author-wrap">匿名用户<a class="zg-link-gray cancel-anon" href="javascript:void(0);" name="cancel-anon">取消匿名</a></h3>':this.Me&&(this.fG?this.yg.innerHTML=this.fG.replace("</h3>","").replace("</H3>","")+'<a name="edit" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a></h3>':(b=[],b.push('<h3 class="zm-item-answer-author-wrap">'),b.push($s()),b.push(at(S,"zm-item-answer-creator")),b.push("</h3>"),this.yg.innerHTML=
b.join("")))};t.HO=p("Me");
a.ux=function(b,c){b.la||(b.la=new Rw(b.ka,"answer",c),b.M(b.la),Uw(b.la,b.Wb,$(".toggle-comment",b.Wb)[0]))},a.sx=function(b){if(b.Zp)b.Zp.w(j);else{var c;var d=$("a[name=admin]",b.Wb)[0];if(d){b.kJ=d;ix=0;c=new Nu;b.M(c);c.attach(d,5);d=b.Qg?new fu("取消折叠"):new nx("折叠");d.sa("collapse");if(!b.Qg){for(var e=0;e<sv["collapse-answer"].tb.length;e++){var g=new fu([K("span","",(e+1).toString()+" "),document.createTextNode(rv[sv["collapse-answer"].tb[e]])]);g.sa(sv["collapse-answer"].tb[e]);d.Da(g)}D.add(d.Wa().h(),
"manage-menu")}e=new fu("删除");e.sa("delete");c.Da(d);c.Da(e);c.W(b.e);D.add(c.h(),"manage-menu")}else c=i;c&&(Ou(c,new Us(b.kJ,1,j),0,new Mf(5,0,5,0)),b.g().c(c,"action",function(b){var c=b.target,b=c.U(),c=c.h(),d=new Qi;if("collapse"===b)d.add("answer_id",this.ka).add("action","collapse2").add("collapse",this.Qg?"cancel":"done"),c.setAttribute("data-op",this.Qg?"uncollapse-answer":"collapse-answer"),c.setAttribute("data-action","/manage?"+d.toString()),vx(this,c);else if("delete"===b)d.add("answer_id",
this.ka).add("action","remove_answer2"),c.setAttribute("data-op","remove-answer"),c.setAttribute("data-action","/manage?"+d.toString()),vx(this,c,"delete");else if(pa(b)){var e=$(this.e),c=new Qi;c.add("answer_id",this.ka).add("action","collapse2").add("collapse",this.Qg?"cancel":"done").add("reason",b);uv("/manage",c.toString(),function(){e.hide("fast",function(){e.remove()})})}}),wx(b,c),b.Zp=c)}},a.vx=function(b,c,d){var e=qv.D();e.dl={id:b.ka,type:"answer"};xv(e,c,v(function(){R(this.e,m)},b),
d);e.w(j)};
t.Ol=function(b){var c=(b=this.df(b.target))&&b.name;if(c)switch(c){case "addcomment":if("添加评论"===$.trim($(b).text())&&this.Fj(0,"question_answer_add_comment_start"))break;this.Dw();this.la.ic()&&this.la.mi("view_comments",parseInt(Fc(b),10)||0);break;case "remove":this.ul();break;case "thanks":W.X({type:"ga_click_thank_answer",target:b});this.RD();break;case "comment_opt":this.TS=b;if(!this.dC||!this.dC.Gb()){c=this.QK;if(!c){var b=$(b).data(),d=new Nu,c=new xx("禁止转载");c.Zc(!b.copyable);d.Da(c);
d.Da(new hu);this.fv=[];F.forEach(rx,function(b,c){var h=new xx(b);h.sa(c);h.Zc(c===this.ev);this.fv.push(h);d.Da(h)},this);d.Da(new hu);d.Da(new fu("删除"));this.g().c(d,"action",this.zM);wx(this,d);d.W(document.body);D.add(d.h(),"zm-question-answer-meta-comment-option-menu");c=this.QK=d}this.ev||(b=new V(j),P(this.g(),b,"success",function(b){if((b=Ge(b.target))&&!b.r){var c=b.msg;z.forEach(this.fv,function(b){b.U()===c&&b.Zc(j)});this.ev=c}else U(b.msg)}),b.ajax("/answer/comment_permission?answer_id="+
this.ka,k,"GET"),this.dC=b);c.Q()?c.w(m):Ou(c,new Us(this.TS,1,j),0,new Mf(5,0,5,0))}break;case "admin":sx(this);break;case "share":W.X({type:"ga_click_share_answer_box",target:b});this.hf();break;case "favo":W.X({type:"ga_click_collect_answer_box",target:b}),this.Cw()}};t.Fj=function(b,c){var d={"0":"为了保留你对答案的操作，请先登录或注册知乎",1:"为了继续你的操作，请先登录或注册知乎"};return!S.Ma()?(nk.D().Ga=c,nk.D().w(j),nk.D().fh(d[b]),j):m};t.Qw=function(){Wt.am("answer",this.ka)};
t.jN=function(b){b=b.target;W.X({type:"ga_click_answer_not_helpful",target:b.h()});if(!this.Fj(0,"question_answer_not_helpful")){this.xv&&"pending"===this.xv.state()&&this.xv.abort();var c=-1<b.Jg().indexOf("撤销");b.jm(c?"没有帮助":"撤销没有帮助");this.xv=$.post(c?"/answer/helpful":"/answer/not_helpful",{aid:this.ka})}};t.hf=function(){if(!this.Fj(1,"question_question_share")){var b=vu.D();xu(b,this.ka,"/answer/"+this.Ac,"a");b.show();yu(b,"tb-webshare-sina")}};
t.Cw=function(){if(!this.Fj(0,"question_answer_collect"))if(S.Ma()&&!S.Ld)Vn.D().w(j);else{var b=Wu(),c=this.ka;if(b.ka!==c&&b.Ug){var d=Vb("zm-favo-list-item-link",b.Ug);z.forEach(d,function(b){D.remove(b,"zm-favo-list-item-link-active")},b)}b.ka=c;b.show()}};t.Dw=function(){this.la||ux(this);this.la.he()};t.xw=function(b){this.la?this.la.field.focus():this.Dw();b.preventDefault()};
t.RD=function(){if(!this.Fj(0,"question_answer_thank")){var b=$("a[name=thanks]",this.Wb)[0];b&&!D.has(b,"disabled")&&(Yj(b,"已感谢"),D.add(b,"disabled"),gk(b),$.post("/answer/thanks",{aid:this.ka}))}};a.wx=function(b,c){b.g().c(c,"show",function(){D.add(this.Wb,"zm-item-meta-has-menu")}).c(c,"hide",function(b){b.currentTarget===b.target&&D.remove(this.Wb,"zm-item-meta-has-menu")})};
t.zM=function(b){var c=b.target,b=c.U();"禁止转载"===b?(b=!c.He(),$.post("/node/AnswerMetaV2",{method:"set_copyright",params:{answer_id:this.ka,is_copyable:Number(b)}}),$(".copyright",this.Wb).html(b?"":'<span class="zg-bull">&bull;</span> 禁止转载')):"删除"===b?this.ul():b in rx&&$.post("/answer/comment_permission",{answer_id:this.ka,permission:b}).done(v(function(b){b&&!b.r&&z.forEach(this.fv,function(b){b.Zc(b===c)})},this))};
t.ul=function(){Ai("你确定要删除自己的答案吗？","答案内容不会被永久删除，你还可以撤消本次删除操作。",function(b){b&&(this.ag=j,this.status=-1,yx(this))},this)};a.yx=function(b){var c=new V(j);P(b.g(),c,"success",function(){R(this.e,!this.ag);this.ag?this.ku="set_delete":(tx(this),this.ku="cancel_delete");this.dispatchEvent("change");$(this.e).parent(".zm-item").hide()});c.ajax("/answer/"+(b.ag?"remove":"unremove"),"aid="+b.ka)};t.h=p("e");a.zx=function(){T.call(this)};y(zx,T);t=zx.prototype;t.zn="zm-item-expanded";t.Ek="zm-item-answer";t.z=function(){zx.m.z.call(this);this.My();this.Ha();this.nx();this.uh();this.Cl();!this.Fk&&this.Ns&&Pt(this.e,this.lP,this)};t.p=function(){this.Fk=k;Tc(this.Ve);Tc(this.jH);zx.m.p.call(this)};t.uh=function(){this.jH=Tj(Rj(Uj.GA(this.e),"o",this.he,this),{group:"操作",name:"显示全部/收起"})};
t.My=function(){var b=this.e,c=this.Ek&&J(this.Ek,b);c&&(this.ka=c.getAttribute("data-aid"),this.Fl=c.getAttribute("data-isowner"),this.ZW=c.getAttribute("data-atoken"));this.V=b.getAttribute("data-qid");if(!(b=b.getAttribute("data-qtoken")))b=(b=J("question_link",this.e))&&b.pathname.split("/")[2];this.Ns=b;this.Fk=c};t.nx=function(){var b=J("zm-item-answer-author-wrap",this.e),b=J("zm-list-avatar",b);Wj.add(b)};t.ic=function(){return D.has(this.e,this.zn)};t.he=function(){this.Ia(!this.ic())};
t.Ia=function(b){this.Fk&&b!==this.ic()&&(D.enable(this.e,this.zn,b),b&&this.Cl(),this.Ve&&(this.Ve.Ez(b),this.Ve.tp.Ia(b)),this.dispatchEvent(b?"expand":"collapse"))};t.Ha=function(){this.g().c(this.e,"click",this.fa)};
t.fa=function(b){var b=b.target,c=b.name;if(c){this.Oa=b;var d="new"===$("#feed-ver").val()?j:m;switch(c){case "expand":this.Ia(j);if(d||this.Fl)b.name="toggleExpanded";break;case "toggleExpanded":this.he();break;case "complex":this.Ia(j);break;case "collapse":this.Gu(this.e);this.Ia(m);break;case "focus":d&&rk("follow","follow_question","v2");ok(this.Oa,"question",v(this.UN,this),i,{follow_text:"关注问题"});break;case "follow-p":ok(this.Oa,"people",xa(gk,b),i,{follow_text:b.getAttribute("data-follow_text")});
break;case "ignore":W.X({type:"ga_click_question_ignore",target:b});this.dispatchEvent({type:"ignore",V:this.V});(new V(j)).ajax("/question/uninterest","qid="+this.V);break;case "share":this.Ve||this.hf();break;case "toggle-comment":this.li&&this.li(),this.Yi().ic()&&this.Yi().mi("view_comments",parseInt(Fc(b),10)||0)}this.zh&&this.zh(b)}};t.Gu=function(b){var c=b.getBoundingClientRect().bottom;setTimeout(function(){var d=b.getBoundingClientRect().bottom,e=rs(document);window.scrollTo(e.x,e.y+d-c)})};
t.UN=function(){this.Oa&&gk(this.Oa)};t.lP=function(){Au("question",this.Ns,"touch")};t.Cl=function(){if(this.Fk){this.Ve=new qx(this.V,{Ac:this.Ns},this.ka);var b=J("zm-item-meta",this.e);this.Ve.Wb=b;this.M(this.Ve);this.Ve.n(this.Fk);b=this.Ve.tp;this.g().c(b,"expand",function(){this.Ia(j)});this.Cl=ha}};t.km=ca("zh");a.Ax=function(b,c,d){ju.call(this,b,c,d)};y(Ax,ju);Ax.prototype.Ij=function(b){var c=new zx;this.M(c);c.n(b);c.Ia(m)};a.Bx=function(){T.call(this);this.la=k};y(Bx,zx);t=Bx.prototype;
t.Ek="entry-body";t.p=function(){Tc(this.la);Bx.m.p.call(this)};t.uh=function(){Bx.m.uh.call(this);var b=this.jH;this.Fk||Tj(Rj(Tj(Rj(Tj(Rj(b,"c",this.li,this),{group:"操作",name:"打开评论"}),"f x",this.hf,this),{group:"操作",name:"分享"}),"shift+c",this.Iw,this),{group:"操作",name:"定位到评论框"});Tj(Rj(b,"shift+o",this.hR,this),{group:"操作",name:"新窗口打开条目"});this.e.getAttribute("tabindex")===k&&(this.e.tabIndex="-1")};t.hR=function(){window.open($(".question_link",this.e).attr("href"))};
t.hf=function(){this.Jd||(this.Jd=vu.D());xu(this.Jd,this.V,"/question/"+this.Ns,"q");this.Jd.show();yu(this.Jd,"tb-webshare-sina")};t.li=function(){this.la||this.cl();this.la.he()};t.Yi=p("la");t.Iw=function(){this.la?this.la.field.focus():this.li()};t.cl=function(){if(!this.la){var b=$(".zm-item-meta",this.e).get(0),c=$(".toggle-comment",this.e)[0];this.la=new Rw(this.V,"question");this.M(this.la);Uw(this.la,b,c)}};a.Cx=function(b){M.call(this);this.label=b};y(Cx,Hk);Cx.prototype.n=function(b){this.e=b;b=Ub("input",k,this.e);b.length&&(this.field=b[0]);this.as=K("label","zg-fly-input-label",this.label);kc(this.as,this.field);N(this.as,"click",function(){this.field.focus()},m,this);this.g().c(this.field,"focus",function(){R(this.as,m)}).c(this.field,"blur",function(){ak(this.field.value)||R(this.as,j)})};a.Dx=function(b){var c=b.type;if(!ka(c))return k;switch(c.toLowerCase()){case "checkbox":case "radio":return b.checked?b.value:k;case "select-one":return c=b.selectedIndex,0<=c?b.options[c].value:k;case "select-multiple":for(var c=[],d,e=0;d=b.options[e];e++)d.selected&&c.push(d.value);return c.length?c:k;default:return ka(b.value)?b.value:k}},a.Ex=function(b,c){var d=b.elements[c];if(d.type)return Dx(d);for(var e=0;e<d.length;e++){var g=Dx(d[e]);if(g)return g}return k};a.Fx={};a.Gx=function(){};y(Gx,T);Gx.prototype.ea=function(b){Gx.m.ea.call(this,b);this.g().c(W,"sina_callback",this.Ao);this.g().c(W,"qq_callback",this.Ao);this.g().c(H("zh-setting-page-bind-sina-unbindbtn"),"click",this.bG);this.g().c(H("zh-setting-page-bind-qq-unbindbtn"),"click",this.bG)};
Gx.prototype.Ao=function(b){if("qq_callback"===b.type){var c=Rg.name=b.sb.name,b=Rg.id=b.sb.id;H("zh-setting-page-bind-qqname").innerHTML='<a href="http://t.qq.com/'+b+'" target="_blank">@'+c+"</a>";Hx(j)}else"sina_callback"===b.type&&(c=Qg.name=b.sb.name,b=Qg.id=b.sb.id,H("zh-setting-page-bind-sinaname").innerHTML='<a href="http://weibo.com/'+b+'" target="_blank">@'+c+"</a>",Ix(j))};
Gx.prototype.bG=function(b){var c=b.target.getAttribute("data-weibotype");if(window.confirm("你确定要解除与"+("sina"===c?"新浪":"腾讯")+"微博的绑定吗？")){var d=new V(j);P(this.g(),d,"success",function(){var b=Ge(d);b&&!b.r?"sina"===c?Ix():Hx():U(b.msg)});d.ajax("/oauth/unbind/"+c)}};a.Ix=function(b){R(H("zh-setting-page-bind-sina-binded-wrap"),!!b);R(H("zh-setting-page-bind-sina-tobind-wrap"),!b)},a.Hx=function(b){R(H("zh-setting-page-bind-qq-binded-wrap"),!!b);R(H("zh-setting-page-bind-qq-tobind-wrap"),!b)};a.Jx=function(b){M.call(this);this.e=b;b=ra(this.e)&&1==this.e.nodeType?this.e:this.e?this.e.body:k;this.NO=!!b&&cg(b);this.TE=N(this.e,B?"DOMMouseScroll":"mousewheel",this)};y(Jx,Fd);
Jx.prototype.handleEvent=function(b){var c=0,d=0,e=0,b=b.Ub;if("mousewheel"==b.type){d=1;if(A||C&&(lb||Eb("532.0")))d=40;e=Kx(-b.wheelDelta,d);ka(b.wheelDeltaX)?(c=Kx(-b.wheelDeltaX,d),d=Kx(-b.wheelDeltaY,d)):d=e}else e=b.detail,100<e?e=3:-100>e&&(e=-3),ka(b.axis)&&b.axis===b.HORIZONTAL_AXIS?c=e:d=e;pa(this.gF)&&(c=Et(c,-this.gF,this.gF));pa(this.hF)&&(d=Et(d,-this.hF,this.hF));this.NO&&(c=-c);c=new Lx(e,b,c,d);this.dispatchEvent(c)};a.Kx=function(b,c){return C&&(kb||mb)&&0!=b%c?b:b/c};
Jx.prototype.p=function(){Jx.m.p.call(this);yd(this.TE);delete this.TE};a.Lx=function(b,c,d,e){c&&this.v(c,i);this.type="mousewheel";this.detail=b;this.Li=d;this.Mi=e};y(Lx,kd);a.Mx=function(){M.call(this)};y(Mx,Fd);t=Mx.prototype;t.Bc=0;t.to=0;t.ro=100;t.fl=0;t.ik=1;t.yE=m;t.ss=m;t.sa=function(b){b=Nx(this,b);this.Bc!=b&&(this.Bc=b+this.fl>this.ro?this.ro-this.fl:b<this.to?this.to:b,!this.yE&&!this.ss&&this.dispatchEvent("change"))};t.U=function(){return Nx(this,this.Bc)};t.ap=function(b){b=Nx(this,b);this.fl!=b&&(this.fl=0>b?0:this.Bc+b>this.ro?this.ro-this.Bc:b,!this.yE&&!this.ss&&this.dispatchEvent("change"))};
t.Mh=function(){return this.ik==k?this.fl:Math.round(this.fl/this.ik)*this.ik};t.Hc=function(){return Nx(this,this.to)};t.Tc=function(){return Nx(this,this.ro)};t.tw=p("ik");a.Nx=function(b,c){return b.ik==k?c:b.to+Math.round((c-b.to)/b.ik)*b.ik};a.Ox=function(b){T.call(this,b);this.mB=k;this.Ra=new Mx;N(this.Ra,"change",this.OD,m,this)};y(Ox,T);a.Px=Ed("dragvaluestart"),a.Qx=Ed("dragvalueend"),a.Rx=Ed("dragextentstart"),a.Sx=Ed("dragextentend"),a.Tx=Ed("dragstart"),a.Ux=Ed("dragend");t=Ox.prototype;t.zb="horizontal";t.Sr=m;t.BP=m;t.If=10;t.so=0;t.BE=j;t.fc=j;t.Ud=m;t.o=function(){Ox.m.o.call(this);var b=this.H().o("div",this.K(this.zb));this.ea(b)};
t.ea=function(b){Ox.m.ea.call(this,b);D.add(b,this.K(this.zb));var b=this.h(),c=Ub(k,"goog-slider-thumb",b)[0];c||(c=this.H().o("div","goog-slider-thumb"),Mc(c,Vc.Pp),b.appendChild(c));this.Ua=this.zd=c;Mc(this.h(),Vc.VI);Vx(this)};t.z=function(){Ox.m.z.call(this);this.je=new Wg(this.Ua);this.Sf=new Wg(this.zd);this.je.Of(this.Ud);this.Sf.Of(this.Ud);this.je.sv=this.Sf.sv=ha;this.nb=new um(this.h());Wx(this,j);this.h().tabIndex=0;Xx(this)};
a.Wx=function(b,c){c?(b.g().c(b.je,"beforedrag",b.pr).c(b.Sf,"beforedrag",b.pr).c(b.je,["start","end"],b.wr).c(b.Sf,["start","end"],b.wr).c(b.nb,"key",b.ff).c(b.h(),"mousedown",b.ej),b.BE&&Yx(b,j)):(b.g().Ba(b.je,"beforedrag",b.pr).Ba(b.Sf,"beforedrag",b.pr).Ba(b.je,["start","end"],b.wr).Ba(b.Sf,["start","end"],b.wr).Ba(b.nb,"key",b.ff).Ba(b.h(),"mousedown",b.ej),b.BE&&Yx(b,m))};t.ib=function(){Ox.m.ib.call(this);Sc(this.je,this.Sf,this.nb,this.Dj)};
t.pr=function(b){var c=b.Xq==this.je?this.Ua:this.zd,d;"vertical"==this.zb?(d=this.h().clientHeight-c.offsetHeight,d=(d-b.top)/d*(this.Tc()-this.Hc())+this.Hc()):d=b.left/(this.h().clientWidth-c.offsetWidth)*(this.Tc()-this.Hc())+this.Hc();d=b.Xq==this.je?Math.min(Math.max(d,this.Hc()),this.U()+this.Mh()):Math.min(Math.max(d,this.U()),this.Tc());Zx(this,c,d)};
t.wr=function(b){var c="start"==b.type;D.enable(this.h(),"goog-slider-dragging",c);D.enable(b.target.handle,"goog-slider-thumb-dragging",c);b=b.Xq==this.je;c?(this.dispatchEvent(Tx),this.dispatchEvent(b?Px:Rx)):(this.dispatchEvent(Ux),this.dispatchEvent(b?Qx:Sx))};
t.ff=function(b){var c=j;switch(b.keyCode){case 36:$x(this,this.Hc());break;case 35:$x(this,this.Tc());break;case 33:ay(this,this.If);break;case 34:ay(this,-this.If);break;case 37:var d=this.Ud&&this.Dd()?1:-1;ay(this,b.shiftKey?d*this.If:d*this.zp);break;case 40:ay(this,b.shiftKey?-this.If:-this.zp);break;case 39:d=this.Ud&&this.Dd()?-1:1;ay(this,b.shiftKey?d*this.If:d*this.zp);break;case 38:ay(this,b.shiftKey?this.If:this.zp);break;default:c=m}c&&b.preventDefault()};
t.ej=function(b){this.h().focus&&this.h().focus();var c=b.target;!sc(this.Ua,c)&&!sc(this.zd,c)&&(this.BP?$x(this,by(this,b)):(this.cA(b),this.Se=cy(this,by(this,b)),this.kE="vertical"==this.zb?this.ds<this.Se.offsetTop:this.ds>dy(this,this.Se)+this.Se.offsetWidth,b=Rb(this.h()),this.g().c(b,"mouseup",this.$z,j).c(this.h(),"mousemove",this.cA),this.Rh||(this.Rh=new Hd(200),this.g().c(this.Rh,Id,this.SD)),this.SD(),this.Rh.start()))};t.LD=function(b){ay(this,(0<b.detail?-1:1)*this.zp);b.preventDefault()};
t.SD=function(){var b;if("vertical"==this.zb){var c=this.ds,d=this.Se.offsetTop;this.kE?c<d&&(b=ey(this,this.Se)+this.If):c>d+this.Se.offsetHeight&&(b=ey(this,this.Se)-this.If)}else c=this.ds,d=dy(this,this.Se),this.kE?c>d+this.Se.offsetWidth&&(b=ey(this,this.Se)+this.If):c<d&&(b=ey(this,this.Se)-this.If);ka(b)&&Zx(this,this.Se,b)};t.$z=function(){this.Rh&&this.Rh.stop();var b=Rb(this.h());this.g().Ba(b,"mouseup",this.$z,j).Ba(this.h(),"mousemove",this.cA)};
a.fy=function(b,c){var d=hg(c,b.h());return"vertical"==b.zb?d.y:b.Ud&&b.Dd()?b.h().clientWidth-d.x:d.x};t.cA=function(b){this.ds=fy(this,b)};
a.by=function(b,c){var d=b.Hc(),e=b.Tc();if("vertical"==b.zb){var g=b.Ua.offsetHeight,h=b.h().clientHeight-g,g=fy(b,c)-g/2;return(e-d)*(h-g)/h+d}g=b.Ua.offsetWidth;h=b.h().clientWidth-g;g=fy(b,c)-g/2;return(e-d)*g/h+d},a.ey=function(b,c){if(c==b.Ua)return b.Ra.U();if(c==b.zd)return b.Ra.U()+b.Ra.Mh();f(Error("Illegal thumb element. Neither minThumb nor maxThumb"))},a.ay=function(b,c){var d=ey(b,b.Ua)+c,e=ey(b,b.zd)+c,d=Et(d,b.Hc(),b.Tc()-b.so),e=Et(e,b.Hc()+b.so,b.Tc());gy(b,d,e-d)},a.Zx=function(b,
c,d){var e=k;c==b.zd&&(d<=b.Ra.Tc()&&d>=b.Ra.U()+b.so)&&(e=d-b.Ra.U());var g=e||b.Ra.Mh();c==b.Ua&&(d>=b.Hc()&&d<=b.Ra.U()+g-b.so)&&(c=g-(d-b.Ra.U()),Nx(b.Ra,d)+Nx(b.Ra,c)==Nx(b.Ra,d+c)&&(gy(b,d,c),e=k));e!=k&&b.Ra.ap(e)},a.gy=function(b,c,d){b.Hc()<=c&&(c<=b.Tc()-d&&b.so<=d&&d<=b.Tc()-c)&&!(c==b.U()&&d==b.Mh())&&(b.Ra.ss=j,b.Ra.ap(0),b.Ra.sa(c),b.Ra.ap(d),b.Ra.ss=m,b.OD())};t.Hc=function(){return this.Ra.Hc()};t.Tc=function(){return this.Ra.Tc()};
a.cy=function(b,c){return c<=b.Ra.U()+b.Ra.Mh()/2?b.Ua:b.zd};t.OD=function(){Xx(this);Vx(this);this.dispatchEvent("change")};
a.Xx=function(b){if(b.Ua&&!b.Sr){var c=hy(b,ey(b,b.Ua)),d=hy(b,ey(b,b.zd));if("vertical"==b.zb)b.Ua.style.top=c.y+"px",b.zd.style.top=d.y+"px",b.Ob&&(c=iy(d.y,c.y,b.Ua.offsetHeight),b.Ob.style.top=c.offset+"px",b.Ob.style.height=c.size+"px");else{var e=b.Ud&&b.Dd()?"right":"left";b.Ua.style[e]=c.x+"px";b.zd.style[e]=d.x+"px";b.Ob&&(c=iy(c.x,d.x,b.Ua.offsetWidth),b.Ob.style[e]=c.offset+"px",b.Ob.style.width=c.size+"px")}}},a.iy=function(b,c,d){var e=Math.ceil(d/2);return{offset:b+e,size:Math.max(c-
b+d-2*e,0)}},a.hy=function(b,c){var d=new Mb;if(b.Ua){var e=b.Hc(),g=b.Tc(),g=c==e&&e==g?0:(c-e)/(g-e);"vertical"==b.zb?(e=b.h().clientHeight-b.Ua.offsetHeight,g=Math.round(g*e),d.x=dy(b,b.Ua),d.y=e-g):(e=Math.round(g*(b.h().clientWidth-b.Ua.offsetWidth)),d.x=e,d.y=b.Ua.offsetTop)}return d},a.$x=function(b,c){c=Et(c,b.Hc(),b.Tc());b.Sr&&b.Iq.stop(j);var d=new al,e,g=cy(b,c),h=b.U(),l=b.Mh(),n=ey(b,g),q=hy(b,n);e=b.tw();Math.abs(c-n)<e&&(c=Et(n+(c>n?e:-e),b.Hc(),b.Tc()));Zx(b,g,c);n=hy(b,ey(b,g));
e="vertical"==b.zb?[dy(b,g),n.y]:[n.x,g.offsetTop];q=new xt(g,[q.x,q.y],e,100);q.Of(b.Ud);d.add(q);if(b.Ob){var q=hy(b,h),r=hy(b,h+l),l=q;e=r;g==b.Ua?l=n:e=n;"vertical"==b.zb?(g=iy(r.y,q.y,b.Ua.offsetHeight),l=iy(e.y,l.y,b.Ua.offsetHeight),n=new xt(b.Ob,[dy(b,b.Ob),g.offset],[dy(b,b.Ob),l.offset],100),g=new vt(b.Ob,g.size,l.size,100)):(g=iy(q.x,r.x,b.Ua.offsetWidth),l=iy(l.x,e.x,b.Ua.offsetWidth),n=new xt(b.Ob,[g.offset,b.Ob.offsetTop],[l.offset,b.Ob.offsetTop],100),g=new wt(b.Ob,g.size,l.size,100));
n.Of(b.Ud);g.Of(b.Ud);d.add(n);d.add(g)}b.mB&&(h=b.mB.vX(h,c,100),z.forEach(h,function(b){d.add(b)}));b.Iq=d;b.g().c(d,"end",b.LL);b.Sr=j;d.play(m)};t.LL=function(){this.Sr=m};t.dp=function(b){if(this.zb!=b){var c=this.K(this.zb),d=this.K(b);this.zb=b;this.h()&&(D.qT(this.h(),c,d),b=this.Ud&&this.Dd()?"right":"left",this.Ua.style[b]=this.Ua.style.top="",this.zd.style[b]=this.zd.style.top="",this.Ob&&(this.Ob.style[b]=this.Ob.style.top="",this.Ob.style.width=this.Ob.style.height=""),Xx(this))}};
t.p=function(){Ox.m.p.call(this);this.Rh&&this.Rh.C();delete this.Rh;this.Iq&&this.Iq.C();delete this.Iq;delete this.Ua;delete this.zd;this.Ob&&delete this.Ob;this.Ra.C();delete this.Ra;this.nb&&(this.nb.C(),delete this.nb);this.Dj&&(this.Dj.C(),delete this.Dj);this.je&&(this.je.C(),delete this.je);this.Sf&&(this.Sf.C(),delete this.Sf)};t.zp=1;t.tw=function(){return this.Ra.tw()};t.U=function(){return this.Ra.U()};t.sa=function(b){Zx(this,this.Ua,b)};t.Mh=function(){return this.Ra.Mh()};
t.ap=function(b){Zx(this,this.zd,this.Ra.U()+b)};t.w=function(b){R(this.h(),b);b&&Xx(this)};a.Vx=function(b){var c=b.h();if(c){var d=b.Hc();Nc(c,Uc.bJ,d);d=b.Tc();Nc(c,Uc.aJ,d);b=b.U();Nc(c,Uc.cJ,b)}},a.Yx=function(b,c){c?(b.Dj||(b.Dj=new Jx(b.h())),b.g().c(b.Dj,"mousewheel",b.LD)):b.g().Ba(b.Dj,"mousewheel",b.LD)};t.gb=function(b){if(this.fc!=b&&this.dispatchEvent(b?"enable":"disable"))this.fc=b,Wx(this,b),b||this.$z(),D.enable(this.h(),"goog-slider-disabled",!b)};t.isEnabled=p("fc");
a.dy=function(b,c){return b.Ud?Vg(c):c.offsetLeft};a.jy=function(b){Ox.call(this,b);this.Ra.ap(0)};y(jy,Ox);jy.prototype.K=function(b){return"vertical"==b?"goog-slider-vertical":"goog-slider-horizontal"};a.ky=function(b){this.options=$.extend({},this.R,b)};y(ky,T);t=ky.prototype;t.R={iC:310,jC:310,sg:250,tg:250,qP:2,opacity:0.25,qZ:"#eee"};t.ea=function(b){ky.m.ea.call(this,b);this.src=this.e.src;this.options.src=this.src;this.options.Cm=(this.options.iC-this.options.sg)/2;this.options.Bm=(this.options.jC-this.options.tg)/2;this.Fq()};
t.Fq=function(){var b=this.options;this.HA=$(tk('            <div class="avatar-editor-container" style="width:<%=containerWidth%>px">              <div class="avatar-editor-container-inner" style="height:<%=containerHeight%>px;">                <div class="avatar-editor-window" style="height:<%=windowHeight%>px;width:<%=windowWidth%>px;margin:<%=windowMarginTop%>px <%=windowMarginLeft%>px;">                  <div class="avatar-editor-window-shadow" style="height:<%=windowHeight%>px;width:<%=windowWidth%>px;"></div>                  <div class="avatar-editor-window-inner" style="width:<%=containerWidth%>px; height:<%=containerHeight%>px;margin:-<%=windowMarginTop%>px 0 0 -<%=windowMarginLeft%>px;">                    <img class="inner" title="拖动相片"/>                  </div>                </div>                <img class="outer" style="opacity:<%=opacity%>;"/>              </div>              <div class="goog-slider-wrap">                  <i class="zg-icon image-minus"></i>                  <i class="zg-icon image-plus"></i>                  <div class="goog-slider">                      <div class="line"></div>                      <div class="goog-slider-thumb"></div>                  </div>              </div>            </div>',{containerWidth:b.jC,
containerHeight:b.iC,windowHeight:b.sg,windowWidth:b.tg,windowMarginTop:b.Cm,windowMarginLeft:b.Bm,src:b.src,opacity:b.opacity}));this.dc=this.HA[0];this.HA.insertBefore(this.e);R(this.e,m);this.WK=J("avatar-editor-container-inner",this.dc);this.Gr=J("outer",this.dc);this.gx=J("inner",this.dc);this.Em=$(this.Gr);this.Zt=$(this.gx);this.hE=0;this.Em.load(v(this.SH,this));this.Zt.load(v(this.SH,this));this.gx.src=this.Gr.src=this.options.src;this.bT=J("goog-slider",this.dc)};
t.z=function(){this.Tz=new jy;this.Tz.n(this.bT);this.g().c(this.WK,["mousedown","touchstart"],function(b){var c=new Wg(this.dc);c.addEventListener("drag",v(function(b){var c=this.zoom;this.Le={Fp:this.options.tg/c,Gn:this.options.sg/c,x:(this.options.Bm-(this.qE.left+(b.clientX-this.vt)))/c,y:(this.options.Cm-(this.qE.top+(b.clientY-this.wt)))/c};my(this)},this));c.addEventListener("end",v(function(){c.C()},this));c.vm(b);this.vm(b)});this.g().c(this.dc,["touchmove"],function(b){b.stopPropagation();
b.preventDefault()});this.g().c(this.Tz,"change",function(){var b=this.Tz.U(),c=this.qI;ny(this,(this.wU-c)*b/100+c)})};a.ny=function(b,c){b.mY=b.zoom;b.zoom=c;oy(b,b.Le.Fp/2+b.Le.x,b.Le.Gn/2+b.Le.y)},a.oy=function(b,c,d){var e=b.zoom;b.Le={Fp:b.options.tg/e,Gn:b.options.sg/e,x:c-b.options.tg/e/2,y:d-b.options.sg/e/2};my(b)};t.SH=function(){this.lO||(this.gx.complete&&this.Gr.complete?this.v():(this.hE++,2<=this.hE&&this.v()))};
t.v=function(){this.Fr=this.Em.width();this.Er=this.Em.height();var b=this.options.tg/this.Fr,c=this.options.sg/this.Er;this.qI=b=c>b?c:b;this.wU=this.qI*this.options.qP;this.Le={Gn:this.options.tg/b,Fp:this.options.sg/b,x:0,y:0};ny(this,b);oy(this,this.Fr/2,this.Er/2);this.lO=j};t.vm=function(b){this.vt=b.clientX;this.wt=b.clientY;this.qE=this.Zt.position();this.FY=this.Em.position()};
a.my=function(b){var c=b.zoom,d=Et(b.options.Bm-b.Le.x*c,b.options.tg+b.options.Bm-b.Fr*c,b.options.Bm),e=Et(b.options.Cm-b.Le.y*c,b.options.sg+b.options.Cm-b.Er*c,b.options.Cm),g={width:c*b.Fr,height:c*b.Er,left:d,top:e};b.Em.css(g);b.Zt.css(g);b.Le.x=(b.options.Bm-d)/c;b.Le.y=(b.options.Cm-e)/c};t.support=function(){return"getContext"in document.createElement("canvas")&&m};a.qy=function(b){M.call(this);this.Gm=b||py};y(qy,T);a.py="people";t=qy.prototype;t.ea=function(b){this.e=b;S.Ma()&&(S.Ld||"people"===this.Gm)?this.o():$(b).click($.proxy(this.rP,this))};
t.o=function(){this.wk=$(tk('            <form target="av_up_frame" style="display:none;" method="post" enctype="multipart/form-data" action="<%=uploadAction%>">                <label for="avt_file"></label>                <input type="file" name="picture" id="avt_file" />                <input type="hidden" name="handle_mode" value="server1" />            </form>',{uploadAction:"/upload"}));this.tI=$('<iframe id="av_up_frame" src="about:_blank" name="av_up_frame" style="position: absolute; height: 0px; width: 0px; left: -9000px;"></iframe>');
this.tI.appendTo(document.body);this.input=this.wk.find("input[type=file]")[0];!$.browser.msie&&!$.browser.safari&&!Bg.vc&&!Bg.iY?(this.wk.insertAfter(this.e),$(this.e).click($.proxy(function(){$(this.input).trigger("click")},this))):(this.wk.find("label").html($(this.e).html()),this.e.innerHTML="",$(this.e).append(this.wk),this.wk.addClass("avatar-editor-form-ie"));this.g().c(this.input,"change",this.zs)};t.z=function(){qy.m.z.call(this)};
t.rP=function(){return S.Ma()&&!S.Ld&&"people"!==this.Gm?(Vn.D().w(j),m):!S.Ma()?(nk.D().w(j),m):j};
t.zs=function(b){b=this.input=b.target;this.Bl=this.ex=this.lj="";if(this.ab)this.ab.na();else{this.ab=new vi(k,m);this.ab.Xa(this.Gm===py?"修改头像":"修改话题图片");var c=Jh.TA,d=Jh.cB,e=new Bh;e.set(c,"取消",m,j).set(d,"确定",j);Fh(this.ab,e);this.g().c(this.ab,Gh,function(b){this.dm();if("yes"===b.key){if(this.ln.support()){var c=this.ln,b=$("<canvas>",{width:c.options.tg,height:c.options.sg}),d=b[0];$(document.body).append(d);var e=b[0].getContext("2d"),q=c.Le;e.drawImage(c.Gr,q.x,q.y,q.Fp,q.Gn,0,0,c.options.tg,
c.options.sg);c=d.toDataURL("image/png");b.remove();b=c}else b=this.ln.Le;this.lj=b;ry(this);this.ab.w(m);return m}})}d=this.ab.Y();c=$("<div class='new-avatar-editor-loading'><div><span></span></div><div>正在上传...</div></div>");d=$(d);d.html("");d.append(c);this.ab.w(j);D.add(this.ab.e,"avatar-edit-dialog");window.FileReader&&(b.files&&b.files[0])&&(this.file=b=b.files[0],c=new window.FileReader,c.onload=v(function(b){this.Bl=b.target.result;this.Ho()},this),c.readAsDataURL(b));this.g().c(W,"iframe_data",
function(b){(b=b.sb)&&!b.r?(this.Bl=b.data.pic_url,this.ex=b.data.hashval,window.FileReader||this.Ho(),ry(this)):U(b.msg);this.dm()});this.wk[0].submit()};t.Ho=function(){var b=this.ab.Y();this.dx=new Image;this.dx.src=this.Bl;b=$(b);b.html("");b.append(this.dx);this.ln=new ky;this.ln.n(this.dx)};
t.dm=function(){if(!$.browser.msie){var b=$(this.input);this.input=b.val("").clone(j)[0];b.replaceWith(this.input);this.g().c(this.input,"change",this.zs);$(this.e).unbind("click").click($.proxy(function(){$(this.input).trigger("click")},this))}};
a.ry=function(b){if(b.ex&&b.lj){b.dispatchEvent("beforepost");var c={type:b.Gm===py?"1":"2",dest_id:b.Gm===py?S[3]:Eg[0][3],return_size:"l"},c=b.ln.support()?$.extend(c,{handle_mode:"client",pic_body:b.lj.replace(/data\:image\/\w{3,4};base64,/,""),fileName:b.file.name}):$.extend(c,{handle_mode:"server2",x:parseInt(b.lj.x,10),y:parseInt(b.lj.y,10),height:parseInt(b.lj.Gn,10),width:parseInt(b.lj.Fp,10),hashval:b.ex});$.post("/upload",c,$.proxy(function(b){b&&!b.r?this.data=b.msg:U(b.msg);this.dispatchEvent({type:"success",
src:this.data});this.ab.w(m)},b),"json")}};t.getData=function(){return!this.data?k:/(\w*)_\w/.exec(this.data)[1]};a.sy=function(){};y(sy,T);t=sy.prototype;
t.ea=function(b){sy.m.ea.call(this,b);if(b=J("profile-edit-avatar-btn"))this.Qm=new qy,this.Qm.n(b),this.g().c(this.Qm,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))}),this.g().c(this.Qm,"success",function(b){$("img.zm-avatar-editor-preview").attr("src",b.src);$(".avatar-edit-preview-loading").remove()});this.J=[];var c=this;$(".editable-group",this.e).each(function(){var b=new ir;c.J.push(b);b.n(this)});b=
H("zm-profile-edit-submit");this.g().c(b,"click",this.By);(new Gx).n(this.e);$(this.e).on("change","input, textarea, select",function(){c.Qd()})};
t.z=function(){sy.m.z.call(this);var b=H("zm-profile-progress-anim"),c=new ty;c.addEventListener("update",function(){var d=100*c.U()|0;10>d&&(d=10);b.style.width=b.innerHTML=d+"%"});z.forEach(this.J,function(b,d){c.watch({name:"name"+d,target:b,Ih:["add","remove"],Bh:function(){return!!b.ud.children().length}})},this);var d=this.e,e=H("zm-profile-edit-male"),g=H("zm-profile-edit-female"),h=H("zm-profile-edit-description"),l=$(".business-selection select")[0],n=H("zm-profile-edit-expert-disable");
c.watch({name:"expert_progress",target:H("zm-profile-edit-expert-enable"),Ih:["change"],Bh:function(){return k!==Ex(d,"enable_expert")}}).watch({name:"expert_progress",target:n,Ih:["change"],Bh:function(){return k!==Ex(d,"enable_expert")}}).watch({name:"gender_progress",target:e,Ih:["change"],Bh:function(){return k!==Ex(d,"gender")}}).watch({name:"gender_progress",target:g,Ih:["change"],Bh:function(){return k!==Ex(d,"gender")}}).watch({name:"desc_progress",target:h,Ih:["blur"],Bh:function(){return!!Ka(h.value)}}).watch({name:"business_progress",
target:h,Ih:["blur"],Bh:function(){return!!Ka(h.value)}}).watch({name:"headline_progress",target:l,Ih:["blur"],Bh:function(){return!!Ka(l.value)}})};t.Qd=function(){$(window).on("beforeunload.profileedit",v(s("你的更改还未保存，确认离开该页面吗？"),this))};t.ye=function(){$(window).off("beforeunload.profileedit")};
t.By=function(){function b(b){U(b)}var c=$("#zm-profile-edit-male").is(":checked")?1:0,d=$("#zm-profile-edit-headline").val(),e=$("#zm-profile-edit-description").val(),g=$(".business-selection select").val(),h=[];$("#zm-profile-edit-loc-container").children().each(function(){h.push($(this).data("title"))});var l=[];$("#zm-profile-edit-co-container").children().each(function(){var b=$(this);l.push([b.data("title"),b.data("sub-title")||""])});var n=[];$("#zm-profile-edit-edu-container").children().each(function(){var b=
$(this);n.push([b.data("title"),b.data("sub-title")||""])});var q=$("#zm-profile-edit-weibo-enable").is(":checked")?1:0,r=$("#zm-profile-edit-expert-enable").is(":checked")?1:0,c=F.filter({avatar_path:this.Qm?this.Qm.getData():k,gender:c,headline:d,description:e,location:h,business:g,employment:l,education:n,enable_weibo:q,enable_expert:r},gs),x=v(function(){this.ye();window.location.href="/people/"+S[1]+"/about"},this),d=new V(j);d.addEventListener("complete",function(){var c;try{c=Ge(this)}catch(d){}c&&
!c.r&&qa(x)?x.call(this,c):qa(b)&&U(c.msg&&c.msg[0][1])});d.ajax("/people/edit","data="+encodeURIComponent(Zc(c)))};a.ty=function(){this.Oy={}};y(ty,Fd);ty.prototype.update=function(b,c){this.Oy[b]=c;this.dispatchEvent({type:"update"});return this};ty.prototype.watch=function(b){var c=v(function(){this.update(b.name,b.Bh())},this);N(b.target,b.Ih,c);c();return this};ty.prototype.U=function(){var b=F.Fa(this.Oy);return b.length&&z.filter(b,Boolean).length/b.length};a.uy=function(){this.Ri="editing";T.call(this)};y(uy,T);uy.prototype.ea=function(b){uy.m.ea.call(this,b);this.G=$(b);this.G.on("click",'a[href^="javascript"]',$.proxy(this.fa,this));this.G.on("click",'a[href^="javascript"], input',m);this.G.on("click",".item",$.proxy(this.gR,this))};a.vy=function(b,c,d){if(!Bg.vc||navigator.userAgent.match(/iPad/i)!=k)b=$(".item",b.G).index(c),c.siblings().eq(b-b%2).height(d?"auto":c.height())};
uy.prototype.gR=function(b){var c=$(b.currentTarget),d=c.data("href"),b=b.metaKey||b.ctrlKey;d&&!c.hasClass(this.Ri)&&(b?window.open(d):location.href=d)};
uy.prototype.fa=function(b){var c=$(b.currentTarget),d=c.closest(".item"),b=c.attr("name");if("edit"===b)c.closest(".description").hide().siblings(".description-edit").show().find("input").focus().closest(".item").addClass(this.Ri).closest(".skilled-topics").addClass(this.Ri),vy(this,d);else if("cancel"===b)c.closest(".description-edit").hide().siblings(".description").show().closest(".item").removeClass(this.Ri).closest(".skilled-topics").removeClass(this.Ri),vy(this,d,j);else if("save"===b){var e=
new V(j);this.g().c(e,"success",function(){var b=Ge(e);b.r?U(b.msg):(c.closest(".description-edit").hide().siblings(".description").show().children(".des").text(b.msg).siblings(".edit").addClass("zu-edit-button").children(".edit-msg").html("修改").closest(".item").removeClass(this.Ri).closest(".skilled-topics").removeClass(this.Ri),vy(this,d,j))});e.ajax("/topic/bio/update","tid="+c.closest(".item").data("id")+"&bio="+c.parent().siblings("input").val(),"POST")}};a.wy=function(){};y(wy,T);
wy.prototype.ea=function(b){wy.m.ea.call(this);if(b&&(this.G=$(b),$(".editable-group",this.G).each(function(){(new xy).n(this)}),(b=H("profile-header-description-input"))&&new fm(b),b=J("zm-entry-head-avatar-edit-button"))){var c=new qy(py);c.n(b);this.g().c(c,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.g().c(c,"success",function(b){b.src&&(J("zm-avatar-editor-preview").src=b.src,et("ProfileHeaderV2",
"save",{data:{avatar_path:c.getData()}},function(){$(".avatar-edit-preview-loading").remove()}))})}};a.xy=function(){};y(xy,T);t=xy.prototype;t.ea=function(b){xy.m.ea.call(this);this.G=$(b);this.me=$(".info-wrap",this.G);this.Kd=$(".edit-wrap",this.G);this.PA=$(".title",this.me);this.Lp=$("input",this.Kd)};
t.z=function(){xy.m.z.call(this);this.G.on("click","[name='edit']",$.proxy(function(){this.G.addClass("editing");var b=this.Kd.find("input").get(0);b?b.focus():(b=this.Kd.find("textarea").get(0))&&b.focus()},this));var b=this;this.Vp=[];$("input[type=text]",this.G).each(function(){var c=new jr("/topic/autocomplete",this,$(this).parents(".topic-input-wrap")[0]);b.Vp.push(c)});this.Kd.on("keydown","input",function(b){13===b.keyCode&&setTimeout(function(){var c=$(b.target),g=c.parents(".edit-wrap").children().index(c.parent()),
h=c.parents(".edit-wrap").find("input, select").get(g+1),g=c.parents(".edit-wrap").find("input, select").get(g-1);c.val()&&(h?h.focus():g&&!$(g).val()&&g.focus())})});this.Kd.on("click","[name='cancel'], [name='save']",$.proxy(function(b){b=b.target.name;"cancel"===b?this.cancel():"save"===b&&this.save()},this));var c=$(".fold-wrap");c.click(function(b){"fold"===b.target.name?c.addClass("fold"):"unfold"===b.target.name&&c.removeClass("fold")})};
t.save=function(){var b=this.G.data("name");if("location"===b){var b=this.Kd.find("input.location"),c=this.Kd.find("select"),d=this.Kd.find("input.male").is(":checked")?1:0;et("ProfileHeaderV2","save",{data:{location:[b.val()],business:c.val(),gender:d}},function(b){b=b.msg;b.location[0].html||(b.location[0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写居住地</a>");b.business.html||(b.business.html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写行业</a>");
this.me.find("span.location").attr("title",b.location[0].text).html(b.location[0].html);this.me.find("span.business").attr("title",b.business.text).html(b.business.html);this.me.find("i.gender").removeClass("male female").addClass(1===parseInt(b.gender,10)?"male":"female");this.cancel()},this.Zh,this)}else"employment"===b?(c=this.Kd.find("input.employment"),b=this.Kd.find("input.position"),c=c.val(),b=b.val(),et("ProfileHeaderV2","save",{data:{employment:[[c,b]]}},function(b){b=b.msg;!b.employment[0][0].text&&
!b.employment[0][1].text?this.G.addClass("empty"):this.G.removeClass("empty");b.employment[0][0].html||(b.employment[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写公司信息</a>");b.employment[0][1].html||(b.employment[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写职位</a>");this.me.find(".employment").attr("title",b.employment[0][0].text).html(b.employment[0][0].html);this.me.find(".position").attr("title",b.employment[0][1].text).html(b.employment[0][1].html);
this.cancel()},this.Zh,this)):"education"===b?(c=[this.Kd.find("input.education"),this.Kd.find("input.education-extra")],b=c[0].val(),c=c[1].val(),et("ProfileHeaderV2","save",{data:{education:[[b,c]]}},function(b){b=b.msg;!b.education[0][0].text&&!b.education[0][1].text?this.G.addClass("empty"):this.G.removeClass("empty");b.education[0][0].html||(b.education[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写学校信息</a>");b.education[0][1].html||(b.education[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写专业</a>");
this.me.find(".education").attr("title",b.education[0][0].text).html(b.education[0][0].html);this.me.find(".education-extra").attr("title",b.education[0][1].text).html(b.education[0][1].html);this.cancel()},this.Zh,this)):"description"===b&&(b=this.Kd.find("textarea.description"),et("ProfileHeaderV2","save",{data:{description:b.val()}},function(b){b=b.msg;b.description.text?this.G.removeClass("empty"):(b.description.fold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",
b.description.unfold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",this.G.addClass("empty"));this.me.find(".fold-item .content").empty().html(b.description.fold_html);this.me.find(".unfold-item .content").html(b.description.unfold_html);b.description.shortened?this.me.removeClass("disable-fold"):this.me.addClass("disable-fold");this.cancel()},this.Zh,this))};t.Zh=function(b){U(b.msg[0][1])};t.cancel=function(){this.G.removeClass("editing")};a.yy=function(){M.call(this);this.Rg="zm-item";this.jX="zm-item-top-btn";this.uS=j};y(yy,Hk);t=yy.prototype;t.v=function(b){this.dc=b;this.g().c(b,"click",this.fa);this.refresh()};t.wf=ca("Rg");
t.fa=function(b){if(b.target){var c=kk(this.dc,b.target);c&&(this.type=c.getAttribute("data-type"),this.id=c.getAttribute("data-id"),this.action=c.name,this.item=Ic(b.target,k,this.Rg),this.type&&(this.id&&this.action&&this.item)&&(this.pI||(this.pI=j,this.xhr=new V(j),this.g().c(this.xhr,"complete",this.of),this.xhr.ajax("/people/"+("top"===this.action?"pin":"unpin")+"_"+this.type,this.type+"_id="+this.id,"POST")),this.hX=c))}};
t.of=function(){if("cancel-top"===this.action)Zj(this.item,j);else if("top"===this.action){var b=Vb(this.Rg,this.dc);this.KY=bg(this.item).y;b&&2<=b.length&&jc(L(this.item),J(this.Rg,this.dc));this.scroll();gk(this.item);R(J("zm-item-top-btn-top",this.item),m);R(J("zm-item-top-btn-cancel",this.item),j);this.refresh()}this.pI=m};t.scroll=function(){if(this.uS){var b=J("zm-profile-section-wrap"),c=Lc(Sb((fa||window).document)).y;b&&0>bg(b).y-c&&b.scrollIntoView()}};
t.refresh=function(){var b=Vb(this.Rg,this.dc);b&&0<b.length&&z.forEach(b,function(b,d){if(0!==d){var e=J("zm-item-top-btn-top",b);e&&R(e,j)}},this)};a.zy=function(b,c){b.g().c(c,"next",b.refresh)};a.Ay=function(){this.aw=["zg-btn-follow","zg-btn-unfollow"];this.bw="people"};y(Ay,T);Ay.prototype.z=function(){this.g().c(this.e,"click",this.fa)};Ay.prototype.fa=function(b){var c=kk(this.e,b.target);this.zh&&this.zh(c);c&&(c.name&&"focus"===c.name)&&ok(c,this.bw,function(){c.getAttribute("data-focusme")&&(D.has(c,"zg-btn-follow")?c.setAttribute("data-tip","s$b$对方已关注你"):c.setAttribute("data-tip","s$b$已互相关注"))},this.aw,{MX:"question"===this.bw?"关注问题":k})};Ay.prototype.km=ca("zh");a.Cy=function(b,c,d,e){M.call(this);this.Pd=b;this.Gh=c;this.eg=d;this.OC=e||By;b.maxLength=d;this.rj=new pu(b);N(this.rj,"input",this.Bo,m,this);this.Di()};y(Cy,Fd);a.By=0;Cy.prototype.Bo=function(){this.Di()};Cy.prototype.Di=function(){var b=this.Pd.value.length;if(b>this.eg){var c=this.Pd.scrollTop,d=this.Pd.scrollLeft;this.Pd.value=this.Pd.value.substring(0,this.eg);b=this.eg;this.Pd.scrollTop=c;this.Pd.scrollLeft=d}this.Gh&&xc(this.Gh,1==this.OC?b:this.eg-b)};
Cy.prototype.p=function(){Cy.m.p.call(this);delete this.Pd;this.rj.C();this.rj=k};a.Dy={},a.Dy=function(){M.call(this)};y(Dy,Hk);Dy.hu=[["需要详细阐述","答案过于简短或表述不清晰，请完善答案。"],["答非所问","没有正面或直接回答问题，请修改答案。"],["应作为问题的评论","该内容是对问题本身的评论而不是回答，请改为发布到评论。"],["应作为答案的评论","该内容是对另外一个答案的评论或回应，而不是回答问题，请改为发布到评论。"],["内容重复","与已有答案重复，请修改答案。"],["内容已过期","答案的时效性已过，请更新答案。"],["需要注明关联利益","有广告、推销嫌疑，请注明作者与利益方的关系。"]];Dy.sj=k;Dy.D=function(){Dy.sj||(Dy.sj=new Dy,Dy.sj.v());return Dy.sj};t=Dy.prototype;t.v=function(){this.e||(this.o(),this.Ha(),this.ox())};t.Ha=function(){this.g().c(this.e,"click",this.JQ)};
t.JQ=function(b){"A"===b.target.tagName&&(b=b.target.getAttribute("data-index"),this.eL.LX(b),this.Ry.w(m))};t.ox=function(){var b=new nl(this.e);qh(b);b.$D=j;b.Zo(j);b.w(m);b.Sy=0;b.Q()&&b.na();$r(b,new Mf(13,0,0,-22));this.Ry=b};
t.o=function(){var b=K("div",{id:"zh-answer-flag-popup","class":"zg-r5px zu-hovercard-wrap"},[K("div","zg-r5px zu-hovercard-inner",[K("div",{id:"zh-answer-flag-popup-header"},[K("a",{"class":"zg-right",href:"http://www.zhihu.com/question/19867017",target:"_blank"},"这是什么？"),"选择一个理由："]),this.eG=K("div",{id:"zh-answer-flog-options-wrap"})]),K("div","zu-hovercard-spin-top")]);z.forEach(Dy.hu,function(b,d){var e=K("a",{href:"javascript:;","class":"zm-menu-item-link"},b[0]);e.setAttribute("data-index",
d);this.eG.appendChild(e)},this);document.body.appendChild(b);this.e=b};t.show=function(b,c){this.Ry.$c(new ll(b,1));var d=c.SX(),e=Vb("zm-menu-item-link",this.eG);z.forEach(e,function(b,c){R(b,!z.contains(d,c))},this);this.Ry.w(j);this.eL=c};a.Ey=function(){M.call(this)},a.Fy=void 0;y(Ey,Hk);
Ey.prototype.v=function(){this.o();this.g().c(this.hl,"change",function(){var b=this.hl.value;this.Zg.value="no"===b?"":Dy.hu[+b][1]}).c(this.Ei,"click",function(b){"cancel"===b.target.name?this.S.w(m):this.Zg.value&&"no"!==this.hl.value&&(this.Xv=new V(j),this.g().c(this.Xv,"complete",function(){var b=Ge(this.Xv);b&&!b.r?(this.Oa.innerHTML="已经标记",this.S.w(m)):U(b.msg)}),b=ak(this.Zg.value),this.Xv.ajax("/answer/flag","answer_id="+this.eJ+"&flag="+this.hl.value+"&reason="+encodeURIComponent(b)))})};
Ey.prototype.o=function(){this.e=K("div",k,[K("div","zg-section",[K("div",k,"标记："),this.hl=K("select")]),K("div",k,[K("div",k,"原因"),this.Zg=K("textarea",{style:"width:96%;border:solid 1px #666;height:66px;padding:5px"})]),this.Ei=K("div","zm-command",[K("a",{"class":"zg-mr10",href:"javascript:void(0);",name:"cancel"},"取消"),K("a",{"class":"zg-btn-blue",href:"javascript:void(0);",name:"confirm"},"确定")])]);this.hl.appendChild(K("option",{value:"no"},"选择标记原因"));z.forEach(Dy.hu,function(b,c){this.hl.appendChild(K("option",
{value:c},b[0]))},this);this.S=new vi(k,m);this.S.Xa("标记答案");Fh(this.S,k);this.S.Y().appendChild(this.e)};Ey.prototype.show=function(){this.S.w(j)};a.Gy=function(b){M.call(this);this.S=k;this.V=b;this.ft=0;this.vG=""},a.Hy=void 0;y(Gy,Hk);t=Gy.prototype;t.v=function(){this.Sh||(this.Sh=j,this.o(),this.Ha())};t.Ha=function(){A||(new Nl("搜索问题")).n(this.xc);this.J=new an("/redirect-question/autocomplete",this.xc,k,k,H("zh-question-redirect-diag-content"),m);this.J.Om=m;this.J.yf(j);this.g().c(this.J,km.qh.vi,yk);this.g().c(this.J,"select",this.LQ).c(this.mK,"click",function(){this.S.w(m)})};
t.LQ=function(){var b=this.J.Xf();this.xc.value="";var c=b[3],b=b[1];this.S.w(m);this.xc.value="";this.xhr=new V(j);P(this.g(),this.xhr,"complete",this.DJ);this.xhr.ajax("/question/redirect","qid="+this.V+"&rqid="+c);this.ft=c;this.vG=b};t.DJ=function(){var b=Ge(this.xhr);b&&(b.r?U(b.msg):this.Oa?(this.Oa.innerHTML="已经重定向",this.Oa.setAttribute("data-disabled",1)):this.dispatchEvent("change"))};
t.o=function(){this.e=K("div",{id:"zh-question-redirect-diag"},["将问题跳转至",K("div",{id:"zh-question-redirect-diag-content"},this.xc=K("input",{type:"text","class":"zg-form-text-input"})),K("div","zm-command",this.mK=K("a",{href:"javascript:;","class":"zm-command-cancel",name:"cancel"},"放弃操作"))]);this.S=new vi(k,m);this.S.Xa("问题重定向");Fh(this.S,k);this.S.Y().appendChild(this.e)};t.show=function(){this.v();this.S.w(j)};a.Iy=function(b){var c=b&&b.name;if(c)switch(c){case "adminflag":Fy||(Fy=new Ey,Fy.v());c=Fy;c.Oa=b;c.eJ=b.id.split("-")[1];c.show();break;case "redirect":case "cancel_redirect":if(!b.getAttribute("data-disabled")){var d;Hy||(Hy=new Gy,Hy.v());d=Hy;d.Oa=b;d.V=b.id.split("-")[1];"redirect"===c?d.show():(Ci("/question/unredirect",k,"POST","qid="+d.V+"&rqid="+d.ft),d.Oa.innerHTML="重定向已撤销",d.Oa.setAttribute("data-disabled",1))}break;case "revert":var e=Ai("撤销",'<div class="zg-form-text-input"><textarea class="zg-editor-input content" title="请输入撤销原因" placeholder="请输入撤销原因"></textarea></div>',
function(c){if(c){var c=g.value,d=b.getAttribute("id").split("-")[1],c=(new Qi).add("revision",d).add("reason",c),n=new V(j);n.on("success",function(){var b=Ge(n);b.r?U(b.msg):(e.w(m),b.msg?window.location.href=b.msg:location.reload())});n.ajax("/revert",c.toString());return m}}),g=J("content",e.Y());new Rm(g);new fm(g,48);new Cy(g,k,200)}},a.Jy=function(b){$(b).on("click",'a[name="revert"]',function(){Iy(this)})};a.Ky=function(){T.call(this)};y(Ky,T);t=Ky.prototype;t.v=function(){Ar.M(this);this.n(document.body)};
t.z=function(){Ky.m.z.call(this);var b=J("zm-profile-header-operation");b&&(new Ay).n(b);(b=J("zm-profile-header"))&&(new wy).n(b);(b=H("zh-profile-ask-wrap"))&&(new Bn(b,"question",["zg-follow","zg-unfollow"],["关注问题","取消关注"])).v();(b=H("zh-profile-activity-wrap"))&&this.g().c(b,"click",function(b){if((b=b.target)&&"focus"===b.name){var c=b.getAttribute("data-type");ok(b,c,k,["zm-profile-follow-link-gray","zm-profile-unfollow-link-gray"])}});(this.cw=b=H("zh-profile-page-force-to-rename"))&&this.g().c(b,
"click",this.JT);this.px();if(b=H("zh-profile-activity-page-list"))b=new Ax(b,"/people/"+Fg[1]+"/activities",j),this.M(b),this.g().c(b,"click!",function(b){"comment"===b.namespace&&b.bd.fill("category","profile").fill("label","profile_feed")}),b.wf("zm-profile-section-item"),b.Pt=m,b.Mt=m,b.v();(b=J("zm-profile-fav-wrap"))&&this.g().c(b,"click",this.QL);(b=H("zm-profile-details-editform"))&&(new sy).n(b);if(b=J("zm-profile-answer-sort"))this.vh=new iu,this.vh.Da(this.RJ=new fu("按时间排序")),this.vh.Da(this.SJ=
new fu("按投票排序")),this.vh.Da(this.QJ=new fu("问"+S[0]+"的问题")),this.vh.W(b),this.vh.w(m),this.g().c(b,"click",function(b){this.vh.w(j);b.stopPropagation();P(this.g(),document,"click",function(){this.vh.w(m)})}),this.g().c(this.vh,"action",this.wN);(b=H("zh-profile-edit-expert"))&&(new Ly).n(b);var c=J("profile-expert-tip");c&&this.g().c(c,"click",function(b){var d=b.target;("enable"===d.name||"close"===d.name)&&et("ProfileExpertTopicsV2",d.name,k,function(){"enable"===d.name?location.reload():Zj(c,j)})});
$(".zm-profile-section-wrap.skilled-topics").each(function(){(new uy).n(this)});$(".zm-profile-module.skilled-topics").each(function(){(new uy).n(this)});$(".zm-profile-module.active-topics").each(function(){(new uy).n(this)});var d=H("zh-profile-ask-list");if(d&&(b=new Qt({Ya:["autoload","locationSource"]}),this.M(b),b.n(d),d=J("zm-profile-section-list"))){var e=new yy;e.wf("zm-profile-section-item");zy(e,b);e.v(d)}if(d=$("#zh-profile-answer-list").children().get(0))if(b=new Qt,this.M(b),b.Ya("nodeSource").Ya("childConstructor",
{Eh:zx}),b.n(d),this.g().c(b,"click!",function(b){"comment"===b.namespace&&b.bd.fill("category","profile").fill("label","profile_answers_list")}),d=J("zm-profile-section-list"))e=new yy,zy(e,b),e.v(d);if(b=$("#zh-profile-log-list").get(0))d=new Qt,d.Ya("locationSource",{Gs:j}),this.M(d),d.n(b),Jy(b);if(d=H("zh-profile-topic-list"))if(b=new Qt({Ya:["autoload","locationSource"]}),this.M(b),this.g().c(b,"itemcreated",function(b){var b=b.item,c=b.getAttribute("data-tid").split("-")[1];if(S[3]===Fg[3]){var d=
new cq(j,"/topic/bio/update","bio");d.Ot=j;d.de=["tid="+c];d.Ab='<a href="javascript:;" name="edit">添加你在该话题的经验</a>';d.n(b)}}),b.n(d),d=J("zm-profile-section-list"))e=new yy,e.wf("zm-profile-section-item"),zy(e,b),e.v(d);if(b=$("#zh-profile-follows-list > .zh-general-list").get(0))d=new Qt({Ya:["nodeSource"]}),this.M(d),d.n(b);if(b=$("#zh-profile-follows-list-old").get(0))d=new Qt({Ya:["locationSource"]}),this.M(d),d.n(b);if(b=$("#zh-profile-fav-list > .zh-general-list").get(0))d=new Qt({Ya:["autoload",
"nodeSource"]}),this.M(d),d.n(b);this.Vn();-1<location.search.indexOf("clean-followers-noti=1")&&(new V(j)).ajax("/notification/clear","no_refresh_content=true&type=follow");$("#__signin").click(function(){var b=nk.D();vr(b,m);b.w(j)})};t.JT=function(){Ai("确定","确定要强制此用户改名吗？",function(b){b&&(H("realname_form").submit(),this.cw.innerHTML="已发送",D.add(this.cw,"zg-gray"),Ad(this.cw))},this)};
t.Vn=function(){var b=H("zh-profile-following-topic");b&&(new Bn(b,"topic",["zm-profile-follow-link-gray","zm-profile-unfollow-link-gray"])).v();this.qj();var c=H("zm-profile-header-pm-btn");c&&N(c,"click",function(b){b.preventDefault();S.Ma()?(b=new bn(k,j),b.show(),gn(b,Fg[3],Fg[0]),en(b,c.href),b.Fb.focus()):(b=nk.D(),vr(b,m),b.w(j))});(b=H("zh-profile-cancel-block"))&&this.g().c(b,"click",this.IF);(b=H("zh-report-people"))&&this.g().c(b,"click",this.NG);(b=H("zh-profile-search-query-mirro"))&&
new Rm(b,b.getAttribute("placeholder"))};t.IF=function(){Ai("确定取消屏蔽？","取消屏蔽后，对方将可以关注你、向你发私信、评论你的回答、使用「@」提及你，邀请你回答问题。",function(b){b&&My(this,m)},this)};t.Lk=function(){P(this.g(),document,"click",function(){this.kb.w(m)})};t.qj=function(){var b=H("profile-side-op");b&&this.g().c(b,"click",this.hj)};t.wN=function(b){var c="";b.target===this.RJ?c="time":b.target===this.SJ?c="vote":b.target===this.QJ&&(c="ask");location.href="/people/"+S[1]+"/answers?sort="+c};
t.hj=function(b){b=b.target.name;"block"===b?Ai("确定要屏蔽该用户？","屏蔽用户后，对方将不能关注你、向你发私信、评论你的实名回答、使用「@」提及你，邀请你回答问题，但仍然可以查看你的公开信息。",function(b){b&&My(this,j)},this):"report"===b?this.NG():"cancel-block"===b&&this.IF()};t.NG=function(){Wt.am("member",Fg[3])};a.My=function(b,c){var d=new V(j);P(b.g(),d,"complete",function(){window.location.reload()});d.ajax("/people/"+Fg[1]+"/block","action="+(c?"add":"cancel"))};
t.QL=function(b){if(b&&b.target&&(b=kk(this.e,b.target))){var c=J("zm-profile-fav-item-title",b),d=J("zm-profile-fav-item-des",b);c&&d&&"fav-edit"===b.name&&(c=c.innerHTML,d=d.innerHTML||"",b=[Number(b.getAttribute("data-id")),Number(b.getAttribute("data-public"))],bv(Wu(),c,d,b))}};
t.px=function(){if(this.rz=H("zh-profile-search-form")){var b=H("zh-profile-search-type");b&&this.g().c(b,"click",this.HQ);this.$j=this.rz.getAttribute("data_type");this.g().c(this.rz,"submit",this.search);N(window,"popstate",function(b){var b=b.state,c;b&&b.uG&&(c=H("zh-profile-search-query"),c.value=decodeURIComponent(b.uG),Ny(this,b.type),this.search(i,m),c.focus())},m,this);var b=(new tf(location)).Ic().get("pq"),c=(new tf(location)).Ic().get("type");c||(c="all");if(b&&c){var d=H("zh-profile-search-info");
d&&R(d,j);Ny(this,c);H("zh-profile-search-query").value=b;this.search(i,i,m)}}};t.HQ=function(b){if((b=b.target)&&b.name)Ny(this,b.name),this.search()};a.Ny=function(b,c){var d=Vb("zm-profile-search-type-item");if(d)for(var e=0;e<d.length;e++)D.remove(d[e],"current"),d[e].name===c&&D.add(d[e],"current");b.$j=c};
t.search=function(b,c,d){this.Ne=H("zh-profile-search-query").value;this.gm="/people/"+H("zh-profile-search-form").getAttribute("data_url")+"/search";if(this.Ne){c===i&&(c=j);d===i&&(d=j);if(window.history.pushState){if(this.sz)return;b&&b.preventDefault();this.hm=new V(j);this.sz=j;this.g().c(this.hm,"complete",this.oI);c&&window.history.pushState({uG:encodeURIComponent(this.Ne),type:this.$j},"","?pq="+encodeURIComponent(this.Ne)+"&type="+this.$j);this.hm.ajax(this.gm,"type="+this.$j+"&pq="+encodeURIComponent(this.Ne),
"","POST")}else b||(d?(this.Ne=H("zh-profile-search-query").value,this.gm="/people/"+H("zh-profile-search-form").getAttribute("data_url")+"/search",window.location.href=this.gm+"?type="+this.$j+"&pq="+encodeURIComponent(this.Ne)):(this.hm=new V(j),this.sz=j,this.g().c(this.hm,"success",this.oI),this.Ne=H("zh-profile-search-query").value,this.gm="/people/"+H("zh-profile-search-form").getAttribute("data_url")+"/search",this.hm.ajax(this.gm,"type="+this.$j+"&pq="+encodeURIComponent(this.Ne),"","POST")));
(b=H("zh-profile-search-info"))&&R(b,j)}else b&&b.preventDefault()};
t.oI=function(){this.sz=m;xc(H("zh-profile-search-word"),this.Ne);var b=Ge(this.hm);if(b&&!b.r){var c=H("zh-profile-search-list");if(c)if(0===b.msg[0])H("zh-profile-list-container").innerHTML='<div id="'+c.id+'"><div style="margin: 20px;color: #999;text-align: center;">抱歉，没有找到任何结果</div></div>';else{var d;d=""+('<div id="'+c.id+'">');d+=b.msg[1]+"</div>";H("zh-profile-list-container").innerHTML=d+'<a href="javascript:;" id="zh-load-more" class="zg-btn-white zu-button-more" style="">更多</a>';if((b=Vb("zm-item",
c))&&b.length)this.dk=b[b.length-1].id.split("-")[1];this.yb=k;this.yb=new Ax(H(c.id),k,j);this.yb.v();this.yb.dk=this.dk;this.yb.url=this.gm;this.yb.de.pq=this.Ne;this.yb.de.type=this.$j;H("zh-profile-search-query").focus()}}};a.Ly=function(){T.call(this)};y(Ly,T);
Ly.prototype.ea=function(b){this.e=b;this.Na=new Os;this.Na.n(this.e);this.form=H("zm-profile-expert-editform");this.g().c(this.form,"submit",this.By);this.g().c(this.Na,["add","remove","sort"],function(){this.Qd()});$(".enable").on("change","input",$.proxy(function(){this.Qd()},this));var c=H("zh-profile-expert-warning");c&&this.g().c(c,"click",function(b){"close"===b.target.name&&Zj(c)});$(".enable input[type='radio']").click(function(b){R(H("zh-profile-expert-reopen-tip"),!Number($(b.target).val()))})};
Ly.prototype.Qd=function(){$(window).on("beforeunload.profile",v(s("你的更改还未保存，确认离开该页面吗？"),this))};Ly.prototype.ye=function(){$(window).off("beforeunload.profile")};
Ly.prototype.By=function(){var b=[];z.forEach(this.Na.data,function(c){b.push(c[3])});var c=$(this.form).serializeArray()[0].value,d=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();et("ProfileEditExpertTopicsV2","save",{settings:{enable_expert:c,expert_topic:d}},function(){this.ye();window.location.href="/people/"+S[1]},k,this)};a.Oy=function(b,c,d,e,g){ju.call(this,b,c,g);this.Zv=d||"people";this.WL=e||["zg-follow","zg-unfollow"]};y(Oy,ju);Oy.prototype.v=function(b){Oy.m.v.call(this,b);this.Ha(this.e)};Oy.prototype.BA=ca("BA");Oy.prototype.Ha=function(b){if(this.BA){var c=new Ay,d=this.WL;c.bw=this.Zv;c.aw=d||c.aw;this.zh&&c.km(this.zh);c.n(b)}};Oy.prototype.km=ca("zh");a.Py=function(){};t=Py.prototype;t.ZA={"lock-question":"block","unlock-question":"unblock","mute-question":"mute","unmute-question":"unmute","remove-question":"delete","collapse-answer":"collapse","uncollapse-answer":"uncollapse","remove-answer":"delete"};t.nw=ba();t.ow=function(b){var c=new Qi(b),d=this.nw();if(!d)return qk("OP META DATA ELEMENT DOES NOT PROVIDED");z.forEach(["question_id","task_id","answer_id","none_queue"],function(b){var g=d.getAttribute("data-"+b);g&&c.add(b,g)});return c};
a.Qy=function(b,c){var d=sv[c];if(d){var e;e=[];(e=yc(b,function(b){return 3===b.nodeType&&Ka(b.nodeValue)},e,j)?e[0]:i)&&xc(e,b.getAttribute("data-label")||d.label);b.setAttribute("data-op",c)}else qk("NO SUCH OP NAME")};t.wy=ba();t.fM=Xj(function(){var b=qv.D();b.on("cancel",this.wy,m,this);return b});a.Ry=function(b,c,d,e){var g=c.getAttribute("data-op");if(g){Qy(c,g);var h=b.fM(),e=b.ow(e).add("action",b.ZA[g]);xv(h,c,v(d||ha,b),"",e.toString());h.w(j)}};a.Sy=function(b,c,d,e,g,h){fq.call(this,e,c,d,h);this.V=b;this.Fl=this.Xj=m;this.jR=g};y(Sy,fq);a.Ty=[{value:"精简文字描述",label:"精简文字描述"},{value:"补充必要的信息",label:"补充必要的信息"},{value:"改进标点或格式",label:"改进标点或格式"},{value:"other",label:"其他"}];t=Sy.prototype;t.n=function(b){Sy.m.n.call(this,b);this.g().c(Ii,"anon_change",this.dj)};t.dj=function(b){this.Fl||D.enable(this.e,"zm-editable-disabled",b.jb)};
t.Gi=function(){Sy.m.Gi.call(this);var b=K("a",{"class":"zg-right zg-link-litblue",href:"http://www.zhihu.com/question/19550238/answer/12202028",target:"_blank"},"为什么问题可以被公共编辑？"),c=K("select",{style:"1px solid #999 "}),d=K("option",{value:"none"},"请选择一个修改理由...");c.appendChild(d);z.forEach(Ty,function(b,d){var e=K("option",{value:b.value},d+1+". "+b.label);c.appendChild(e)});this.$y=K("div",{"class":"zm-editable-require-reason-wrap",style:"padding:10px 0 0 0"},[b,this.PY=c,this.lF=K("span"),this.PR=
K("div",{"class":"zg-form-text-input",style:"height:22px;margin:10px 0 0 0;display:none"},this.OR=K("textarea",{style:"width:100%;height:22px !important;min-height:22px !important;"}))]);jc(this.$y,this.fd);this.Xj&&this.fi(" * 必选","zg-gray-normal");var e=Ub("select",k,this.$y)[0];this.g().c(e,"change",function(){R(this.PR,"other"===e.value);this.fi(" * 必选","zg-gray-normal")})};
t.pf=function(b){var c=Ub("select",k,this.$y)[0],d=c.value;if(this.Xj){if("none"===d){this.fi("请选择一个修改理由");return}if("other"===c.value&&(d=ak(this.OR.value),!d)){this.fi("请填写修改理由");return}}"title"===this.Lq&&-1===b.indexOf("?")&&-1===b.indexOf("？")?this.fi("还没有输入问号"):("none"===d&&(d=""),this.de=["id="+this.V+"&reason="+encodeURIComponent(d)+"&question_id="+this.V],this.dispatchEvent("change"),Sy.m.pf.call(this,b),this.fi("* 必选","zg-gray-normal"),this.Xj=j)};
t.fi=function(b,c){this.lF.innerHTML=b;D.set(this.lF,c||"zg-error-text")};t.Wf=function(){return this.Ad&&this.jR?ck(Ha(this.Ka.value)):Sy.m.Wf.call(this)};t.Qd=function(){$(window).on("beforeunload.EditorWithReason",v(s("你对问题的修改还未保存，确认离开该页面吗？"),this))};t.ye=function(){$(window).off("beforeunload.EditorWithReason")};t.gh=function(){Sy.m.gh.call(this);this.ye()};t.Gd=function(){Sy.m.Gd.call(this);this.Qd()};a.Uy=function(b){this.ce=10;this.Wc="搜索用户";this.path=b||"/people/autocomplete"};y(Uy,Hk);t=Uy.prototype;t.o=function(){var b=K("div","zg-section zm-tag-editor-command-buttons-wrap",[this.Sa=K("input","zg-form-text-input zg-mr15"),this.$G=K("span","zg-mr15"),this.UK=K("a",{"class":"zg-mr15 zg-btn-blue",href:"javascript:;",name:"add"},"移交")]);this.e.appendChild(b);this.Wc&&((new Nl(this.Wc)).n(this.Sa),this.Sa.title=this.Wc);this.jf(b);this.g().c(this.UK,"click",this.Jo)};
t.jf=function(b){this.J=new an(this.path,this.Sa,k,k,b,j);this.J.yf(j);this.J.Wh=this.ce;this.g().c(this.J,"select",this.DQ)};t.Jo=function(){this.vz&&this.dispatchEvent("select")};t.DQ=function(){var b=this.J.Xf().slice(1);this.vz=[b[3],b[0]];this.$G.innerHTML=b[0]};t.h=p("e");t.n=function(b){this.e=b;this.o()};t.hide=function(){R(this.e,m);this.vz=k;this.$G.innerHTML=""};a.Vy=function(){M.call(this);this.IY=[];this.Tx=0;this.rA=this.JY=k;this.EC=5;this.LN="/reviewq/handover"};y(Vy,Hk);ya(Vy.prototype,Py.prototype);t=Vy.prototype;t.nw=p("aa");t.ow=function(b){return Py.prototype.ow.call(this,b).add("queue_id",this.Jb).add("is_realm",this.$d)};t.wy=function(){this.locked=m};
t.v=function(b){this.e=b;this.Jb=(b=H("queue_id"))?b.value:0;this.$d=(b=H("is_realm"))?b.value:0;this.o();this.Ha();Bt.Ur||(b=new Hd(1E3*this.EC),b.start(),this.g().c(b,Id,this.bU));H("zh-load-more")&&(new Oy(this.e,window.location.href,"queue",["zg-btn-follow","zg-btn-unfollow"],j)).v();this.g().c(this.e,"click",this.fa)};t.fa=function(b){this.Aw(b.target)};
t.bU=function(){var b=Vb("zm-review-queue-deadline");b&&b.length&&z.forEach(b,function(b){var d=b.getAttribute("data-lefttime");if(d)if(d=+d,2E3<d&&(d-=Math.floor(+new Date/1E3)),0>=d&&-1E3<d)b.innerHTML="已流通";else{60>d&&D.add(b,"zm-review-queue-time-warning");var e=Math.floor(d/60),g=d%60;b.setAttribute("data-lefttime",d-this.EC+"");b.innerHTML=(0<e?e+"分":"")+(g+"秒")}},this)};t.rJ=function(){Wy(this,["删除话题","已删除"],["delete_topic",""]);Xy(this);Bt.Ur||this.aa.setAttribute("data-lockdown")};t.ww=u(53);
t.IQ=function(){this.YG=this.Lj.vz;this.xhr=new V(j);this.mb&&P(this.g(),this.xhr,"success",this.te);this.xhr.ajax(this.LN+"?queue_id="+this.Jb+"&is_realm="+this.$d,"action=assign&assigned_to="+this.YG[0]+"&task_id="+this.aa.getAttribute("data-task_id")+"&none_queue="+this.aa.getAttribute("data-none_queue"))};t.o=function(){this.pj=H("zh-queue-new-info");var b=K("div",{style:"display:none"},this.xb=K("div","zu-review-queue-topic-editor",K("div","zm-tag-editor-labels")));kc(b,this.e)};
t.Ha=function(){Bt.Ur||this.ek()};t.ek=function(){this.hk=new V(m);P(this.g(),this.hk,"success",this.Ow);this.hk.ajax("/reviewq/sidebar?queue_id="+this.Jb,k,"GET")};t.Ow=function(){var b=Ge(this.hk);if(!b||!b.r){var c=b.msg,b=Vb("zm-review-queue-live-udatable-num");z.forEach(b,function(b){var e=b.getAttribute("data-key");e&&(e=c[e],e||(b.innerHTML=e))});setTimeout(v(this.ek,this),1E4)}};t.xJ=function(){Yy(this,this.Oa,"已流通")};
a.Yy=function(b,c,d){c=c||b.Oa;d=d||"已处理";D.remove(c,"zg-btn-white");"pass"===c.name&&(c.innerHTML=d,Bt.Ur||(c.name=""));b.aa=Ic(c,k,"zm-item");Xy(b);(b=J("zm-review-queue-deadline",b.aa))&&R(b,m)};t.sJ=function(){Wy(this,["移交","已经移交给："+this.YG[1]],["handover",""]);this.Lj.hide();Xy(this);R(this.aa,m)};
a.Wy=function(b,c,d){var e=0;b.Oa.name===d[0]&&(e=1);b.Oa.name=d[e];var d="",g=b.Oa.innerHTML.indexOf("</span>");-1<g&&(d=b.Oa.innerHTML.substring(0,g+7));b.Oa.innerHTML=d+c[e]},a.Xy=function(b){D.remove(b.aa,"zm-item-unread");b.locked=m};
t.Aw=function(b){if(this.locked)this.JE&&qk(this.JE,"last action");else{this.locked=j;var c=b.name;this.JE=c;var d=Ic(b,k,"zm-item");this.Oa=b;this.aa=d;if(d.getAttribute("data-lockdown"))this.locked=m;else{var e=b.getAttribute("data-op");if(e)switch(e){case "lock-question":case "unlock-question":Ry(this,b,function(){Qy(b,"lock-question"===e?"unlock-question":"lock-question");Xy(this)});break;case "mute-question":case "unmute-question":Ry(this,b,function(){Qy(b,"mute-question"===e?"unmute-question":
"mute-question");Xy(this)});break;case "remove-question":Ry(this,b,function(){L(d);this.locked=m});break;case "collapse-answer":case "uncollapse-answer":Ry(this,b,function(){Qy(b,"collapse-answer"===e?"uncollapse-answer":"collapse-answer");Xy(this)});break;case "remove-answer":Ry(this,b,function(){L(d);this.locked=m})}else{switch(c){case "edit_title":var c=d.getAttribute("data-question_id"),g=d.getAttribute("data-task_id"),c=new Sy(c,"/reviewq/question?queue_id="+this.Jb+"&action=edit_title&task_id="+
g,"title",m,j);c.Rq=j;c.Ad=j;c.n(b.parentNode);c.Xj=j;c.v();c.Gd();this.iZ=c;L(b);this.locked=m;break;case "bind_topic":this.locked=m;this.rA||(c=new Ss(this.Jb),c.n(this.xb),this.rA=c);c=this.rA;g=J("zm-review-queue-tags-wrap",d);if(!c.locked){c.locked=j;c.V=d.getAttribute("data-question_id");var h=d.getAttribute("data-task_id");c.kB=c.KB+h+"&question_id="+c.V+"&action=bind_topic";c.JG=c.KB+h+"&question_id="+c.V+"&action=unbind_topic";c.bs&&(h=J("zm-tag-editor-labels",c.bs),ao(c),h.innerHTML=c.Re.innerHTML,
D.remove(c.bs,"zm-review-queue-editing"));c.tC=d;c.bs=d;D.add(c.tC,"zm-review-queue-editing");kc(c.e,g);R(c.Re,m);c.sA=new V(j);c.g().c(c.sA,"complete",c.VQ);c.sA.ajax("/reviewq/fetch_topic","question_id="+c.V)}break;case "delete_topic":this.mb=this.rJ;this.xhr=new V(j);this.mb&&P(this.g(),this.xhr,"success",this.te);this.xhr.ajax("/reviewq/topic?queue_id="+this.Jb+"&is_realm="+this.$d,"action=delete&topic_id="+this.aa.getAttribute("data-topicid")+"&task_id="+this.aa.getAttribute("data-task_id")+
"&none_queue="+this.aa.getAttribute("data-none_queue"));break;case "handover":this.locked=m;this.mb=this.sJ;this.Lj?R(this.Lj.h(),j):(c=new Uy("/reviewq/auto"),g=K("div",{id:"zh-review-queue-people-selector"}),this.e.appendChild(g),c.n(g),this.Lj=c,this.g().c(this.Lj,"select",this.IQ));c=+d.getAttribute("data-hotype");this.Lj.J.Wh=c;c=Ic(b,"DIV");kc(this.Lj.h(),c);break;case "pass":case "unpass":this.mb=this.xJ;this.xhr=new V(j);this.mb&&P(this.g(),this.xhr,"success",this.te);this.xhr.ajax("/reviewq/pass",
"queue_id="+this.Jb+"&is_realm="+this.$d+"&action="+c+"&task_id="+this.aa.getAttribute("data-task_id")+"&none_queue="+this.aa.getAttribute("data-none_queue"));break;case "unflag":break;case "add_question_comment":case "add_answer_comment":this.RK=c.split("_")[1];this.locked=m;(c=this.Yi())?R(c,j):(g=K("div"),g.innerHTML=H("zh-review-queue-comment-form-template").innerHTML,kc(g,J("zm-item-comment-el",this.aa)));$(".zm-command",c).show();break;case "delete_comment":this.locked=m;break;case "addnew":this.locked=
m;c=Ub("TEXTAREA",k,this.aa);c=c[c.length-1].value;if(!c)return;this.mb=this.oJ;this.xw(c);break;case "closeform":this.locked=m;R(this.Yi(),m);break;case "unbind_topic":this.mb=this.FJ;c=this.aa.getAttribute("data-question_id");g=this.aa.getAttribute("data-topicid");h=this.aa.getAttribute("data-task_id");this.xhr=new V(j);this.mb&&P(this.g(),this.xhr,"success",this.te);this.xhr.ajax("/reviewq/question?queue_id="+this.Jb+"&is_realm="+this.$d+"&task_id="+h,"action=unbind_topic&question_id="+c+"&topic_id="+
g+"&none_queue="+this.aa.getAttribute("data-none_queue"));break;case "rebind_topic":this.mb=this.yJ;c=this.aa.getAttribute("data-question_id");g=this.aa.getAttribute("data-topicid");h=this.aa.getAttribute("data-task_id");this.xhr=new V(j);this.mb&&P(this.g(),this.xhr,"success",this.te);this.xhr.ajax("/reviewq/question?queue_id="+this.Jb+"&is_realm="+this.$d+"&task_id="+h,"action=bind_topic&question_id="+c+"&topic_id="+g+"&none_queue="+this.aa.getAttribute("data-none_queue"));break;case "cancel_nohelp":this.mb=
this.pJ;c=this.aa.getAttribute("data-answer_id");g=this.aa.getAttribute("data-task_id");this.xhr=new V(j);this.mb&&P(this.g(),this.xhr,"success",this.te);this.xhr.ajax("/reviewq/answer?queue_id="+this.Jb+"&is_realm="+this.$d+"&task_id="+g,"action=cancel_nohelp&answer_id="+c+"&none_queue="+this.aa.getAttribute("data-none_queue"));break;case "nohelp":this.mb=this.wJ;c=this.aa.getAttribute("data-answer_id");g=this.aa.getAttribute("data-task_id");this.xhr=new V(j);this.mb&&P(this.g(),this.xhr,"success",
this.te);this.xhr.ajax("/reviewq/answer?queue_id="+this.Jb+"&is_realm="+this.$d+"&task_id="+g,"action=nohelp&answer_id="+c+"&none_queue="+this.aa.getAttribute("data-none_queue"));break;case "edit_detail":c=d.getAttribute("data-question_id");g=d.getAttribute("data-task_id");c=new Sy(c,"/reviewq/question?queue_id="+this.Jb+"&action=edit_detail&task_id="+g,"detail_text",j,m);c.Ab='<div style="font-weight:bold"><a href="javascript:;" name="edit">添加补充说明</a></div>';c.Rq=j;c.n(b.parentNode);c.Xj=j;c.v();
c.Gd();this.BX=c;L(b);this.locked=m;break;case "voteup":case "votedown":c="voteup"===c?"vote_up":"vote_down";this.mb=this.GJ;g=this.aa.getAttribute("data-answer_id");h=this.aa.getAttribute("data-task_id");this.xhr=new V(j);this.mb&&P(this.g(),this.xhr,"success",this.te);this.xhr.ajax("/reviewq/answer?queue_id="+this.Jb+"&is_realm="+this.$d+"&task_id="+h,"action="+c+"&answer_id="+g+"&none_queue="+this.aa.getAttribute("data-none_queue"));break;case "thanks":this.mb=this.EJ;c=this.aa.getAttribute("data-answer_id");
g=this.aa.getAttribute("data-task_id");this.xhr=new V(j);this.mb&&P(this.g(),this.xhr,"success",this.te);this.xhr.ajax("/reviewq/answer?queue_id="+this.Jb+"&is_realm="+this.$d+"&task_id="+g,"action=thanks&answer_id="+c+"&none_queue="+this.aa.getAttribute("data-none_queue"));break;default:this.locked=m}return m}}}};t.EJ=function(){this.Oa.name="";var b=$(this.Oa),c=$("i",b);b.html(c).append("感谢已发出");Yy(this,Zy(this),"已流通")};
t.GJ=function(){var b=Ge(this.xhr),c=J("vote-bar-hook",this.aa);D.set(c,"zm-item-vote-bar");"up"===b.msg?(D.add(c,"zm-item-vote-up-active"),Yy(this,Zy(this),"已流通")):"down"===b.msg?D.add(c,"zm-item-vote-down-active"):(D.remove(c,"zm-item-vote-up-active"),D.remove(c,"zm-item-vote-down-active"));this.locked=m};a.Zy=function(b){return J("zg-btn-white",b.aa)};
t.te=function(){var b=Ge(this.xhr);if(b&&b.r){if("deleted"===b.msg){if(this.aa&&(D.add(this.aa,"zm-queue-disabled"),this.aa.setAttribute("data-lockdown"),b=Ub("A",k,this.aa),z.forEach(b,function(b){if("delete_question"===b.name||"delete_answer"===b.name)b.style.color="red !important",b.innerHTML="已删除"}),b=J("zm-review-queue-deadline",this.aa)))b.setAttribute("data-lefttime",-9E3),b.innerHTML=""}else U(b.msg);this.locked=m}else this.mb()};
t.wJ=function(){this.Oa.name="cancel_nohelp";var b=$(this.Oa),c=$("i",b);b.html(c).append("撤销没有帮助");this.locked=m;Yy(this,Zy(this))};t.pJ=function(){this.Oa.name="nohelp";var b=$(this.Oa),c=$("i",b);b.html(c).append("没有帮助");this.locked=m;Yy(this,Zy(this))};t.yJ=function(){this.Oa.name="unbind_topic";this.Oa.innerHTML="解除绑定";this.locked=m};t.FJ=function(){this.Oa.name="rebind_topic";this.Oa.innerHTML="重新绑定";this.locked=m};
t.oJ=function(){var b=this.Yi(),c=K("div","zm-comment-list");c.innerHTML='<div class="zm-comment-content">已评论</div>';kc(c,b);gk(c);setTimeout(function(){L(c)},2500);var d=Ub("TEXTAREA",k,this.aa);d.length&&(d[d.length-1].value="");R(b,m)};
t.xw=function(b){this.xhr=new V(j);this.mb&&P(this.g(),this.xhr,"success",this.te);var c=this.aa.getAttribute("data-question_id"),c=c?"&question_id="+c:"&question_id=0",d=this.aa.getAttribute("data-answer_id");this.xhr.ajax("/reviewq/"+this.RK,"queue_id="+this.Jb+"&is_realm="+this.$d+"&action=add_comment&task_id="+this.aa.getAttribute("data-task_id")+c+(d?"&answer_id="+d:"&answer_id=0")+"&comment="+encodeURIComponent(b)+"&none_queue="+this.aa.getAttribute("data-none_queue"))};
t.Yi=function(){return J("zm-comment-form",this.aa)};a.$y=function(b){this.eP=this.locked=m;this.url=b||"/reviewq/image"};y($y,Hk);ya($y.prototype,Py.prototype);t=$y.prototype;t.nw=p("e");t.ZA={"remove-question":"delete_question","collapse-answer":"collapse","uncollapse-answer":"uncollapse","remove-answer":"delete_answer","remove-image":"delete_image","remove-video":"delete_video"};t.wy=function(){this.locked=m};
t.n=function(b){this.e=b;var b=J("zm-item-rich-text",this.e),c=K("div","zm-item-answer-summary"),d=b.innerHTML.replace(/<br>/g," "),e;e=d.replace(/<p class="video-info">(.+?)<\/p>/g,"");e=e.replace(/<(\/)?b>/g,"").replace(/<(\/)?i>/g,"").replace(/<(\/)?u>/g,"");d=e.replace(/<[^>]+>/g," ").replace(/\s+/g," ");e=-1<b.innerHTML.indexOf("<img")||-1<b.innerHTML.indexOf("<IMG");var g=-1<b.innerHTML.indexOf("video-box"),h=pk(d),l="",n=e||g;150<h?(n=j,l=d.substring(0,100)+"… "):3<b.innerHTML.split("br").length?
(n=j,l=d):l=n?d:b.innerHTML;d=g?' <span class="zg-content-video-icon"></span>':' <span class="zg-content-img-icon"></span>';if(e||g)l+=d;n&&(l+='<a href="javascript:;" class="zg-inline-block" name="expand">显示全部 »</a>');c.innerHTML=l;kc(c,b);this.Ly();this.Ha()};t.Ly=function(){this.yB=this.e.getAttribute("data-answer_id");this.OY=this.e.getAttribute("data-question_id");this.SO=this.e.getAttribute("data-task_id")};t.Ha=function(){this.g().c(this.e,"click",this.tl)};
t.tl=function(b){if(!b.target.name||this.eP)return j;this.fa(b.target.name,b.target)};a.az=function(b){D.has(b.e,"zm-item-unread")&&(b.locked=j,D.remove(b.e,"zm-item-unread"),Ci(b.url,v(function(){this.locked=m},b),"POST","task_id="+b.SO));if(b=J("zm-image-queue-button-pass",b.e))b.innerHTML="已处理",D.xi(b,"zm-image-queue-button-pass","zg-link-gray-normal zg-right")};
t.fa=function(b,c){if(!this.locked){this.zX=c;var d=j,e=c.getAttribute("data-op");if(e)switch(e){case "collapse-answer":case "uncollapse-answer":Ry(this,c,function(){Qy(c,"collapse-answer"===e?"uncollapse-answer":"collapse-answer");az(this)});break;case "remove-answer":Ry(this,c,function(){L(this.e);az(this)});break;case "remove-question":Ry(this,c,function(){L(this.e);az(this)});break;case "remove-image":case "remove-video":var g=rc(c),h,d=g.getAttribute("data-imageid"),l=g.getAttribute("data-videoid");
d?h="image_hash="+d:l&&(h="video_id="+l);Ry(this,c,function(){var b=Ic(g,"li");R(b,m);this.locked=m},h)}else{switch(b){case "pass":az(this);R(this.e,m);break;case "expand":D.remove(this.e,"zm-item-collap");break;default:d=m}if(!d)return j}}};a.bz=function(b,c,d){M.call(this);this.jZ=d;this.ZI=b;this.KT=c;this.iA=m};y(bz,Hk);bz.prototype.v=function(){this.g().c(this.ZI,"click",this.qM)};bz.prototype.qM=function(){this.iA=!this.iA;R(this.KT,this.iA)};a.cz=function(){M.call(this);this.Ss=0;this.Ck=[];this.Tx=0};y(cz,Hk);t=cz.prototype;t.vf=function(b){var c=b.id.split("-")[1],d=new V(j),e=0,g=Ic(b,k,"zm-item");g&&(-1<b.innerHTML.indexOf("取消")?(Rf(g,"background","#fff"),b.innerHTML="折叠",D.xi(b,"zg-unfollow","zg-follow"),e=0):(Rf(g,"background","#ddd"),b.innerHTML="取消折叠",D.xi(b,"zg-follow","zg-unfollow"),e=1));d.ajax("/review/api/collapse_answer","is_collasped="+e+"&answer_id="+c)};
t.ek=function(){this.hk=new V(m);P(this.g(),this.hk,"success",this.Ow);this.hk.ajax("/reviewq/sidebar?queue_id="+this.Jb,k,"GET")};t.Ow=function(){var b=Ge(this.hk);if(!b||!b.r){var c=b.msg,b=Vb("zm-review-queue-live-udatable-num");z.forEach(b,function(b){var e=b.getAttribute("data-key");e&&(e=c[e],e!=k&&(b.innerHTML=e))});setTimeout(v(this.ek,this),1E4)}};
t.v=function(){var b=H("zh-queue-wrap");if(b){var c=new Oy(b,window.location.href,"queue",["zg-btn-follow","zg-btn-unfollow"],j);this.g().c(b,"click",this.JF);c.v()}(b=H("zh-review-queue-online-reviewers"))&&(new Oy(b,window.location.href,k,k,j)).v();if(b=H("zh-queue-content-list"))this.aT=b,this.g().c(W,Ws.lW,this.iN),b=new Oy(b,window.location.href,"queue",["zg-btn-follow","zg-btn-unfollow"],j),b.km(Iy),b.v(),this.g().c(H("zh-queue-outer-wrap"),"click",this.JF);(b=H("zh-queue-content-list-v2"))&&
(new Vy).v(b);if(b=H("zh-image-queue-list-wrap"))this.Jb=(c=H("queue_id"))?c.value:0,this.ek(),b=Vb("zm-item",b),z.forEach(b,function(b){(new $y).n(b)});if(b=H("zh-video-queue-list-wrap"))this.Jb=(c=H("queue_id"))?c.value:0,this.ek(),b=Vb("zm-item",b),z.forEach(b,function(b){(new $y("/reviewq/video")).n(b)});if(b=H("zh-inferiority-queue-list-wrap"))this.Jb=(c=H("queue_id"))?c.value:0,this.ek(),b=Vb("zm-item",b),z.forEach(b,function(b){(new $y("/reviewq/inferiority")).n(b)});if(Jg){b=Jg;this.Ss=b[0];
var d=[];z.forEach(b[1],function(b){d.push(b)});this.Ck=d}if(b=H("zh-queue-create-wrap"))this.Kh=b,this.g().c(this.Kh,"click",this.fa),(b=H("zh-queue-delete"))&&this.g().c(b,"click",this.tL),(new bz(H("add-desc"),H("add-desc-toggle-wrap"))).v(),(new bz(H("zh-queue-add-admin"),H("zh-queue-add-admin-toggle-wrap"))).v(),this.TG=H("zh-queue-rules-wrap"),this.DT=H("zh-queue-name-input"),this.vL=H("zh-queue-desc-input"),this.Nv=H("zh-queue-error-message"),this.lJ=H("zh-queue-admin-selector"),this.oB=H("zh-queue-admin-members-wrap"),
this.J=new an("/people/autocomplete",this.lJ,k,k,H("zh-queue-add-admin-toogle-wrap"),j),this.J.yf(j),this.g().c(this.J,"select",this.Jo),this.qS=H("zh-queue-rule-template").innerHTML;if(b=H("zh-queue-delete"))this.rL=b,this.g().c(b,"click",this.ul)};t.ul=function(){Ci("/review/queues/delete",function(){window.location.href="/review"},"POST","queue_id="+this.rL.name)};
t.Jo=function(){var b=z.slice(this.J.Xf(),1),c=b[3],d=1;z.forEach(this.Ck,function(b){b===c&&(d=m)});d&&this.Ck.push(c);b=['<div class="zm-item" id="adm-',b[3],'"><a class="zg-right" name="remove_admin" href="javascript:;">删除</a><a class="zm-item-link-avatar" href="/people/',b[1],'" style="float:none"><img title="',b[0],'" src="',b[2],'" class="zm-item-img-avatar" /></a></div>'].join("");this.oB.innerHTML+=b};
t.fa=function(b){if((b=kk(this.Kh,b.target))&&b.name)switch(b.name){case "remove_rule":b=Ic(b,k,"zg-section");L(b);break;case "zh-queue-add-rule-button":b=K("div");b.innerHTML=this.qS;this.TG.appendChild(b);break;case "add_queue":this.xhr=new V(j);P(this.g(),this.xhr,"success",this.qB);b=new lk(j);b.add("id",this.Ss);b.add("title",this.DT.value);b.add("bio",this.vL.value);var c=[],d=Ub("SELECT",k,this.TG);d&&d.length&&z.forEach(d,function(b){(b=Dx(b))&&c.push(b)});b.add("subscrible",c.join(","));
b.add("maintainer",this.Ck.join(","));this.Ss?this.xhr.ajax("/review/queues/update",b.Ic()):this.xhr.ajax("/review/queues/new",b.Ic());break;case "remove_admin":var b=Ic(b,k,"zm-item"),e=b.id.split("-")[1];L(b);var g=[];z.forEach(this.Ck,function(b){b!==e&&g.push(b)});this.Ck=g}};t.tL=function(){this.xhr=new V(j);P(this.g(),this.xhr,"success",this.qB);this.xhr.ajax("/review/queues/delete","id="+this.Ss)};
t.qB=function(){var b=Ge(this.xhr);b&&!b.r?(R(this.Nv,m),b.msg&&(window.location.href=b.msg)):(b=b.msg,this.Nv.innerHTML=la(b)?b.join("<br />"):b,R(this.Nv,j))};t.iN=function(b){this.Tx++;300<this.Tx&&window.location.reload();var b=b.sb,c=K("div");c.innerHTML=b;jc(c,qc(this.aT));gk(c)};t.JF=function(b){if((b=kk(H("zh-queue-outer-wrap"),b.target))&&b.name)switch(b.name){case "collapse":this.vf(b,1);break;case "uncollapse":this.vf(b,0)}};a.dz=function(){M.call(this)};y(dz,Hk);
dz.prototype.v=function(){var b=H("zh-search-result-more");b&&this.g().c(b,"click",function(c){(c=kk(b,c.target))&&c.name&&c.id&&"focus"===c.name&&ok(c,c.id.split("-")[0])});var c=H("zm-search-result-topic-info");c&&this.g().c(c,"click",function(b){(b=kk(c,b.target))&&b.name&&b.id&&"focus"===b.name&&ok(b,"topic",k,["zg-btn-follow","zg-btn-unfollow"])});var d=H("zm-search-result-people-info");d&&this.g().c(d,"click",function(b){(b=kk(d,b.target))&&b.name&&b.id&&"focus"===b.name&&ok(b,"people",k,["zg-btn-follow",
"zg-btn-unfollow"])});var e=H("zm-search-result-answers");e&&(e=Vb("feed-item-hook",e),z.forEach(e,function(b){(new Bx).n(b)}));e=$("#zh-search3-list > .zh-general-list");e.length&&((new Qt({Ya:["nodeSource"],Iz:20<=e.children().length})).n(e[0]),$(".search-debug-all-btn").click(function(){$("#zh-search3-list").toggleClass("debug")}));(e=$("#zh-search-report")[0])&&(new Dr({type:"search_suggest",title:"新搜索建议反馈"})).n(e);$("#zh-search3-list").on("click",".zm-search3-item",function(b){b=$(b.delegateTarget).find(".zm-search3-item").index(this)+
1;Lf.set("s-q",encodeURIComponent(cs(new tf(location.href),"q")));Lf.set("s-i",b)})};a.ez=function(){T.call(this);this.$=k};y(ez,T);ez.prototype.z=function(){ez.m.z.call(this);this.g().c(this.e,"submit",function(b){b.preventDefault();this.save()})};ez.prototype.save=function(){this.update(fz(this))};ez.prototype.update=function(b){if(!(this.$&&"pending"===this.$.state())){var c=$(this.e).data("init"),b={method:"save",params:$.extend({},c.params||{},{settings:b})};this.$=$.post("/node/"+c.nodename,b,v(this.pf,this))}};
ez.prototype.pf=function(b){b&&(b[0]?this.dispatchEvent({type:"success",data:b}):this.dispatchEvent({type:"error",data:b}))};a.fz=function(b){b=$(b.e);b=b.serializeArray().concat($("input:checkbox",b).map(function(){return{name:this.name,value:this.checked?this.value:0}}).get());return z.reduce(b,function(b,d){b[d.name]=d.value;return b},{})};a.gz=function(){T.call(this);this.NX=[];this.MY="/profile/validate";this.WT="/settings/unblockuser"};y(gz,T);
gz.prototype.v=function(){var b=this,c=$("#zh-settings-noti-form-wrapper>form")[0];if(c){var d=new ez;d.n(c);d.addEventListener(["success","error"],function(b){window.scrollTo(0,0);Hr(F.Fa(b.data),3E3)})}var e=$(".js-ajax-form");e.submit(function(b){var c=$(b.target),b=c.attr("action")||location.href;$.post(b,c.serialize()).done(function(b){Hr(F.Fa(b),5E3);c.hasClass("unsubscribe")&&(e.remove(),$(".settings-section").remove())});return m});$(".js-unsubscribe-other-reason").on("change",function(b){$(b.target).parent().siblings().find(".zg-form-text-input").toggle()});
c=$("#js-settings-account-form");if(c.length){var g=Xj(function(){new Rm(H("password"))}),d=$("#url_token"),h=$("#js-url-preview .token");d.on("input change keyup",function(){h.text($.trim(this.value))});var l=$("#email"),n=function(){$("#js-email-confirm").show();l.off("focus",n);g()};l.one("focus",n);$(function(){document.activeElement===l.get(0)&&n()});$(".resend-mail",c).click(function(){var b=$(this);Ii.dispatchEvent("/activation/resend-email");$.post("/reactive",function(c){c.r?U(c.msg):b.replaceWith("已发送")});
return m});hz(c);var d=new Cn,q=$(".rename-tab",c);d.n(q.get(0));var r=function(){$("input[placeholder]:visible",q).placeholder()};d.on("select",r);var x=$(".rename-button",c),c=function(){x.remove();q.show();r()};x.one("click",c);"#rename-section"===location.hash&&c()}c=$("#js-form-account-password");c.length&&($("input[placeholder]",c).each(function(){new Rm(this)}),hz(c));(c=H("zh-topic-block-editor"))&&(new Qs(Hg)).n(c);(c=H("zh-setting-page-bind-wrap"))&&(new Gx).n(c);if(c=$(".zh-general-list").get(0))d=
new Qt({Ya:["autoload","nodeSource"]}),this.M(d),d.n(c),this.g().c(c,"click",this.TP);$(".zu-main-content-inner form").on("change","input, textarea, select",function(){b.Hv("SettingsPage")}).on("submit",function(){b.Sq("SettingsPage")})};gz.prototype.Hv=function(){$(window).on("beforeunload.SettingsPage",v(s("你的修改还未保存，确认离开该页面吗？"),this))};gz.prototype.Sq=function(){$(window).off("beforeunload.SettingsPage")};
a.hz=function(b){$(".zg-form-text-input",b).each(function(){function b(){this.value!==this.defaultValue&&(e.hide(),d.off("change input keyup",b))}var d=$(this),e=d.next(".validate-error");if(e.length)d.on("change input keyup",b)})};
gz.prototype.TP=function(b){var c=b.target;if(c&&c.name){var d=c.id.split("-")[1];Ai("取消黑名单","取消黑名单之后，对方将可以：关注你、给你发私信、向你提问、评论你的答案、邀请你回答问题。",function(b){if(b){var b=Ic(c,k,"zm-item"),g=xa(L,b),b=new V(j);P(this.g(),b,"success",function(){g&&g();var b=Vb("zm-item",H("zh-setting-page-black-list-wrap"));(!b||!b.length)&&window.location.reload()});b.ajax(this.WT,"uid="+d)}},this)}};a.iz=function(){M.call(this);this.S=k;this.tj=0;this.FI="/oauth/friends/sina";this.RI="/invitation/sina";this.zc=new Hd(200)};y(iz,Hk);t=iz.prototype;t.v=function(){this.Sh||(this.Sh=j,this.o(),this.Ha(),jz(this))};t.show=function(){this.v();this.S.w(j);var b=new Mb(this.S.h().offsetLeft,this.S.h().offsetTop);b.y=102;Yf(this.S.h(),b)};t.o=function(){var b=H("zh-invitation-sina-diag");b&&(this.e=b,this.S=new vi(k,m),this.S.Xa("邀请微博好友"),Fh(this.S,k),this.S.Y().appendChild(this.e))};
t.fa=function(b){if("cancel"===b.target.name)this.S.w(m);else if("invite"===b.target.name){var b=Vb("zm-item-checkbox-right",this.yj),c=[];z.forEach(b,function(b){b.checked&&(c.push(b.value),b.checked="")},this);c&&c.length&&(this.Ty=new V(j),this.g().c(this.Ty,"complete",this.uJ),this.Ty.ajax(this.RI,"sinaids="+c.join(",")))}};
a.kz=function(b,c){b.tj=c?b.tj+1:b.tj-1;b.vE.innerHTML=b.tj+""},a.jz=function(b,c){b.aF||(b.aF=j,b.xhr=new V(j),P(b.g(),b.xhr,"complete",b.of),b.xhr.ajax(b.FI,c?"force=1":""))};t.of=function(){this.aF=m;var b=Ge(this.xhr);b&&!b.r?this.setData(b):U(b.msg)};
t.setData=function(b){this.lL=j;this.oU.innerHTML=+b[0];this.tj=+b[1];this.vE.innerHTML=this.tj+"";this.data=b=b[3];var c=[];z.forEach(b,function(b){c.push(['<div class="zm-item zm-item-h50"><input type="checkbox" value="',b[0],'" class="zm-item-checkbox-right" /><img class="zm-list-avatar-medium" src="',b[2],'" /><div class="zm-list-content"><strong class="zg-gray-normal">',b[1],'</strong><div class="zg-gray-normal">',b[3],"</div></div></div>"].join(""))},this);this.yj.innerHTML=c.join("")};
t.Ha=function(){this.it=J("zg-form-text-input",this.e);(new Nl("搜索微博好友")).n(this.it);this.Ei=J("zm-command",this.e);this.yj=H("zh-invitation-sina-friends-list");this.SR=H("zh-invitation-sina-force-refresh");this.g().c(this.SR,"click",function(){this.yj.innerHTML="列表刷新中，请稍侯...";jz(this,j)});this.g().c(this.yj,"click",this.LP);var b=Ub("strong",k,this.e);this.oU=b[0];this.vE=b[1];this.g().c(this.it,"focus",this.Xz).c(this.it,"blur",this.aA).c(this.zc,Id,this.RQ);this.g().c(this.Ei,"click",this.fa)};
t.LP=function(b){var c=Ic(b.target,k,"zm-item");if(c){var d=k,e=Ub("input",k,c)[0];if(D.has(c,"zm-item-active"))D.remove(c,"zm-item-active"),kz(this,j),d=m;else{var g;0>=this.tj?(U("您的邀请码已经用完"),g=m):g=j;g?(D.add(c,"zm-item-active"),kz(this,m),d=j):"INPUT"===b.target.tagName&&b.preventDefault()}"INPUT"!==b.target.tagName&&(e.checked=d);b.stopPropagation()}};t.Xz=function(){this.zc.start()};t.aA=function(){this.zc.stop()};
t.RQ=function(){if(this.lL){this.items||(this.items=Vb("zm-item",this.yj));var b=this.it.value;b==k||""===b?z.forEach(this.items,function(b){R(b,j)}):z.forEach(this.data,function(c,d){this.items[d]&&(b===c[0]||-1<c[1].indexOf(b)?R(this.items[d],j):R(this.items[d],m))},this)}};t.uJ=function(){var b=Ge(this.Ty);b&&!b.r?(U("邀请发送完毕"),this.S.w(m)):U(b.msg)};a.lz=function(){M.call(this);this.zI="/oauth/unbind/sina"};y(lz,Hk);lz.prototype.v=function(){var b=H("zh-invite-send-invite-sina");b&&this.g().c(b,"click",this.ZS);(b=H("zh-invitation-cancel-bind-sina"))&&this.g().c(b,"click",this.XQ)};lz.prototype.ZS=function(){this.tH||(this.tH=new iz);this.tH.show()};
lz.prototype.XQ=function(){Ai("解除绑定","你确定要解除与新浪微博的绑定吗？",function(b){if(b){var c=new V(j);P(this.g(),c,"success",function(){var b=Ge(c);b&&!b.r?window.location.reload():U(b.msg)});c.ajax(this.zI)}},this)};a.mz=function(b){M.call(this);this.url=b||"/topic"};y(mz,Hk);t=mz.prototype;t.n=function(b){this.element=b;var c=$("<ul>");this.OH=$("<li>");c.append(this.OH);$(b).append(c);this.PH||(this.PH=j,this.tA=new V(j),P(this.g(),this.tA,"success",this.hQ),this.tA.ajax(this.url,k,"POST"))};t.hQ=function(){var b=Ge(this.tA);b&&(b&&b.r?U(b.msg):(nz(this,this.OH,b.msg),this.PH=m,this.z()))};t.z=function(){this.g().c(this.element,"click",this.Co)};
t.Co=function(b){var c=(b=b.target)?b.name:"";if(c)switch(c){case "load":case "loadmore":if(!this.po){var c=b.getAttribute("data-token"),d=b.getAttribute("data-parent");this.po=j;this.Bj=new V(j);P(this.g(),this.Bj,"success",this.$p);this.uz=b.parentNode;this.uz.innerHTML='<span class="zg-gray">加载中...</a>';this.Bj.ajax(this.url+"?child="+c+"&parent="+d,k,"POST")}break;case "topic":window.location.href=b.href}};
a.nz=function(b,c,d){var e=d[0],g="";"topic"!==e[0]&&e[3]&&(g='data-parent="'+e[3]+'"');c.html('<a href="'+("topic"===e[0]?"/topic/"+e[2]+"/organize/entire":"javascript:;")+'" data-token="'+e[2]+'" '+g+' name="'+e[0]+'">'+e[1]+"</a><ul class='zm-topic-organize-list'></ul>");"topic"!==d[0][0]&&c.addClass("zm-topic-organize-loadmore");c=$("ul",$(c));if(1<d.length){d=d[1];for(e=0;e<d.length;e++){var g=d[e],h=$("<li>").addClass("zm-topic-organize-item");c.append(h);nz(b,h,g)}}};
t.$p=function(){var b=Ge(this.Bj);if(b)if(b&&b.r)U(b.msg);else if(b=b.msg,b[1]){$(this.uz).hide();for(var c=$(this.uz.parentNode),d=0;d<b[1].length;d++){var e=b[1][d],g=$("<li>").addClass("zm-topic-organize-item");"topic"!==e[0][0]&&g.addClass("zm-topic-organize-loadmore");c.append(g);nz(this,g,e)}this.po=m}};a.oz=function(b,c,d){cq.call(this,b,c,d)};y(oz,cq);oz.prototype.pf=function(b){Eg[0][0]===b?this.gh():oz.m.pf.apply(this,arguments)};oz.prototype.pB=function(b){if(b=Ge(b.target))b.r?U(b.msg):b.msg&&(window.location.href=b.msg)};a.pz=function(b){this.Bc=this.au=k;F.extend(this.F={},this.R,b||{})};y(pz,T);pz.prototype.R={options:{},nK:".zh-answers-filter",AR:".zh-answers-filter-popup"};
pz.prototype.z=function(){pz.m.z.call(this);var b=this,c=this.F,d=$(this.e),e=$(c.nK,d),g=$(c.AR,d);b.au=g;e&&(A&&e.add(g).css("line-height","25px"),e.attr("tabindex",0),this.au.html(qz(this)),e.add(g).hover(function(){g.show()},function(){g.hide()}),g.on("click",".selectable",function(){var c=$(this),d=c.text(),c=c.data("key");g.hide();$(".lbl",e).text(d);b.Bc=c;b.au.html(qz(b));b.dispatchEvent({type:"change",data:{key:c}});W.X({type:"ga_click_sorter_item",target:b,data:{key:c}})}))};
pz.prototype.U=p("Bc");pz.prototype.sa=ca("Bc");a.qz=function(b){var c=b.Bc;return $.map(b.F.options,function(b,e){return'<div tabindex="0" class="'+(e===c?"active":"selectable")+'" data-key="'+e+'"><span class="lbl">'+b+'</span><i class="zg-icon zg-icon-double-arrow"></i></div>'}).sort(function(b){return 0<=b.indexOf("active")?-1:1}).join("")};a.rz=function(){T.call(this);var b=Eg;this.Cf=b[0][3];this.Kt=b[0];this.QY=b[1];this.gY=b[2];this.pY=b[3];this.Wm=b[4];this.co=b[5];this.Jj="topic"};y(rz,T);t=rz.prototype;t.v=function(){Ar.M(this);this.n(document.body)};
t.z=function(){function b(b){b&&b.msg&&U(b.msg)}rz.m.z.call(this);var c=H("zh-topic-side-head");if(c){var d=J("zu-entry-focus-button",c);(this.UL=d)&&this.g().c(d,"click",function(){ok(d,"topic","",["zg-btn-green","zg-btn-white"])});(this.gg=H("zh-topic-operation-menu"))&&this.g().c(this.gg,"click",this.Kz)}if(c=H("zh-current-topic-bio")){var e=new cq(j,"/topic/bio/update","bio");e.de=["tid="+this.Cf];e.Ab='<a href="javascript:;" name="edit">你在 '+this.Kt[0]+" 话题中的经验</a>";e.Rq=j;e.n(c)}(c=H("zh-topic-top-answerer"))&&
(new Bn(c,"people",["zg-follow","zg-unfollow"])).v();if(c=H("zh-topic-direct-question-list"))c=new Oy(c,k,"question",k,j),c.wf("question-item"),c.v();if(c=H("zh-topic-log-list"))c=new Oy(c,k,k,k,j),c.km(Iy),c.v();if(c=H("zh-topic-title"))this.Hd=new oz(m,"/topic/update","title"),this.Hd.de=["tid="+this.Cf],this.Hd.n(c),$(c).on("click",".js-pin",function(){var b=$(this),c=b.attr("data-action");$.post(c,{tid:Eg[0][3]}).done(function(c){c.r?U(c.msg):b.replaceWith(b.hasClass("pin")?'<a href="javascript:;" data-action="/pin-topic/remove" class="js-pin zg-gray unpin topic-hover-content"><i class="z-icon-unpin"></i>取消固定</a>':
'<a href="javascript:;" data-action="/pin-topic/add" class="js-pin zg-gray pin topic-hover-content"><i class="z-icon-pin"></i>固定话题</a>')})});if(c=H("zh-topic-desc"))e=$(c).find(".zm-editable-content").data("editable-maxlength"),this.rn=new fq(j,"/topic/update","description",e),this.rn.Ab='<a href="javascript:;" name="edit">添加话题描述</a></div>',this.rn.de=["tid="+this.Cf],this.rn.tq=m,this.rn.$H=m,this.rn.n(c);if(c=H("zh-topic-faq"))this.er=new fq(j,"/topic/"+encodeURIComponent(Eg[0][1])+"/faq","content",
400),this.er.Ab='<div class="zm-topic-faq-container"><div class="zg-gray-normal">常见问题是该话题下经常会提到的问题的整理，以便后来者查阅（<a href="http://www.zhihu.com/question/20388061" class="zg-link-litblue">如何创建？</a>）</div><a href="javascript:;" name="edit" class="zg-link-litblue"><span class="zg-blue-edit"></span>为「'+Eg[0][0]+"」添加常见问题</a></div>",this.er.lZ=function(b){return!b?"":b.replace(/(<\/?(?!ul|li|a|br)[^>\/]*)\/?>/gi,"")},this.er.tq=m,this.er.n(c);if(Mg)$("div.topic-avatar").addClass("disabled");else if(c=J("zm-entry-head-avatar-edit-button")){var e=
new qy("topic"),g=J("zm-avatar-editor-preview");e.n(c);N(e,"beforepost",function(){$("<div class='avatar-edit-preview-loading topic'><span></span></div>").appendTo(g.parentNode)});N(e,"success",function(b){g&&(g.src=b.src);$(".avatar-edit-preview-loading").remove()})}if(c=H("zh-topic-feed-list"))e=new Qt,this.M(e),e.Ya("locationSource",{Rx:0,offset:function(b){return z.rf(b).getAttribute("data-score")}}),e.Ya("childConstructor",{Eh:Bx}),e.n(c),this.g().c(e,"click!",function(b){"comment"===b.namespace&&
b.bd.fill("category",this.Jj).fill("label","topic_activity")});if(c=H("zh-topic-top-page-list"))e=new Qt({Iz:m}),this.M(e),e.Ya("childConstructor",{Eh:Bx}),e.n(c),this.g().c(e,"click!",function(b){"comment"===b.namespace&&b.bd.fill("category",this.Jj).fill("label","topic_activity")});var h=this;h.yb&&h.g().c(h.yb,"afterload",function(b){W.X({type:"ga_click_topic_more",data:b.data,target:h.yb.Xb})});if(c=H("zh-topic-followers-list-wrap"))c=new Oy(c,["/topic",encodeURI(this.Kt[1]),"followers"].join("/"),
k,["zg-btn-follow","zg-btn-unfollow"],j),c.wf("zm-person-item"),c.v();if(H("zh-topic-organize-page-wrap")){if(c=H("zh-topic-organize-parent-editor"))e=new ts(k,this.Cf,j),e.vs=j,e.n(c),e.sB=m,e.addEventListener("remove_tag",function(b){(b=b.data&&b.data.id)&&$("#wedge-"+b).remove()});if(c=H("zh-topic-organize-child-editor"))e=new ts(k,this.Cf,m),e.vs=j,e.n(c),$("a.entire-link").insertAfter(e.sn).show();$("#zm-topic-manage-relation").on("change",'[type="checkbox"]',function(){var b=$(this).closest("li").attr("id").split("-")[1];
$.post("/topic/update",{action:"set_topic_edge",parent_topic_id:b,topic_id:Eg[0][3],edge:this.checked^0}).done(function(b){b&&b.msg&&U(b.msg)})});this.xu=H("zh-topic-alias-input");new Rm(this.xu,"输入话题别名");this.yu=H("zh-topic-alias-list");this.g().c(H("zh-topic-alias-container"),"click",this.UQ);if(c=H("zh-topic-merge"))this.Na=new Rs,this.Na.n(c);(c=H("zh-topic-merge-btn"))&&this.g().c(c,"click",this.wQ)}(c=H("zh-topic-organize-page-children"))&&(new mz("/topic/"+encodeURIComponent(Eg[0][1])+"/organize/entire")).n(c);
if(c=H("zh-topic-side-related-topics"))this.UR=c,this.cz=new V(m),this.g().c(this.cz,"complete",this.GQ),this.cz.ajax("/topic/related?tid="+this.Cf);H("zh-topic-admin-page-wrap")&&(c=H("zh-topic-del-btn"))&&this.g().c(c,"click",this.dQ);if(c=H("zh-topic-log-list-wrap"))c=new Oy(c,["/topic",encodeURI(this.Kt[1]),"log"].join("/"),k,["zg-btn-follow","zg-btn-unfollow"],j),c.km(Iy),c.v();this.px();Cr();(c=H("zh-topic-search-query-wrap"))&&(new Cx(c.getAttribute("data-tip"))).n(c);(c=J("zm-topic-search-input-new"))&&
new Rm(c,"在话题中搜索");var l=$(c);Bg.vc||l.focus(function(){l.addClass("stretch-to")}).blur(function(){l.removeClass("stretch-to")});(c=J("zm-topic-ask-in-topic"))&&this.g().c(c,"click",this.rt);(c=J("zm-topic-feed-container"))&&(new Bn(c,"question",["zg-follow","zg-unfollow"])).v();(c=H("zh-topic-side-children-list"))&&(new Bn(c,"topic",["zg-follow","zg-unfollow"])).v();(this.Lr=H("zh-topic-info-add"))&&this.g().c(this.Lr,"submit",this.rQ);(this.lE=J("zm-topic-info-content-main",this.e))&&this.g().c(this.lE,
"click",this.pQ);$("#zh-topic-manage-info-form").on("change",'input[type="radio"]',function(){$.post("/topic/"+Eg[0][1]+"/information/manage",{info:$(this).val(),action:"change"}).done(b)});$("#zh-topic-manage-relation-form").on("change",'input[type="radio"]',function(){$.post("/topic/update",{action:"set_topic_weaknode",topic_id:Eg[0][3],weak:$(this).val()}).done(b)});$("#zh-topic-manage-lock-form").on("change",'[type="checkbox"]',function(){$.post("/topic/lock",{url_token:Eg[0][1],lock_type:this.name,
lock_value:$(this).is(":checked")?1:0}).done(b)});(c=H("zh-topic-info-add"))&&z.forEach(oc(c),function(b){var c;b&&(b.getAttribute&&(c=b.getAttribute("data-placeholder")))&&new Rm(b,c)});S.Ld||$(".js-may-disable").click(function(){Vn.D().w(j);return m})};
t.wQ=function(){this.Jq=this.Na.zC;if(!this.kF&&this.Jq){this.kF=j;this.cy=new V(j);P(this.g(),this.cy,"success",this.vJ);this.cy.ajax("/topic/"+encodeURIComponent(Eg[0][1])+"/demand","action=merge&target_topic_id="+this.Jq[3]);var b=H("zh-topic-merged-msg");R(H("zh-topic-merge"),m);R(b,j);b=Ub("a",k,b)[0];b.href="/topic/"+this.Jq[1];b.innerHTML=this.Jq[0];this.Na&&(this.Na.Sa.value="")}};t.vJ=function(){var b=Ge(this.cy);b&&b.r?U(b.msg):this.kF=m};
t.dQ=function(){this.HC||(this.HC=j,this.uv=new V(j),P(this.g(),this.uv,"success",this.qJ),this.uv.ajax("/topic/"+encodeURIComponent(Eg[0][1])+"/demand","action=remove"))};t.qJ=function(){var b=Ge(this.uv);b&&b.r?U(b.msg):(b=H("zh-topic-del-msg"),R(H("zh-topic-del-btn"),m),R(b,j),this.Na&&(this.Na.Sa.value=""),this.HC=m)};
t.UQ=function(b){if((b=b.target)&&b.name)if("add"===b.name){if(b=this.xu.value)this.zu=new V(j),P(this.g(),this.zu,"complete",this.nJ),this.zu.ajax(window.location.href,"action=add_alias&alias="+encodeURIComponent(b))}else"remove"===b.name?(this.dz=new V(j),b=b.parentNode.getAttribute("data-token"),P(this.g(),this.dz,"complete",this.AJ),this.dz.ajax(window.location.href,"action=remove_alias&alias_token="+b)):"remove-merged"===b.name&&(this.gz=new V(j),b=b.parentNode.getAttribute("data-token"),P(this.g(),
this.gz,"complete",this.BJ),this.gz.ajax("/topic/"+encodeURIComponent(Eg[0][1]+"/demand"),"action=remove&target_topic_id="+b))};t.BJ=function(){var b=Ge(this.gz);b&&b.r?U(b.msg):sz(this,b.msg)};t.AJ=function(){var b=Ge(this.dz);b&&b.r?U(b.msg):sz(this,b.msg)};a.sz=function(b,c){var d=Ub("li",k,b.yu);z.forEach(d,function(b){b.getAttribute("data-token")===c[1]&&R(b,m)})};
t.nJ=function(){var b=Ge(this.zu);if(b&&b.r)U(b.msg);else{var b=b.msg,c=K("li");c.setAttribute("data-token",b[1]);c.innerHTML=b[0]+' <a name="remove" href="javascript:;" class="zg-link-gray">移除</a>';this.yu.appendChild(c);this.xu.value="";R(this.yu.parentNode,j)}};t.Kz=function(b){this.Ey?this.kb.Q()?this.kb.w(m):(this.kb.w(j),b.stopPropagation(),b.preventDefault(),this.Lk()):(b.stopPropagation(),b.preventDefault(),this.qj(),this.Lk());this.Ey=j};t.Lk=function(){P(this.g(),document,"click",function(){this.kb.w(m)})};
t.qj=function(){var b=H("zh-topic-side-head"),c=this.gg.getAttribute("data-auth");this.kb=new iu;this.Ww=j;"f-topic-manage"===c&&this.kb.Da(this.aR=new fu("管理话题"));this.kb.Da(this.bR=new fu("组织话题"));this.kb.Da(this.$Q=new fu("话题日志"));this.Ww&&(this.kb.W(b),this.g().c(this.kb,"action",this.hj))};t.hj=function(b){var c="";b.target===this.aR?c="admin":b.target===this.bR?c="organize":b.target===this.$Q&&(c="log");window.location.href=["/topic",this.Kt[1],c].join("/")};
t.GQ=function(){var b=Ge(this.cz);if(b&&!b.r){var c=[];z.forEach(b,function(b){c.push($j(b,k,j))});this.UR.innerHTML=c.join("")+'<div class="zg-clear"></div>';b.length&&R(H("zh-topic-side-related-topics-wrap"),j)}};t.px=function(){var b=H("zh-topic-search-list");b&&(this.yb=new Ax(b,k,j),this.yb.wf("zm-search-result-item"),this.yb.xs=function(b){if(b&&0!==b.length)return b[b.length-1].getAttribute("data-offset")},this.yb.v())};
t.pQ=function(b){var c=b.target;c&&c.name&&"remove"===c.name&&(this.eO=c,this.mE||(this.mE=j,this.jx=new V(j),this.g().c(this.jx,"success",this.qQ),b="token="+this.eO.parentNode.getAttribute("data-token")+"&action=remove&element="+encodeURIComponent($(b.target).prev("[data-element]").text()),this.jx.ajax("/topic/"+Eg[0][1]+"/information/manage",b,"POST")))};t.qQ=function(){this.mE=m;var b=Ge(this.jx);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,J("zm-topic-info-content-main",this.e).innerHTML=$(b).html()))};
t.rQ=function(b){b.preventDefault();this.nE||(this.nE=j,this.lx=new V(j),this.g().c(this.lx,"success",this.oQ),b=oc(this.Lr),this.lx.ajax("/topic/"+Eg[0][1]+"/information/manage","title="+b[0].value+"&content="+b[1].value+"&url="+b[2].value+"&action=add","POST"))};t.oQ=function(){this.nE=m;var b=Ge(this.lx);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,J("zm-topic-info-content-main",this.e).innerHTML=$(b).html(),b=oc(this.Lr),z.forEach(b,function(b,d){3>d&&(b.value="")})))};
t.rt=function(){if(!sn())if(S.Ld){var b=Vq.D();b.show();var c=J("zm-topic-search-input-new");c.value&&Yq(b,c.value);b.Na.data.length||b.Na.ck(Eg[0])}else Vn.D().w(j)};a.tz=function(b){T.call(this,b)};y(tz,T);tz.prototype.o=function(){this.e=this.H().o("FORM",{method:"POST",style:"display:none"})};tz.prototype.post=function(b,c,d){var e=this.h();e||(this.W(),e=this.h());e.action=c||"";e.target=d||"";var c=e,g,h=new Vr;for(g in b)d=b[g],ma(d)?z.forEach(d,v(this.BB,this,h,g)):this.BB(h,g,d);c.innerHTML=h.toString();e.submit()};tz.prototype.BB=function(b,c,d){b.append('<input type="hidden" name="',Ua(c),'" value="',Ua(d),'">')};a.uz=function(){M.call(this)};y(uz,Hk);uz.prototype.v=function(){var b=cs(new tf(window.location.href),"group_id");b&&(this.Gj=new V(m),P(this.g(),this.Gj,"success",this.Ny),b&&this.Gj.ajax("/noti7/read","group_id="+b,"POST"))};uz.prototype.Ny=function(){var b=Ge(this.Gj);if(b&&!b.r&&b.msg){var c=b.msg;if(c===j||"true"===c||"True"===c)return;this.HP=b.msg;this.dispatchEvent("change")}(b=fl)&&gl(b)};a.vz=function(){T.call(this);var b=Gg||[0,0];this.gs=b[0];this.visible=!!b[1];this.Jj="collection"};y(vz,T);t=vz.prototype;t.v=function(){Ar.M(this);this.n(document.body)};
t.z=function(){vz.m.z.call(this);var b=H("zh-list-side-head");if(b){var c=J("zu-entry-focus-button",b);(this.UL=c)&&this.g().c(c,"click",function(){ok(c,"favlist","",["zg-btn-green","zg-btn-white"])});(this.gg=H("zh-list-operation-menu"))&&this.g().c(this.gg,"click",this.Kz)}(b=H("zh-single-answer-author-info"))&&(new Bn(b)).v();(b=H("zh-list-create-new-list"))&&this.g().c(b,"click",this.US);(b=H("zh-fav-list-side-bar-creator"))&&(new Bn(b)).v();(b=H("zh-fav-list-side-bar-report"))&&this.g().c(b,
"click",this.Ol);(this.sk=H("zh-favlist-webshare-container"))&&this.g().c(this.sk,"click",this.Mz);if(this.Wb=H("zh-list-meta-wrap"))this.g().c(this.Wb,"click",this.Ol),this.pX=H("zh-list-comment-num"),cs(new tf(location.href),"fc")&&this.cl();(b=H("zh-favlists-wrap"))&&(new Oy(b,k,"favlist",k,j)).v();if(b=H("zh-list-answer-wrap"))$(b).on("click","a[name=unfavo]",$.proxy(this.GN,this)),b=new Ax(b,k,j),this.M(b),this.g().c(b,"click!",function(b){"comment"===b.namespace&&b.bd.fill("category",this.Jj).fill("label",
"collection_answer")}),b.wf("zm-item-fav"),b.v();(b=H("zh-favlist-log-list-wrap"))&&(new Oy(b,k,"favlist",k,j)).v();(b=H("zh-favlist-following-wrap"))&&(new Oy(b,k,"favlist",k,j)).v();if(b=H("zh-favlist-followers-wrap"))b=new Oy(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j),b.wf("zm-profile-section-item"),b.BA(j),b.v();this.g().c(window,"hashchange",this.HY);this.xo=new uz;this.xo.v()};
t.GN=function(b){var b=b.target,c=b.id.split("-"),d=c[1],c=c[2];(new V(j)).ajax("/collection/remove","answer_id="+d+"&favlist_id="+c);if(c=Ic(b,"div","zm-item"))b=Vb("zm-item-answer",c),1===b.length?L(c):(b=z.find(b,function(b){return b.getAttribute("data-aid")===d}))&&L(b.parentNode)};
t.Mz=function(b){if((b=kk(this.sk,b.target))&&b.name){this.Jd||(this.Jd=vu.D());var c=sf(new tf(location.href)),d=/collection\/(\w+)\//.exec(c);d&&(c="/collection/"+d[1]);xu(this.Jd,Gg[0],c,"f");this.Jd.show();yu(this.Jd,"tb-webshare-"+b.name)}};t.US=function(){Wu().show()};t.Kz=function(b){this.Ey?this.kb.Q()?this.kb.w(m):(this.kb.w(j),b.stopPropagation(),b.preventDefault(),this.Lk()):(b.stopPropagation(),b.preventDefault(),this.qj(),this.Lk());this.Ey=j};
t.Lk=function(){P(this.g(),document,"click",function(){this.kb.w(m)})};t.qj=function(){var b=H("zh-list-side-head");this.kb=new iu;this.Ww=j;this.visible||this.kb.Da(this.dR=new fu("设置为公开"));this.kb.Da(this.ZQ=new fu("删除此收藏夹"));this.Ww&&(this.kb.W(b),this.g().c(this.kb,"action",this.hj))};
t.Ol=function(b){b=b.target;switch(b&&b.name){case "report-favlist":Wt.am("favlist",this.gs);break;case "edit":bv(Wu());break;case "addcomment":this.cl();this.la.he();this.la.ic()&&this.la.mi("view_comments",parseInt(Fc(b),10)||0);break;case "remove":wz(this)}};
t.hj=function(b){b.target===this.dR?Ai("确定设置收藏夹为公开？","收藏夹设置为公开后，将不能再设置为私密。",function(b){b&&(this.wY=!this.visible,this.XH=new V(j),this.g().c(this.XH,"complete",function(){window.location.reload()}),this.XH.ajax("/collection/update","favlist_id="+this.gs+"&is_public=1"))},this):b.target===this.ZQ&&wz(this)};a.wz=function(b){Ai("删除收藏夹","你确定要删除这个收藏夹吗？",function(b){b&&(b=new lk,b.add("favlist_id",this.gs),b.add("_xsrf",(new If(document)).get("_xsrf")),(new tz).post(as(b),"/collection/delete"))},b)};
t.cl=function(){this.la||(this.la=new Rw(this.gs,"favlist"),this.M(this.la),this.g().c(this.la,"click!",function(b){"comment"===b.namespace&&(b.bd.fill("category",this.Jj).fill("label","collection"),b.bd.action=b.bd.action.replace("favlist","collection"))}),Uw(this.la,this.Wb,$(".toggle-comment",this.Wb)[0]))};a.xz=function(b,c){T.call(this);this.Sc=b;this.entryType=c;this.zn="zm-item-expanded"};y(xz,T);t=xz.prototype;t.Ek=k;
t.z=function(){xz.m.z.call(this);F.forEach({'a[name="expand"]':function(b){this.Ia(j);this.Fl&&(b.currentTarget.name="toggleExpanded")},'a[name="collapse"]':function(){this.Gu(this.e);this.Ia(m)},'a[name="toggleExpanded"]':this.he,'a[name="toggle-comment"]':function(b){this.li();this.la.ic()&&(b=parseInt(Fc(b.currentTarget),10)||0,this.la.mi("view_comments",b))},'a[name="share"]':this.hf},function(b,c){$(this.e).on("click",c,$.proxy(b,this))},this);var b=this.tp=new ox;this.M(b);Rc(this,b);this.g().c(b,
"expand",function(){this.Ia(j)});b.n(this.e);if(b=J("zm-votebar",this.e))this.Sb=new lv(this.Sc,this.entryType),Rc(this,this.Sb),this.Sb.n(b);if(b=J("zm-item-vote-info",this.e)){var c=this.pZ=new ov(this.Sc,this.entryType);Rc(this,c);c.n(b);this.Sb&&c.g().c(this.Sb,"change",c.Tj)}this.uh()};t.Gu=function(b){var c=b.getBoundingClientRect().bottom;setTimeout(function(){var d=b.getBoundingClientRect().bottom,e=rs(document);window.scrollTo(e.x,e.y+d-c)})};t.ic=function(){return D.has(this.e,this.zn)};
t.he=function(){this.Ia(!this.ic())};t.Ia=function(b){if(b===this.ic())return m;D.enable(this.e,this.zn,b);this.tp&&this.tp.Ia(b);this.dispatchEvent(b?"expand":"collapse");return j};
t.uh=function(){var b=this.ZY=Uj.GA(this.e);Tj(Rj(b,"v",function(){this.Sb&&this.Sb.pA()},this),{group:"操作",name:"赞同"});Tj(Rj(b,"d",function(){this.Sb&&this.Sb.oA()},this),{group:"操作",name:"反对"});Tj(Rj(Tj(Rj(Tj(Rj(Tj(Rj(Tj(Rj(b,"o",this.he,this),{group:"操作",name:"显示全部/收起"}),"c",this.li,this),{group:"操作",name:"打开评论"}),"f x",this.hf,this),{group:"操作",name:"分享"}),"shift+c",this.Iw,this),{group:"操作",name:"定位到评论框"}),"shift+o",this.eR,this),{group:"操作",name:"新窗口打开条目"})};
t.hf=function(){this.Jd||(this.Jd=vu.D());xu(this.Jd,this.Sc,"/"+this.entryType+"/"+this.Sc,"p");this.Jd.show();yu(this.Jd,"tb-webshare-sina")};t.li=function(){this.cl();this.la.he()};t.Yi=p("la");t.Iw=function(){this.la?this.la.field.focus():this.li()};t.cl=function(){if(!this.la){var b=$(".toggle-comment",this.e)[0];this.la=new Rw(this.Sc,this.entryType);this.M(this.la);Uw(this.la,$(".zm-item-meta",this.e).get(0),b)}};a.yz=function(){xz.call(this);this.entryType="post"};y(yz,xz);t=yz.prototype;t.z=function(){this.Sc=this.e.getAttribute("data-pid");yz.m.z.call(this)};t.eR=function(){window.open($(".post-link",this.e).attr("href"))};t.Ia=function(b){yz.m.Ia.call(this,b)&&this.Ez(b)};t.Ez=function(b){var c=this.Qr();c&&Ip(c,b)};
t.Qr=function(){if(this.ke)return this.ke;var b=!sb,c=J("zm-editable-content",this.e),d=this.Sb&&this.Sb.h();b&&(d&&$(d).is(":visible")&&c&&230<$(c).height())&&(this.ke=new Lp(k,c),this.M(this.ke),this.ke.ji="votebar",this.ke.Jy=50,this.ke.n(d))};a.zz=function(b,c,d){ju.call(this,b,c,d)};y(zz,ju);zz.prototype.of=function(b){b&&!b.r&&(b=b.msg,b.length?(R(this.Xb,0<b.length),this.offset+=b.length,this.Fu(b),lu(this,m),ou(this)):this.xk.hide())};a.Az={ARTICLE_VOTE_UP:"post_vote",ARTICLE_CREATE:"post_create",RECOMMENDED:"feed_recommended",QUESTION_FOLLOW:"feed_question_follow",QUESTION_CREATE:"feed_question",ANSWER_VOTE_UP:"feed_answer_vote",ANSWER_CREATE:"feed_answer_answer"};
zz.prototype.MN=function(b){var c=b.currentTarget.e.getAttribute("data-feedtype"),c=Az[c];"comment"===b.namespace&&c&&b.bd.fill("category","feed").fill("label",c)};zz.prototype.Ij=function(b){var c;c="p"===b.getAttribute("data-type")?new yz:new Bx;this.M(c);this.g().c(c,"click!",this.MN);c.n(b);N(c,"ignore",v(function(b){this.dispatchEvent({type:"ignore",V:b.V})},this));return c};zz.prototype.sG=function(b){return{params:b,method:"next"}};a.Bz=function(){this.interval=3E4};ia(Bz);a.Dz=function(b,c){if(!b.zc||c)c&&clearInterval(b.zc),b.zc=setInterval(v(function(){Cz(this)},b),b.interval)},a.Cz=function(b,c){$(".feed-item-hook .time").each(function(){$(this).text(Zs($(this).data("timestamp")))});c&&Dz(b,c)};a.Ez=function(){T.call(this);this.Fx={};this.us=[];this.eD=(this.FO="old"===$("#feed-ver").val()?j:m)?"zm-item":"feed-item-hook"};y(Ez,T);
Ez.prototype.z=function(){Ez.m.z.call(this);this.G=$(this.e);(this.kl=H("zh-main-feed-fresh-button"))&&this.g().c(this.kl,"click",this.YS);this.yb=new zz(this.e,k,j);this.getParent()&&this.getParent().M(this.yb);var b="/node/"+$(this.e).data("init").nodename;this.yb.url=b;this.yb.wf("feed-item-hook");this.g().c(this.yb,"itemcreated",function(b){Fz(this,b.data.TO)}).c(this.yb,"afterload",function(b){W.X({type:"ga_click_feed_more",data:b.data})}).c(this.yb,"ignore",function(b){var c=b.V;F.forEach(this.Fx,
function(b){b.V===c&&$(b.e).fadeOut()})});this.yb.v();this.g().c(W,"homefeed",this.hN);this.G.on("click",".js-more-similar",function(){$(this).parent().slideUp("fast").nextUntil(":not(.hidden)").slideDown("fast")});var c=this;this.G.on("click",".js-change-some",function(){rk("feed","intrests-change");var b=$(this),e=$(this).parent().parent();$.post("/node/HomeExtraFeedList",{method:"next",params:{}}).done(function(g){!g.r&&g.msg&&(0<g.msg.length?(e.find(".feed-item-hook").remove(),e.append(g.msg).find(".feed-item-hook").each(function(){c.yb.Ij(this)})):
b.replaceWith('<span class="zg-right zg-gray">没有更多内容了</span>'))})})};
Ez.prototype.YS=function(){var b=J("zm-home-question-list-devider",this.e);b&&D.remove(b,"zm-home-question-list-devider");var b=this.us.length,c=$("."+this.eD,this.e)[0];c&&5<=b&&($(".feed-separator-hook",this.e).next(".feed-item-hook").css("border-top","1px solid #eee").end().remove(),$(c).css("border-top","none").before('<div class="feed-item-hook feed-separator-hook feed-separator"><span>上次你看到这里</span></div>'));z.forEach(this.us,function(b){var c=$("."+this.eD,this.e)[0];c?jc(b,c):this.e.appendChild(b)},
this);this.us=[];R(this.kl,m);c=Bz.D();Cz(c,j);W.X({type:"ga_click_feed_fresh",data:{count:b}})};Ez.prototype.hN=function(b){var c=Ka(b.sb),b=this.us,d=b.length;if(c&&!(500<d)){var c=fc(c),e=this.yb.Ij(c),g=this.Fx;if(e.ka){if(F.Vv(g,function(b){return b.ka===e.ka}))return}else if(e.V){if(F.Vv(g,function(b){return b.V===e.V}))return}else if(e.Sc&&F.Vv(g,function(b){return b.Sc===e.Sc}))return;Fz(this,e);b.push(c);d+=1;this.kl&&(this.kl.innerHTML=(99<d?"99+":d)+" 条新动态",R(this.kl,j))}};
a.Fz=function(b,c){var d=gh(fh.D());b.Fx[d]=c;$(c.e).attr("data-fid",d)};a.Gz=function(){};y(Gz,T);t=Gz.prototype;t.z=function(){Gz.m.z.call(this);var b=H("zh-invite-select");b&&this.g().c(b,"change",this.zy);(b=J("zm-invite-list"))&&this.g().c(b,"click",this.fa);(this.bx=H("zh-invite-ignore-all-btn"))&&this.g().c(this.bx,"click",this.$N)};
t.fa=function(b){if((b=b.target)&&b.name){if("ignore"===b.name){this.$X=b;this.aY=j;D.add(b,"zg-btn-disabled");this.aO=new V(m);var c="qid="+b.getAttribute("data-qid")+"&uid="+S[3]+"&op=pass";this.aO.ajax("/question/askpeople",c,"POST");(c=b.parentNode)&&Zj(c,j)}"recover"===b.name&&!this.EG&&(this.CG=b,this.EG=j,D.add(b,"zg-btn-disabled"),b.innerHTML="...",this.DG=new V(m),this.g().c(this.DG,"success",this.zJ),b="qid="+b.getAttribute("data-qid")+"&uid="+S[3]+"&op=recover",this.DG.ajax("/question/askpeople",
b,"POST"))}};t.zy=function(b){var c=cs(new tf(location.href),"filter_by");if((b=b.target)&&b.value)b=b.value,b!==c&&(window.location.href="/question/invited?filter_by="+b)};t.zJ=function(){this.EG=m;this.Zb(this.CG,"ignore");this.CG.name="ignore"};
t.Zb=function(b,c){var d=b.parentNode,e=J("zm-invite-item-info-label",d);"ignore"===c?(D.remove(b,"zg-btn-disabled"),D.remove(b,"recover"),D.add(b,"ignore"),D.add(d,"invite"),D.remove(d,"ignore"),e.innerHTML="新邀请",b.name="ignore",b.innerHTML="忽略"):(D.remove(b,"zg-btn-disabled"),D.remove(b,"ignore"),D.add(b,"recover"),D.remove(d,"invite"),D.remove(d,"draft"),D.add(d,"ignore"),e.innerHTML="已忽略",b.name="recover",b.innerHTML="恢复")};
t.$N=function(){this.cx||(this.cx=j,this.gE=new V(m),this.g().c(this.gE,"success",this.tJ),this.gE.ajax("/question/askpeople","uid="+S[3]+"&op=ignore_all","POST"))};t.tJ=function(){this.cx=m;R(this.bx);this.cx=m;z.forEach(Vb("zm-invite-item-control"),v(function(b){this.Zb(b,"recover")},this))};a.Hz=function(){T.call(this)};y(Hz,T);Hz.prototype.z=function(){Hz.m.z.call(this);this.ol();this.g().c(this.e,"click",this.fa)};Hz.prototype.fa=function(b){b=b.target;if(b.name)switch(b.name){case "fold":$(b).parent().hide().prev().animate({height:"show"},200);break;case "fold-follow":$(b).parent().hide().prev().show();break;case "unfold-item":$(b).parent(".author-list").hide().siblings(".hidden").show()}};
Hz.prototype.ol=function(){this.po||(this.po=j,this.Bj=new V(m),this.g().c(this.Bj,"success",this.vy),this.Bj.ajax("/noti7/calendar","","GET"))};Hz.prototype.vy=function(){this.po=m;var b=Fe(this.Bj);if(b){var c=H("zh-noti7-list-inner");/category/.test(b)?(c.innerHTML=b,c&&(b=new ju(c,"/noti7/calendar",j),b.Fu=function(b){var c=K("div","zm-item-more-wrap");c.innerHTML=b;jc(c,this.Xb)},b.yr=function(b){this.dk=this.Xb.getAttribute("data-next");return!b||b.msg[0]&&b.msg[1]},b.v())):c.innerHTML='<div class="empty"><span class="zg-gray-normal">您收到的消息会显示在这里</span></div>'}};a.Iz=function(){M.call(this);this.$w=[];this.DC=[]};y(Iz,Hk);Iz.prototype.v=function(){var b=H("home-suggest-block");b&&(this.e=b,b=H("home-suggest-close-button"),P(this.g(),b,"click",function(){(new V(j)).ajax("/option","key=no_show_lookup&value=1");R(this.e,m)}),b=H("home-suggest-refresh-button"),this.g().c(b,"click",this.FQ),this.oo=H("home-suggest-list"),(new Bn(this.oo,"people")).v(),Jz(this))};Iz.prototype.FQ=function(){Kz(this);return j};
a.Kz=function(b){for(var c=[],d=0;3>d;d++){var e=b.DC.shift();e&&c.push(e)}3===c.length?(b.oo.innerHTML=c.join(""),c=Vb("suggest-item",b.oo),z.forEach(c,function(b){this.$w.push(b.id.split("-")[1])},b)):Jz(b)},a.Jz=function(b){b.oo.innerHTML='<img class="bubble-loading" src="/static/img/noti-loading.gif">';$.post("/lookup/suggest_member",{ids:b.$w.join(",")}).done(v(b.aQ,b))};Iz.prototype.aQ=function(b){b.r||((b=b.msg)&&la(b)&&b.length?(this.$w=[],this.DC=b,Kz(this)):this.oo.innerHTML="下面没有了")};a.Lz=function(b){ya(this,b)},a.Mz=function(b){this.qF=b;this.G=$("<li>");this.mu()},a.Nz=function(b){this.LK=b;this.G=$("<ul>")};zt={};zt=function(){T.call(this)};y(zt,T);zt.prototype.z=function(){zt.m.z.call(this);this.aS()};zt.prototype.aS=function(){var b=this.e;$.get("/trending").done(function(c){c=$.map(c,Lz.$K);b.appendChild((new Nz(c)).W().G.get(0))})};
Lz.$K=function(b){var c={"0":"fullname",1:"url_token",2:"avatar",3:"id",4:"headline",5:"reason",6:"type"},b=z.reduce(b,function(b,e,g){b[c[g]]=e;return b},{});return new Lz(b)};Mz.prototype.Bf=tk('<a href="#" data-tip="s$r$不感兴趣" class="del"><i class="icon icon-ignore"></i></a><a data-tip="p$t$<%=url_token%>" href="/people/<%=url_token%>" class="avatar"><img src="<%=avatar%>"></a><div class="bd"><a href="/people/<%=url_token%>" data-tip="p$t$<%=url_token%>"><%=fullname%></a><div class="headline"><span title="<%-headline%>"><%-headline%></span></div><div class="ft"><span class="reason"><%=reason%></span> <span class="zg-bull">&bull;</span> <a class="zg-follow follow" href="#" id="sugg-<%=id%>">关注</a></div></div>');
Mz.prototype.mu=function(){var b=this.qF,c=this.G;c.on("click",".del",function(d){d.preventDefault();$.post("/un_trending",{id:b.id,type:b.type});c.remove()}).on("click",".follow",function(c){c.preventDefault();ok(this,b.type,xa(gk,this),k,{follow_text:"关注"})})};Mz.prototype.W=function(){this.G.html(this.Bf(this.qF));return this};Nz.prototype.W=function(){var b=this.G;$.each(this.LK,function(c,d){b.append((new Mz(d)).W().G)});return this};a.Oz=function(){T.call(this)};y(Oz,T);Oz.prototype.v=function(){Ar.M(this);this.n(document.body)};
Oz.prototype.z=function(){Oz.m.z.call(this);var b=H("js-home-feed-list");if(b){var c=new Ez;this.M(c);c.n(b)}this.rx();(b=J("zm-invite-container"))&&(new Gz).n(b);H("home-settings-page-wrap")&&(b=H("zh-topic-block-editor"))&&(new Qs(Hg)).n(b);(b=H("zh-noti7"))&&(new Hz).n(b);if(b=H("zh-plazza-topic-search-wrap"))c=H("zh-plazza-topic-search-input"),(new Nl("搜索话题")).n(c),this.J=new an("/topic-reg/autocomplete",c,k,k,b,m),this.J.yf(j),this.g().c(this.J,"select",function(){var b=z.slice(this.J.Xf(),1);
window.location.href="/topic/"+b[1]});if(c=H("zm-home-sidebar-domain-entry-link"))b=!!c.getAttribute("data-expanded"),c=new kq(c,H("zm-home-sidebar-domain-entry-nav"),b),b&&vd(c,"toggle",function(){Ci("/notifeature?feature=4",k,"GET");return j});$(".zm-side-pinned-topics").on("click",".unpin",function(){var b=$(this).parent();$.post("/pin-topic/remove",{tid:$(this).attr("data-tid")}).done(function(c){c.r||b.fadeOut()})});if(b=$("#zh-virgin-answer-list > .zh-general-list").get(0))c=new Qt,this.M(c),
c.Ya("nodeSource").Ya("childConstructor",{Eh:Bx}),c.n(b),this.g().c(c,"click!",function(b){"comment"===b.namespace&&b.bd.fill("category","debuts").fill("label","debuts")});(new Iz).v();var b=S[1],d=H("zu-welcome-once");d&&("welcome"===location.hash.slice(1)?(R(d,j),Lf.set("reg_noti_",b,86400)):b===Lf.get("reg_noti_")&&R(d,j),N(J("x-m",d),"click",function(){location.hash="";L(d);Lf.remove("reg_noti_")}));var e=$("#js-global-notify");if(e.length){var g=new Dp;g.n(e[0]);Xr(g);$(".zu-global-notify-close",
e).click(function(){var b=$(this).data("id");$.post("/notice/read",{nid:b});g.C();e.remove()})}b=Bz.D();Dz(b);var h=$("#js-debuts-entry .tour");h.length&&$(".close-button",h).click(function(){var b=$(this).data("feature");$.get("/notifeature",{feature:b});h.fadeOut(100,function(){h.remove()})})};Oz.prototype.rx=function(){var b=H("zh-trendings");b&&(this.TT=new zt).n(b)};a.Pz=function(){uh.call(this,k,m);this.RB="zh-lightbox-showing";this.AT="zh-lightbox-thumb";this.kf()};y(Pz,uh);ia(Pz);t=Pz.prototype;t.kf=function(){this.g().c(document,"click",this.rr)};
t.rr=function(b){b=b.target;if("IMG"===b.tagName&&D.has(b,this.AT)){var c=b.getAttribute("data-original");if(c)if(sb)window.open(c);else if(!Ic(b,k,"editable")){this.La('<div class="zm-light-box-x1" id="zm-light-box-x1"><div class="zm-light-box-x2" id="zm-light-box-x2"><img src="'+c+'" class="zm-light-box-img-el" /><div class="zm-light-box-footer"><a class="zm-light-box-show-origin" href="'+c+'" target="_blank">查看原图</a></div></div></div>');this.w(j);D.add(this.h(),"zm-light-box-fullscreen-image");
var c=Yb(),d=H("zm-light-box-x1"),e=H("zm-light-box-x2"),g=b.getAttribute("data-rawheight"),h=b.getAttribute("data-rawwidth"),h=h?+h:0;(g?+g:0)>c.height-80?e.style.marginTop="40px":d.style.lineHeight=c.height+"px";e.style.width=h>c.width-80?c.width-80+"px":h+"px";W.X({type:"ga_click_enlarge_image",target:b})}}};t.na=ha;t.focus=ha;t.Jw=function(){this.w(m);D.remove(document.body,this.RB)};t.$h=function(){Pz.m.$h.call(this);D.add(document.body,this.RB);P(this.g(),document,"click",this.Jw)};
t.o=function(){Pz.m.o.call(this);D.add(this.h(),"zm-light-box")};t.Zx=function(){this.Pc=this.H().o("div",this.Dc+"-bg zm-light-box-background");R(this.Pc,m)};Pz.D();a.Qz=function(b,c,d){fu.call(this,b,c,d);this.hi(j)};y(Qz,fu);Qz.prototype.ee=function(){return this.dispatchEvent("action")};sq("goog-option",function(){return new Qz(k)});a.Rz=function(){};y(Rz,Aq);ia(Rz);Rz.prototype.o=function(b){return b.H().o("div",this.K()+" goog-inline-block"," ")};Rz.prototype.n=function(b,c){c=Rz.m.n.call(this,b,c);D.add(c,"goog-inline-block");return c};Rz.prototype.K=s("goog-toolbar-separator");a.Sz=function(){};y(Sz,Cq);ia(Sz);Sz.prototype.tc=function(){return Vc.YI};Sz.prototype.En=function(b){return"HR"==b.tagName?new Bq(Rz.D()):Sz.m.En.call(this,b)};Sz.prototype.K=s("goog-toolbar");Sz.prototype.iw=function(){return Eq};a.Tz=function(){};y(Tz,Fu);ia(Tz);Tz.prototype.K=s("goog-toolbar-button");a.Uz=function(b,c,d){Jq.call(this,b,c||Tz.D(),d)};y(Uz,Jq);sq("goog-toolbar-button",function(){return new Uz(k)});a.Vz=function(){};y(Vz,Hu);ia(Vz);Vz.prototype.createCaption=function(b,c){return Vz.m.createCaption.call(this,Wz(b,c),c)};a.Wz=function(b,c){return c.o("div","goog-color-menu-button-indicator",b)};Vz.prototype.sa=function(b,c){b&&Xz(this.Y(b),c)};a.Xz=function(b,c){if(b&&b.firstChild){var d;d=c&&(ns.test("#"==c.charAt(0)?c:"#"+c)||xs(c).length||zs&&zs[c.toLowerCase()])?yt(c).zr:k;b.firstChild.style.borderBottomColor=d||(A?"":"transparent")}};
Vz.prototype.Ge=function(b){this.sa(b.h(),b.U());D.add(b.h(),"goog-color-menu-button");Vz.m.Ge.call(this,b)};a.Yz=function(){};y(Yz,mq);ia(Yz);a.Zz=0;t=Yz.prototype;t.o=function(b){var c=this.ef(b);return b.H().o("div",c?c.join(" "):k,$z(this,b.bb(),b.rl(),b.H()))};a.$z=function(b,c,d,e){for(var g=[],h=0,l=0;h<d.height;h++){for(var n=[],q=0;q<d.width;q++){var r=c&&c[l++];n.push(aA(b,r,e))}g.push(e.o("tr",b.K()+"-row",n))}return b.jv(g,e)};t.jv=function(b,c){var d=c.o("table",this.K()+"-table",c.o("tbody",this.K()+"-body",b));d.cellSpacing=0;d.cellPadding=0;Mc(d,"grid");return d};
a.aA=function(b,c,d){b=d.o("td",{"class":b.K()+"-cell",id:b.K()+"-cell-"+Zz++},c);Mc(b,"gridcell");return b};t.Qc=s(m);t.n=s(k);
t.La=function(b,c){if(b){var d=Ub("tbody",this.K()+"-body",b)[0];if(d){var e=0;z.forEach(d.rows,function(b){z.forEach(b.cells,function(b){ic(b);if(c){var d=c[e++];d&&b.appendChild(d)}})});if(e<c.length){for(var g=[],h=Sb(b),l=d.rows[0].cells.length;e<c.length;){var n=c[e++];g.push(aA(this,n,h));g.length==l&&(n=h.o("tr",this.K()+"-row",g),d.appendChild(n),g.length=0)}if(0<g.length){for(;g.length<l;)g.push(aA(this,"",h));n=h.o("tr",this.K()+"-row",g);d.appendChild(n)}}}rg(b,j,B)}};
a.bA=function(b,c,d){for(c=c.h();d&&1==d.nodeType&&d!=c;){if("TD"==d.tagName&&D.has(d,b.K()+"-cell"))return d.firstChild;d=d.parentNode}return k},a.cA=function(b,c,d,e){d&&(d=d.parentNode,D.enable(d,b.K()+"-cell-hover",e),Nc(c.h().firstChild,"activedescendent",d.id))};t.K=s("goog-palette");a.eA=function(b){M.call(this);this.Ed=[];dA(this,b)};y(eA,Fd);t=eA.prototype;t.mg=k;t.uf=k;t.nl=function(){return this.Ed.length};t.Nh=function(b){return this.Ed[b]||k};a.dA=function(b,c){c&&(z.forEach(c,function(b){this.im(b,m)},b),z.extend(b.Ed,c))};t.Da=function(b){this.wi(b,this.nl())};t.wi=function(b,c){b&&(this.im(b,m),z.Wn(this.Ed,b,c))};t.removeItem=function(b){b&&z.remove(this.Ed,b)&&b==this.mg&&(this.mg=k,this.dispatchEvent("select"))};t.Lg=p("mg");t.Mb=function(){return z.clone(this.Ed)};
t.xf=function(b){b!=this.mg&&(this.im(this.mg,m),this.mg=b,this.im(b,j));this.dispatchEvent("select")};t.ql=function(){return this.mg?z.indexOf(this.Ed,this.mg):-1};t.hp=function(b){this.xf(this.Nh(b))};t.clear=function(){z.clear(this.Ed);this.mg=k};t.p=function(){eA.m.p.call(this);delete this.Ed;this.mg=k};t.im=function(b,c){b&&("function"==typeof this.uf?this.uf(b,c):"function"==typeof b.nm&&b.nm(c))};a.fA=function(b,c,d){uq.call(this,b,c||Yz.D(),d);this.yi&=-89};y(fA,uq);t=fA.prototype;t.lc=k;t.pb=-1;t.ma=k;t.p=function(){fA.m.p.call(this);this.ma&&(this.ma.C(),this.ma=k);this.lc=k};t.lm=function(b){fA.m.lm.call(this,b);gA(this);this.ma?(this.ma.clear(),dA(this.ma,b)):(this.ma=new eA(b),b=v(this.im,this),this.ma.uf=b,this.g().c(this.ma,"select",this.ij));this.pb=-1};t.Jg=s("");t.jm=ba();
t.kd=function(b){fA.m.kd.call(this,b);var c=bA(this.L,this,b.target);(!c||!b.relatedTarget||!sc(c,b.relatedTarget))&&c!=hA(this)&&iA(this,c)};t.Ph=function(b){fA.m.Ph.call(this,b);var c=bA(this.L,this,b.target);(!c||!b.relatedTarget||!sc(c,b.relatedTarget))&&c==hA(this)&&cA(this.L,this,c,m)};t.De=function(b){fA.m.De.call(this,b);this.Gb()&&(b=bA(this.L,this,b.target),b!=hA(this)&&iA(this,b))};t.ee=function(b){var c=hA(this);return c?(this.xf(c),fA.m.ee.call(this,b)):m};
t.Vb=function(b){var c=this.bb(),c=c?c.length:0,d=this.lc.width;if(0==c||!this.isEnabled())return m;if(13==b.keyCode||32==b.keyCode)return this.ee(b);if(36==b.keyCode)return this.Pb(0),j;if(35==b.keyCode)return this.Pb(c-1),j;var e=0>this.pb?this.ql():this.pb;switch(b.keyCode){case 37:-1==e&&(e=c);if(0<e)return this.Pb(e-1),b.preventDefault(),j;break;case 39:if(e<c-1)return this.Pb(e+1),b.preventDefault(),j;break;case 38:-1==e&&(e=c+d-1);if(e>=d)return this.Pb(e-d),b.preventDefault(),j;break;case 40:if(-1==
e&&(e=-d),e<c-d)return this.Pb(e+d),b.preventDefault(),j}return m};t.ij=ba();t.rl=p("lc");a.jA=function(b,c){b.h()&&f(Error("Component already rendered"));b.lc=pa(c)?new Ob(c,i):c;gA(b)},a.hA=function(b){var c=b.bb();return c&&c[b.pb]};t.Pb=function(b){b!=this.pb&&(kA(this,this.pb,m),this.pb=b,kA(this,b,j))};a.iA=function(b,c){var d=b.bb();b.Pb(d?z.indexOf(d,c):-1)};t.ql=function(){return this.ma?this.ma.ql():-1};t.Lg=function(){return this.ma?this.ma.Lg():k};t.hp=function(b){this.ma&&this.ma.hp(b)};
t.xf=function(b){this.ma&&this.ma.xf(b)};a.kA=function(b,c,d){if(b.h()){var e=b.bb();e&&(0<=c&&c<e.length)&&cA(b.L,b,e[c],d)}};t.im=function(b,c){this.h()&&b&&D.enable(b.parentNode,this.L.K()+"-cell-selected",c)};a.gA=function(b){var c=b.bb();if(c)if(b.lc&&b.lc.width){if(c=Math.ceil(c.length/b.lc.width),!pa(b.lc.height)||b.lc.height<c)b.lc.height=c}else c=Math.ceil(Math.sqrt(c.length)),b.lc=new Ob(c,c);else b.lc=new Ob(0,0)};a.lA=function(b,c,d){this.Aq=b||[];fA.call(this,k,c||Yz.D(),d);this.Aq=this.Aq;this.ws=k;this.La(z.map(this.Aq,function(b){var c=this.H().o("div",{"class":this.L.K()+"-colorswatch",style:"background-color:"+b});"#"==b.charAt(0)&&(b=ys(b),b="RGB ("+[parseInt(b.substr(1,2),16),parseInt(b.substr(3,2),16),parseInt(b.substr(5,2),16)].join(", ")+")");c.title=b;return c},this))};y(lA,fA);lA.prototype.ws=k;lA.prototype.rw=function(){var b=this.Lg();return b?(b=Dt(b,"background-color"),mA(b)):k};
lA.prototype.gp=function(b){b=mA(b);this.ws||(this.ws=z.map(this.Aq,function(b){return mA(b)}));this.hp(b?z.indexOf(this.ws,b):-1)};a.mA=function(b){if(b)try{return yt(b).zr}catch(c){}return k};a.nA=function(b,c,d,e){Ju.call(this,b,c,d||Vz.D(),e)};y(nA,Ju);
a.oA={kV:"#000 #444 #666 #999 #ccc #eee #f3f3f3 #fff".split(" "),wW:"#f00 #f90 #ff0 #0f0 #0ff #00f #90f #f0f".split(" "),YV:"#f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #cfe2f3 #d9d2e9 #ead1dc #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #9fc5e8 #b4a7d6 #d5a6bd #e06666 #f6b26b #ffd966 #93c47d #76a5af #6fa8dc #8e7cc3 #c27ba0 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3d85c6 #674ea7 #a64d79 #990000 #b45f06 #bf9000 #38761d #134f5c #0b5394 #351c75 #741b47 #660000 #783f04 #7f6000 #274e13 #0c343d #073763 #20124d #4c1130".split(" ")},a.pA=
function(b){var c=new iu(b);F.forEach(oA,function(d){d=new lA(d,k,b);jA(d,8);c.M(d,j)});return c};t=nA.prototype;t.rw=function(){return this.U()};t.gp=function(b){this.sa(b)};t.sa=function(b){for(var c=0,d;d=this.Nh(c);c++)"function"==typeof d.gp&&d.gp(b);nA.m.sa.call(this,b)};t.Mn=function(b){"function"==typeof b.target.rw?this.sa(b.target.rw()):"none"==b.target.U()&&this.sa(k);nA.m.Mn.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.ub=function(b,c){b&&0==this.nl()&&(this.eh(pA(this.H())),this.sa(this.U()));nA.m.ub.call(this,b,c)};sq("goog-color-menu-button",function(){return new nA(k)});a.qA=function(){};y(qA,Hu);ia(qA);qA.prototype.K=s("goog-toolbar-menu-button");a.rA=function(){};y(rA,qA);ia(rA);rA.prototype.createCaption=function(b,c){return Iu(Wz(b,c),this.K(),c)};rA.prototype.sa=function(b,c){b&&Xz(this.Y(b),c)};rA.prototype.Ge=function(b){this.sa(b.h(),b.U());D.add(b.h(),"goog-toolbar-color-menu-button");rA.m.Ge.call(this,b)};a.sA=function(b,c,d,e){nA.call(this,b,c,d||rA.D(),e)};y(sA,nA);sq("goog-toolbar-color-menu-button",function(){return new sA(k)});a.tA=function(b,c,d,e){Ju.call(this,b,c,d||qA.D(),e)};y(tA,Ju);sq("goog-toolbar-menu-button",function(){return new tA(k)});a.vA=function(b,c,d,e){Ju.call(this,b,c,d,e);uA(this,b);this.ep(Vc.VA)};y(vA,Ju);t=vA.prototype;t.ma=k;t.tv=k;t.z=function(){vA.m.z.call(this);wA(this);xA(this);Nc(this.h(),Uc.zk,"false")};t.ea=function(b){vA.m.ea.call(this,b);(b=this.Jg())?uA(this,b):this.hp(0)};t.p=function(){vA.m.p.call(this);this.ma&&(this.ma.C(),this.ma=k);this.tv=k};t.Mn=function(b){this.xf(b.target);vA.m.Mn.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.ij=function(){var b=this.Lg();vA.m.sa.call(this,b&&b.U());wA(this)};t.eh=function(b){var c=vA.m.eh.call(this,b);b!=c&&(this.ma&&this.ma.clear(),b&&(this.ma?mh(b,function(b){yA(b);this.ma.Da(b)},this):zA(this,b)));return c};a.uA=function(b,c){b.tv=c;wA(b)};t.Da=function(b){yA(b);vA.m.Da.call(this,b);this.ma?this.ma.Da(b):zA(this,this.Wa())};t.wi=function(b,c){yA(b);vA.m.wi.call(this,b,c);this.ma?this.ma.wi(b,c):zA(this,this.Wa())};t.removeItem=function(b){vA.m.removeItem.call(this,b);this.ma&&this.ma.removeItem(b)};
t.xf=function(b){if(this.ma){var c=this.Lg();this.ma.xf(b);b!=c&&this.dispatchEvent("change")}};t.hp=function(b){this.ma&&this.xf(this.ma.Nh(b))};t.sa=function(b){if(b!=k&&this.ma)for(var c=0,d;d=this.ma.Nh(c);c++)if(d&&"function"==typeof d.U&&d.U()==b){this.xf(d);return}this.xf(k)};t.Lg=function(){return this.ma?this.ma.Lg():k};t.ql=function(){return this.ma?this.ma.ql():-1};
a.zA=function(b,c){b.ma=new eA;c&&mh(c,function(b){yA(b);this.ma.Da(b)},b);xA(b)},a.xA=function(b){b.ma&&b.g().c(b.ma,"select",b.ij)},a.wA=function(b){var c=b.Lg();b.La(c?c.Jg():b.tv)},a.yA=function(b){b.ep(b instanceof fu?Vc.YA:Vc.SI)};t.ub=function(b,c){vA.m.ub.call(this,b,c);this.qb()&&this.Wa().Pb(this.ql())};sq("goog-select",function(){return new vA(k)});a.AA=function(b,c,d,e){vA.call(this,b,c,d||qA.D(),e)};y(AA,vA);sq("goog-toolbar-select",function(){return new AA(k)});a.BA=function(b){var c=b.indexOf(",");a:{b=(-1!=c?b.substring(0,c):b).toLowerCase();for(c=0;2>c;c++){var d="\"'".charAt(c);if(b.charAt(0)==d&&b.charAt(b.length-1)==d){b=b.substring(1,b.length-1);break a}}}return b},a.CA=function(b,c){z.forEach(c,function(c){var e=c.caption,c=c.value,g=BA(c),e=new Qz(e,c,b.H());jh(e,g);b.Da(e);e.Y().style.fontFamily=c})},a.DA=[10,10,13,16,18,24,32,48],a.FA=function(b,c,d,e,g,h){d=new Uz(EA(d,e,h),g,h);jh(d,b);d.Nc(c);return d},a.GA=function(b,c,d,e,g,h){b=FA(b,c,d,
e,g,h);xq(b,16,j);return b},a.HA=function(b,c,d,e,g,h){g=new AA(k,k,g,h);e&&z.forEach(e.split(/\s+/),g.th,g);g.th("goog-toolbar-select");uA(g,d);jh(g,b);g.Nc(c);return g},a.IA=function(b,c,d,e,g,h){d=new sA(EA(d,e,h),k,g,h);jh(d,b);d.Nc(c);return d},a.EA=function(b,c,d){if((!b||""==b)&&B&&!Eb("1.9a"))b=" ";return(d||Sb()).o("DIV",c?{"class":c}:k,b)};a.JA=w("Link");w("Edit Link");w("Text to display:");a.KA=w("Link to:");w("Web address");w("Link to a page or file somewhere else on the web");w("Test this link");
w("{$startBold}Not sure what to put in the box?{$endBold} First, find the page on the web that you want to link to. (A {$searchEngineLink}search engine{$endLink} might be useful.) Then, copy the web address from the box in your browser's address bar, and paste it into the box above.",{startBold:"<b>",endBold:"</b>",searchEngineLink:"<a href='http://www.google.com/' target='_new'>",endLink:"</a>"});w("To what URL should this link go?");w("Email address");w("Link to an email address");w("Invalid email address");
w("To what email address should this link?");w("{$preb}Be careful.{$postb} Remember that any time you include an email address on a web page, nasty spammers can find it too.",{preb:"<b>",postb:"</b>"});w("Open this link in a new window");w("Image");a.LA={},a.MA=w("Normal"),a.NA=w("Normal / serif"),a.OA=[{caption:MA,value:"arial,sans-serif"},{caption:NA,value:"times new roman,serif"},{caption:"Courier New",value:"courier new,monospace"},{caption:"Georgia",value:"georgia,serif"},{caption:"Trebuchet",value:"trebuchet ms,sans-serif"},{caption:"Verdana",value:"verdana,sans-serif"}],a.PA={ja:[{caption:"ＭＳ Ｐゴシック",value:"ms pgothic,sans-serif"},{caption:"ＭＳ Ｐ明朝",value:"ms pmincho,serif"},{caption:"ＭＳ ゴシック",value:"ms gothic,monospace"}],ko:[{caption:"굴림",
value:"gulim,sans-serif"},{caption:"바탕",value:"batang,serif"},{caption:"굴림체",value:"gulimche,monospace"}],"zh-tw":[{caption:"新細明體",value:"pmingliu,serif"},{caption:"細明體",value:"mingliu,serif"}],"zh-cn":[{caption:"宋体",value:"simsun,serif"},{caption:"黑体",value:"simhei,sans-serif"},{caption:"MS Song",value:"ms song,monospace"}]},a.QA=w("Small"),a.RA=w("Normal"),a.SA=w("Large"),a.TA=w("Huge"),a.UA=[{caption:QA,value:1},{caption:RA,value:2},{caption:SA,value:4},{caption:TA,value:6}],a.VA=w("Heading"),
a.WA=w("Subheading"),a.XA=w("Minor heading"),a.YA=w("Normal"),a.ZA=[{caption:VA,ua:"H2"},{caption:WA,ua:"H3"},{caption:XA,ua:"H4"},{caption:YA,ua:"P"}],a.$A=function(b,c,d,e,g,h){var l=FA(b,c,d,e,g,h);l.pi=function(b){l.gb(b)};return l},a.aB=function(b,c){var d=c;try{if(A)var e="000000"+d.toString(16),g=e.substr(e.length-6,6),d="#"+g.substring(4,6)+g.substring(2,4)+g.substring(0,2);d!=b.U()&&b.sa(d)}catch(h){}},a.bB=w("Format"),a.cB=w("Format"),a.dB=w("Undo"),a.eB=w("Redo"),a.fB=w("Font"),a.gB=w("Font size"),
a.hB=w("Text color"),a.iB=w("Bold"),a.jB=w("Italic"),a.kB=w("Underline"),a.lB=w("Text background color"),a.mB=w("Add or remove link"),a.nB=w("Numbered list"),a.oB=w("Bullet list"),a.pB=w("Decrease indent"),a.qB=w("Increase indent"),a.rB=w("Align left"),a.sB=w("Align center"),a.tB=w("Align right"),a.uB=w("Justify"),a.vB=w("Remove formatting"),a.wB=w("Insert image"),a.xB=w("Strikethrough"),a.yB=w("Left-to-right"),a.zB=w("Right-to-left"),a.AB=w("Quote"),a.BB=w("Edit HTML source"),a.CB=w("Subscript"),
a.DB=w("Superscript"),a.EB=w("Edit HTML"),a.FB={};
LA.SA=[{ua:"+undo",P:dB,Ja:"tr-icon tr-undo",factory:$A,eb:j},{ua:"+redo",P:eB,Ja:"tr-icon tr-redo",factory:$A,eb:j},{ua:"+fontName",P:fB,Ja:"tr-fontName",factory:function(b,c,d,e,g,h){var l=HA(b,c,d,e,g,h),b="en-us".replace(/_/,"-").toLowerCase(),c=[];b in PA&&(c=PA[b]);c.length&&CA(l,c);CA(l,OA);uA(l,MA);D.add(l.Wa().Y(),"goog-menu-noaccel");l.pi=function(b){var c=k;b&&0<b.length&&(c=kh(l.Wa(),BA(b)));c!=l.Lg()&&l.xf(c)};return l},eb:j},{ua:"+fontSize",P:gB,Ja:"tr-fontSize",factory:function(b,c,
d,e,g,h){var l=HA(b,c,d,e,g,h);z.forEach(UA,function(b){var c=b.value,b=new Qz(b.caption,c,l.H());l.Da(b);b=b.Y();b.style.fontSize=(DA[c]||10)+"px";b.firstChild.style.height="1.1em"});uA(l,RA);D.add(l.Wa().Y(),"goog-menu-noaccel");l.pi=function(b){var c;if(c=oa(b))c=b.match(As),c="px"==(c&&c[0]||k);c&&(b=z.lastIndexOf(DA,parseInt(b,10)));b=0<b?b:k;b!=l.U()&&l.sa(b)};return l},eb:j},{ua:"+bold",P:iB,Ja:"tr-icon tr-bold",eb:j},{ua:"+italic",P:jB,Ja:"tr-icon tr-italic",eb:j},{ua:"+underline",P:kB,Ja:"tr-icon tr-underline",
eb:j},{ua:"+foreColor",P:hB,Ja:"tr-icon tr-foreColor",factory:function(b,c,d,e,g,h){b=IA(b,c,d,e,g,h);b.gp("#000");b.pi=xa(aB,b);return b},eb:j},{ua:"+backColor",P:lB,Ja:"tr-icon tr-backColor",factory:function(b,c,d,e,g,h){b=IA(b,c,d,e,g,h);b.gp("#FFF");b.pi=xa(aB,b);return b},eb:j},{ua:"+link",P:mB,caption:JA,Ja:"tr-link",eb:j},{ua:"+insertOrderedList",P:nB,Ja:"tr-icon tr-insertOrderedList",eb:j},{ua:"+insertUnorderedList",P:oB,Ja:"tr-icon tr-insertUnorderedList",eb:j},{ua:"+outdent",P:pB,Ja:"tr-icon tr-outdent",
factory:FA},{ua:"+indent",P:qB,Ja:"tr-icon tr-indent",factory:FA},{ua:"+justifyLeft",P:rB,Ja:"tr-icon tr-justifyLeft",eb:j},{ua:"+justifyCenter",P:sB,Ja:"tr-icon tr-justifyCenter",eb:j},{ua:"+justifyRight",P:tB,Ja:"tr-icon tr-justifyRight",eb:j},{ua:"+justifyFull",P:uB,Ja:"tr-icon tr-justifyFull",eb:j},{ua:"+removeFormat",P:vB,Ja:"tr-icon tr-removeFormat",factory:FA},{ua:"image",P:wB,Ja:"tr-icon tr-image",factory:FA},{ua:"+strikeThrough",P:xB,Ja:"tr-icon tr-strikeThrough",eb:j},{ua:"+subscript",P:CB,
Ja:"tr-icon tr-subscript",eb:j},{ua:"+superscript",P:DB,Ja:"tr-icon tr-superscript",eb:j},{ua:"ltr",P:yB,Ja:"tr-icon tr-ltr",eb:j},{ua:"rtl",P:zB,Ja:"tr-icon tr-rtl",factory:function(b,c,d,e,g,h){var l=GA(b,c,d,e,g,h);l.pi=function(b){b=!!b;D.enable(l.getParent().h(),"tr-rtl-mode",b);l.Zc(b)};return l},eb:j},{ua:"+BLOCKQUOTE",P:AB,Ja:"tr-icon tr-BLOCKQUOTE",eb:j},{ua:"+formatBlock",P:bB,caption:cB,Ja:"tr-formatBlock",factory:function(b,c,d,e,g,h){var l=HA(b,c,d,e,g,h);z.forEach(ZA,function(b){var c=
b.caption,b=b.ua,d=l.H(),c=new Qz(d.o("DIV",k,c),b,d);jh(c,b);l.Da(c)});uA(l,YA);D.add(l.Wa().Y(),"goog-menu-noaccel");l.pi=function(b){b=b&&0<b.length?b:k;b!=l.U()&&l.sa(b)};return l},eb:j},{ua:"editHtml",P:BB,caption:EB,Ja:"tr-editHtml",factory:FA}];for(var GB=0,HB;HB=LA.SA[GB];GB++)FB[HB.ua]=HB;delete LA.SA;a.IB={};IB.ST=rk;a.JB=function(b){yv.call(this);this.ga=new le(this);this.bE=K("div",{style:"display:none"});this.e=this.rc=k;this.F={};F.extend(this.F,this.R,b||{})};y(JB,yv);ya(JB.prototype,IB);JB.prototype.R={pk:k,title:"Distraction Free Mode",cK:"back",sS:"publish",dw:"zu-editing-distraction-free",kT:"sticky-goog-scrollfloater",LT:"goog-scrollfloater"};JB.prototype.jd=jf("FullScreenPlugin");FB.toggleFullScreen={ua:"toggleFullScreen",P:"写作模式",Ja:"tr-icon tr-max",factory:FA};t=JB.prototype;
t.Je=xa(F.Bg,{IW:"toggleFullScreen",$U:"enterFullScreen",aV:"exitFullScreen"});t.p=function(){this.ga.C();L(this.e);this.F=this.wp=this.rc=this.vb=this.e=k;JB.m.p.call(this)};
t.Qu=function(){var b=this.F,c=document.createElement("div");c.id="zu-distraction-free-editor";c.innerHTML='<div class="header"><div class="wrapper"><h1 class="title">'+b.title+'</h1><a href="#" class="'+b.cK+'" name="return">返回</a><a href="#" class="'+b.sS+'" name="save">发布</a></div></div><div class="toolbar"><div class="tools"></div></div><div class="content" class="grid"></div>';document.body.appendChild(c);this.ga.c(J("back",c),"click",function(b){b.preventDefault();KB(this)},m,this);this.ga.c(J("publish",
c),"click",function(b){b.preventDefault();this.dispatchEvent("save")&&KB(this)},m,this);this.e=c;this.rc=J("content",c);this.wp=K("div",{className:"toolbar-info"});this.F.pk||(this.F.pk=this.B.field)};t.bf=function(b){this.e||this.Qu();switch(b){case "enterFullScreen":LB(this);break;case "exitFullScreen":KB(this);break;case "toggleFullScreen":this.Ax()?KB(this):LB(this)}};t.Ax=function(){return D.has(document.body,this.F.dw)};
a.LB=function(b){if(b.dispatchEvent("willEnterFullScreen")){b.$C||(b.VN=history.length);b.$C=j;MB(b,"writing");b.lI=Lc(Sb((fa||window).document));mc(b.bE,b.F.pk);b.rc.appendChild(b.F.pk);D.add(document.body,b.F.dw);b.vb=J(b.F.LT,b.e);b.vb.appendChild(b.wp);var c=b.e;c.scrollTop=0;var d=b.vb.getBoundingClientRect().top;c.onscroll=nf(v(b.hH,b),function(){return c.scrollTop>d});b.ga.c(document,"keydown",b.Fo,m,b);Ka(Fc(b.B.field))||b.B.Vf();b.dispatchEvent("enterFullScreen")}},a.KB=function(b){b.$C&&
b.VN!==history.length?history.back():MB(b,"");b.vb.removeChild(b.wp);b.hH(m);b.e.onscroll=k;b.ga.Ba(document,"keydown",b.Fo,m,b);mc(b.F.pk,b.bE);D.remove(document.body,b.F.dw);window.scrollTo(b.lI.x,b.lI.y);b.dispatchEvent("exitFullScreen")},a.MB=function(b,c){wd(window,"hashchange",b.OF,m,b);location.hash=c||"";setTimeout(v(function(){this.ga.c(window,"hashchange",this.OF,m,this)},b))};t.OF=function(){this.Ax()?KB(this):"writing"===location.hash.slice(1)&&LB(this)};
t.Fo=function(b){27===b.keyCode&&this.dispatchEvent("shouldExitFullScreenOnEscape")&&KB(this)};t.hH=function(b){D[b?"add":"remove"](this.vb,this.F.kT)};a.OB=function(b,c){M.call(this);this.wF=b;this.Gz=c||NB;b.Ac||(this.show=ha)};y(OB,Hk);a.NB="加载中...";t=OB.prototype;
t.show=function(){kc(this.e=K("div","zg-mt10",[K("h3",{style:"margin:0 0 5px;"},"分享到微博"),K("div","zm-tab-content",[this.fX=K("div",{className:"zg-section zg-clear",innerHTML:'<label><input data-bindurl="/oauth/auth/sina?next=/oauth/callback" class="sina-checkbox" type="checkbox"><i class="zg-ico-sina"></i> 新浪微博</label> <label><input data-bindurl="/oauth/auth/qq?next=/oauth/callback" class="qq-checkbox" type="checkbox"><i class="zg-ico-qq"></i> 腾讯微博</label>'}),K("div","zg-section",K("div","zg-form-text-input",
this.ip=K("textarea",{style:"width:100%;height: 66px;"},"加载中..."))),K("div","zm-command",[K("div",["zm-item-meta","zg-left"],this.KS=K("span")),this.mT=K("a",{"class":"zg-btn-blue weibo-share-button",href:"javascript:;"},"分享到微博")])])]),H("zh-question-answer-form-wrap"));this.g().c(W,"sina_callback",function(b){this.Cz(b.sb.id,b.sb.name)}).c(W,"qq_callback",function(b){this.Bz(b.sb.id,b.sb.name)});this.Iu();this.qf();iq.D().refresh();var b=this;this.Gz===NB?Ci("/answer/"+b.wF.Ac+"/sharetext",function(c){if((c=
Ge(c.target))&&c.sina)b.Gz=c.sina,b.Ha()},"GET"):this.Ha()};t.Cz=function(b,c){Qg.name=c;this.uH=Qg.id=b;this.yc.checked=j;this.qf()};t.Bz=function(b,c){Rg.name=c;this.MR=Rg.id=b;this.wc.checked=j;this.qf()};t.qf=function(){var b=J("weibo-share-button",this.e),c=this.yc.checked||this.wc.checked;D.enable(b,"zg-btn-blue",c);D.enable(b,"zg-btn-disabled",!c)};t.Ha=function(){this.ip.value=this.Gz;this.Rz=new fm(this.ip);this.sH=new uu(this.ip,this.KS,140,su);this.g().c(this.mT,"click",this.fa)};
t.Iu=function(){this.yc=J("sina-checkbox",this.e);this.g().c(this.yc,"change",this.Ko);this.wc=J("qq-checkbox",this.e);this.g().c(this.wc,"change",this.Ko)};t.Ko=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.yc&&!this.uH||b===this.wc&&!this.MR?(window.open(c),b.checked=m):this.qf()};
t.fa=function(b){if((b=b.target)&&D.has(b,"zg-btn-blue")&&this.ip.value){b=new lk(j);b.add("content",Ys(Ua(this.ip.value)));var c=[];this.yc.checked&&c.push("sina");this.wc.checked&&c.push("qq");b.add("via",c.join(","));this.Nj(b);rk("share",this.wx?"answer_weibo":"question_weibo")}else U("请您选择或绑定微博后再进行分享！")};t.Nj=function(b){b.add("aid",this.wF.ka);this.xhr=new V(j);P(this.g(),this.xhr,"complete",this.wu);this.xhr.ajax("/answer/share",b.Ic())};
t.wu=function(){var b=Ge(this.xhr);b&&b.r?U(b.msg):(U("分享发送完毕"),R(this.e,m))};a.xx=function(b,c,d){fu.call(this,b,c,d);this.$o(j)};y(xx,fu);sq("goog-checkbox-menuitem",function(){return new xx(k)});a.PB=function(b,c){M.call(this);this.V=b;this.ed=c;this.data=Cg};y(PB,Hk);t=PB.prototype;
t.v=function(){this.Zl=H("zh-question-redirect-info");this.Zl.innerHTML&&(this.fo=j);this.g().c(this.Zl,"click",function(b){"cancel"===b.target.name&&QB(this)});var b=H("zh-question-side-header-wrap");if(Bg.vc&&!Bg.GE&&b){var c=H("zh-question-filter-wrap");c?jc(b,c):b.style[A?"styleFloat":"cssFloat"]="none"}(this.gg=H("zh-question-operation-menu"))&&this.qj();this.g().c(Ii,"anon_change",function(b){var c=H("zh-question-side-invitation-anon");c&&R(c,b.jb);(c=H("zh-question-side-invitation-notanon"))&&
R(c,!b.jb);this.Ql&&this.Ql.gb(dt(this.data.Qs)||!b.jb)});(this.sk=H("zh-question-webshare-container"))&&this.g().c(this.sk,"click",this.Mz)};
t.qj=function(){this.kb=new iu;var b=this.data.Nm,c=this.gg.getAttribute("data-auth"),c=c?c.split(","):[];if(b==k||0===b){this.kb.Da(this.Cs=RB("使用匿名身份",j));this.Cs.Zc(this.data.jb);if((!Kg||!z.contains(Kg,"question_op_redirect"))&&"close"!==Cg.status)this.kb.Da(this.Ql=RB(this.fo?"撤消重定向":"问题重定向")),this.Ql.gb(dt(this.data.Qs)||!this.data.jb);z.contains(c,"auth-f-manage")&&this.kb.Da(this.cR=RB("更新话题页显示",m));this.g().c(this.kb,"action",this.hj);this.Cs&&this.g().c(Ii,"anon_change",function(b){this.Cs.Zc(!!b.jb)});
b=new Ju("Settings",this.kb);b.Ys=j;Lu(b);b.n(this.gg)}};a.RB=function(b,c){return!b?new hu:c?new xx(b):new fu(b)};
t.hj=function(b){var c=this.Cs;b.target===c?es(c.He()?1:0,function(b){b||c.Zc(!c.He())}):b.target===this.Ql?(this.Qo||(this.Qo=new Gy(this.V),this.g().c(this.Qo,"change",this.iP)),this.kb.w(m),this.fo?QB(this):this.Qo.show()):b.target===this.YQ?Ci("/question/"+this.data.Ac+(this.YQ.He()?"/unlock_summary":"/lock_summary"),function(){top!==window?top.location.href="/question/"+Cg.Ac:window.location.reload()},"POST"):b.target===this.cR&&$.post("/refresh_topic_feeds",{q:Cg.Ac}).done(function(b){b.r||
U("操作成功！")})};t.iP=function(){this.Zl.innerHTML='<div class="zg-wrap"><div class="zu-global-nitify-inner"><span class="zu-global-notify-icon"></span>此问题将跳转至 <a href="/question/'+this.Qo.ft+'">'+this.Qo.vG+'</a> （<a href="javascript:;" name="cancel">撤消重定向</a>）</div></div>';R(this.Zl,j);this.fo=j;this.Ql.jm("撤消重定向")};a.QB=function(b){b.Zl.innerHTML="";R(b.Zl,m);b.fo=m;b.Ql.jm("问题重定向");Ci("/question/unredirect",k,"POST","qid="+b.V+"&rqid="+b.ft)};
t.Mz=function(b){if((b=kk(this.sk,b.target))&&b.name){var c=vu.D(),d=$("#zh-question-webshare-container").data();xu(c,d.id,d.url,d.type);c.show();yu(c,"tb-webshare-"+b.name);W.X({type:"ga_click_share_question_box",target:b,data:{type:b.name}})}};a.SB=function(){T.call(this)};y(SB,T);SB.prototype.M=function(b,c){SB.m.M.call(this,b,c);this.g().c(b,"beforeexpand",this.EN)};SB.prototype.EN=function(b){var c=b.target;mh(this,function(b){c!==b&&b.ic()&&b.Ia(m)})};SB.prototype.C=function(){this.g().C();SB.m.C.call(this)};a.TB=function(b,c){T.call(this);this.LR=b;this.Os=c;this.zO=this.Z=k;this.yd=m;this.Yn=k;this.El=[];this.CH=[];this.kg=m;this.cP="loading";this.wE="zg-btn-white";this.AO="invite-button"};y(TB,T);t=TB.prototype;t.o=function(){this.e=K("div",{style:"display:none",className:"question-invite-panel"})};t.W=function(){this.kg=j;TB.m.W.call(this)};
t.z=function(){TB.m.z.call(this);var b=this.e,c=this.g();if(!this.kg){c.c(Ii,"anon_change",this.reload);var d=J("cancel-anon",b);d&&c.c(d,"click",this.vM);if(!J("error-message")){var d=J("search-input",b),e=J("invite-title",b);this.ux=J("invite-status",b);c.c(this.ux,"click",this.wM);var g=J("suggest-persons",b);g&&(c.c(g,"click",this.Lw),this.BH=g);$(b).on("hover",".invited-shortlist",function(){$(".invited-hovercard",b).toggleClass("in")});this.mx(d,e);this.CH=$(this.BH).children().map(this.lG).get();
this.El=$(".invited-fulllist",this.ux).children().map(this.lG).get();var h=function(b){0>b||b>n-1||(x.find("li").hide().slice(4*b,4*(b+1)).show(),0===b?q.addClass("link-disabled"):q.removeClass("link-disabled"),b===n-1?r.addClass("link-disabled"):r.removeClass("link-disabled"),l=b)},c=this.e,l=0,n,q,r,x;x=$(".suggest-persons",c);n=x.find("li").length/4;q=$(".js-prev",c).on("click",function(){h(l-1)});r=$(".js-next",c).on("click",function(){h(l+1)});h(0)}}};t.ib=function(){TB.m.ib.call(this);this.g().C()};
t.Hi=s('<i class="icon icon-spike"></i><div class="spinner">正在加载，请稍等 <i class="spinner-gray"></i></div>');t.reload=function(){this.ic()?this.Tj():this.kg=j};t.Tj=function(){var b=this,c=this.cP;this.ib();D.add(this.e,c);this.e.innerHTML=this.Hi();return $.get("/node/QuestionInvitePanelV2",{params:{question_id:this.LR}}).done(function(d){b.kg=m;D.remove(b.e,c);d=fc(Ka(d));R(d,b.ic());mc(d,b.e);b.e=d;b.z()})};t.p=function(){TB.m.p.call(this);this.zO=k;this.Z.C()};t.ic=p("yd");t.expand=function(){this.Ia(j)};
t.collapse=function(){this.Ia(m)};t.Ia=function(b){if(b!==this.yd){this.dispatchEvent(b?"beforeexpand":"beforecollapse");var c=v(function(){this.dispatchEvent(b?"expand":"collapse")},this);b&&this.kg?this.Tj().done(c):c();this.yd=b;R(this.e,b)}};t.he=function(){this.Ia(!this.yd)};
t.mx=function(b){var c=this,d=tk('<img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><span class="zu-autocomplete-row-name" title="<%-fullname%>"><%-fullname%></span><span class="zg-gray-normal zu-autocomplete-row-description"><%=headline%></span>');this.Z=new Pp(b,{ce:8,source:"/people/autocomplete",Vj:b.offsetParent,placeholder:"搜索你想邀请的人",od:function(b,c,h){h.innerHTML=d(b.data)},filter:function(b){return z.filter(b,function(b){var d=b.id;return!z.find(c.El,function(b){return b.id===d})})},
select:function(b){UB(c,"ask_to_answer_search");jt(c.Os,b.id,"search").done(function(d){if(d.r)return U(d.msg);VB(c,b);WB(c,b.id,j)});return""}})};a.XB=function(b,c,d){b=b.wE;d?(D.add(c,b),xc(c,"收回邀请")):(D.remove(c,b),xc(c,"邀请回答"))};t.vM=function(){es(0)};a.UB=function(b,c){var d=Cg;b.dispatchEvent(new Iw("click!invitation",{category:"invitation",action:"ask_to_answer",label:c,value:d.DE?k:d.fq}))};
t.Lw=function(b){var c=b.target;if("BUTTON"===c.tagName||D.has(c,this.AO)){this.Yn&&"pending"===this.Yn.state()&&this.Yn.abort();b="related"===c.getAttribute("data-type")?"recommended_relative_questions":"recommended_top_answerers";UB(this,b);var d=c.getAttribute("data-uid"),e=this.wE,g=v(function(b){b?(XB(this,c,j),b=z.find(this.CH,function(b){return b.id===d}),VB(this,b)):(XB(this,c,m),YB(this,d))},this);D.has(c,e)?(this.Yn=it(this.Os,d),g(m)):(this.Yn=jt(this.Os,d,b).done(function(b){b.r&&(U(b.msg),
g(m))}),g(j))}};t.wM=function(b){b=b.target;"BUTTON"===b.tagName&&(b=b.getAttribute("data-uid"),it(this.Os,b),WB(this,b,m),YB(this,b))};a.WB=function(b,c,d){var e=$(".invite-button",b.BH).filter(function(){return this.getAttribute("data-uid")===c}).get(0);e&&XB(b,e,d)};t.lG=function(){var b=$(this),c=$(".zm-item-link-avatar",b);return{id:String($("button",b).data("uid")),avatar:$("img",c).attr("src"),fullname:c.attr("title"),url_token:c.attr("href").split("/").slice(-1)[0]}};
a.VB=function(b,c){b.El.unshift(c);ZB(b);$(".ignore-invite-hint").css("display","none")},a.YB=function(b,c){b.El&&z.XR(b.El,function(b){return b.id===c})&&(ZB(b),$(".ignore-invite-hint").css("display","none"))};t.NS='您已邀请 <span class="invited-shortlist"><% helper.each(persons.slice(0, 2), function(person, i, sliced) { %><a href="/people/<%=person.url_token%>" class="zg-link-gray"><%=person.fullname%></a><%= i !== sliced.length - 1 ? "、" : ""%><% }); %><%=helper.fullList()%></span><% if (persons.length > 2) { %> 等 <%=persons.length%> 人 <% } %>';
t.dM='<div class="invited-hovercard"><i class="icon icon-spike"></i><ul class="invited-fulllist"><% helper.each(persons, function(person, i) { %><li><a title="<%-person.fullname%>" class="zm-item-link-avatar" href="/people/<%=person.url_token%>"><img src="<%=person.avatar%>" class="zm-item-img-avatar"></a><a href="/people/<%=person.url_token%>" class="zg-link-gray" title="<%-person.fullname%>"><%=person.fullname%></a><button class="cancel-button zg-link-btn zg-link-gray" data-uid="<%=person.id%>">收回邀请</button></li><% }) %></ul></div>';
a.ZB=function(b){var c=b.El,d={each:z.forEach,fullList:function(){return tk(b.dM,{persons:c,helper:d})}};b.ux.innerHTML=c.length?tk(b.NS,{persons:c,helper:d}):""};a.$B=function(b){this.data=b;this.la=k};y($B,T);t=$B.prototype;t.z=function(){$B.m.z.call(this);this.g().c(this.e,"click",this.Ol);var b=J("panel-container",this.e);b&&(this.Ll=new SB,this.M(this.Ll),this.Ll.n(b),aC(this),this.la=new Rw(this.data.V,"question"),this.Ll.M(this.la),Uw(this.la,this.Ll.h(),$(".toggle-comment",this.e)[0]));this.g().c(this,"click!",function(b){"comment"===b.namespace&&b.bd.fill("label","question")})};
t.Ol=function(b){var c=(b=kk(this.e,b.target))&&b.name;if(c)switch(c){case "report-question":Wt.am("question",this.data.V);break;case "addcomment":if("添加评论"===$.trim($(b).text())&&this.Fj(0,"question_add_comment_start"))break;this.la.he();this.la.ic()&&this.la.mi("view_comments",parseInt(Fc(b),10)||0);break;case "remove":Ai("删除问题","你确定要删除这个问题吗？相关的评论也将被删除。",function(b){if(b){var c=new V(j);N(c,"complete",function(){var b=Ge(c);b&&!b.r?window.location.href="/":U(b.msg)});c.ajax("/question/delete/"+
this.data.V)}},this);break;case "admin":c=this.jJ;c||(c=new Nu,c.n(H("zh-question-admin-menu")),mh(c,function(b){b.sa(b.h().getAttribute("data-action"))}),this.g().c(c,"action",function(b){var b=this.gB=b.target,c=qv.D();c.dl={id:this.data.V,type:"question"};xv(c,b.h(),v(this.TK,this));c.w(j)}),this.jJ=c);c.Q()?c.w(m):Ou(c,new Us(b,1,j),0,new Mf(5,0,5,0));break;case "share":W.X({type:"ga_click_share_question_box",target:b});this.hf();break;case "invite":this.Lw()}};
t.Fj=function(b,c){return!S.Ma()?(nk.D().Ga=c,nk.D().w(j),nk.D().fh(),j):m};a.aC=function(b){if("normal"===Cg.status){var c=new TB(b.data.V,b.data.Ac),d=H("question-invite-panel");d?(c.n(d),c.Ia(j),b.dispatchEvent(new Iw("show!invitation",{category:"invitation",action:"ask_to_answer_card",label:""}))):c.W(b.Ll.h());b.Ll.M(c);b.Dl=c}};
t.Lw=function(){if(this.Dl){this.Dl.he();var b=this.Dl.ic();this.dispatchEvent(new Iw("click!invitation",{category:"invitation",action:(b?"show":"hide")+"_ask_to_answer_card",label:"?",value:this.data.fq}))}else aC(this)};t.hf=function(){if(S.Ma()){var b=vu.D();xu(b,this.data.V,"/question/"+this.data.Ac,"q");b.show();yu(b,"tb-webshare-sina")}else nk.D().w(j),nk.D().fh()};t.TK=function(b){this.gB.U(b.msg.action);this.gB.jm(b.msg.caption)};a.bC=function(b,c,d){qx.call(this,b,c,d)};y(bC,qx);bC.prototype.n=function(b){bC.m.n.call(this,b);this.Me&&this.Yo(this.gL.jb)};bC.prototype.Q=function(){return $(this.e).is(":visible")};a.cC=function(){T.call(this);this.data=Cg||{};this.V=this.data.V;this.fo=m;this.Hf={};this.Hk=[];this.Gk=[];this.Ej=0;this.dq=k};y(cC,T);a.dC={eu:"vote",wI:"added_time"};t=cC.prototype;t.Ek="zm-item-answer";t.v=function(){Ar.M(this);this.n(document.body)};
t.z=function(){cC.m.z.call(this);var b=H("zh-question-meta-wrap");b&&(this.Zy=new $B(this.data),this.M(this.Zy),this.Zy.n(b));this.qx();var c=this;$(".js-ignore-invite").click(function(){$(".question-invited-by").hide();var b=c.Zy;b.Dl||aC(b);P(c.g(),b.Dl,"expand",function(){$(".ignore-invite-hint").css("display","inline")});b.Dl.expand();$.post("/question/askpeople",{qid:c.data.Ac,uid:S.Cj,op:"pass"})});this.xo=new uz;this.g().c(this.xo,"change",this.Ny);this.xo.v();this.iH();Cr()};
t.iH=function(){this.Eu=dC.eu;this.data.Ac=Cg.Ac;eC(this,j);if(S.Ma()&&("close"!==Cg.status&&(this.Na=new Yn(this.data.RT,this.data.V),this.Na.os=5,this.Na.rs=1,this.Na.vs=j,this.Na.n(J("zm-tag-editor",this.e)),this.g().c(this.Na,["remove_tag","add_tag"],function(){W.X("ga_edit_question_topic_changed")}),this.g().c(this.Na,"start_editing",function(){W.X("ga_question_topic_edit_finish_changed")})),"close"!==Cg.status)){this.Hd=new Sy(this.data.V,"/question/title","content",m,j);this.Hd.Rq=j;this.Hd.Ad=
j;this.Hd.Xj=j;var b=dt(this.data.Qs);this.Hd.Fl=b;this.Hd.n(H("zh-question-title"));this.g().c(this.Hd,"change",function(){Ii.dispatchEvent("question_title_change");document.title=this.Hd.bb()+" - 知乎"});this.g().c(this.Hd,"click_edit",function(){W.X("ga_question_title_edit_start")});this.g().c(this.Hd,"cancel_edit",function(){W.X("ga_question_title_edit_cancel")});this.g().c(this.Hd,"save_changed",function(){W.X("ga_question_title_edit_save_changed")});this.g().c(this.Hd,"save_unchanged",function(){W.X("ga_question_title_edit_save_unchanged")})}this.zB=
H("zh-question-answer-num");this.Mm=H("zh-question-answer-wrap");this.Ah=H("zh-question-collapsed-link");this.en=H("zh-question-collapsed-wrap");this.KK=H("zh-question-collapsed-num");this.OJ=H("zh-question-answer-form-wrap");this.lk=H("zh-question-notification-summary");this.wH=H("zh-answers-filter");this.Rs=H("zh-add-question-sug");this.Ah&&this.g().c(this.Ah,"click",this.rT);this.Rs&&this.g().c(this.Rs,"click",this.GD);P(this.g(),this,"answers_inited",this.PP);(this.cv=H("zg-question-suggested-topics"))&&
this.g().c(this.cv,"click",this.NP);this.Vn();this.g().c(window,"hashchange",function(b){b=b.Ub;b.oldURL&&"writing"===b.oldURL.split("#")[1]||fC(this)});this.dq=new T;this.M(this.dq);this.dq.n(this.Mm);this.oE()};t.qx=function(){Au("question",this.data.Ac,"read");this.g().c(this,["click!","show!"],function(b){"comment"===b.namespace&&b.bd.fill("category","question_answer").fill("label","question_answer");"invitation"===b.namespace&&b.bd.fill("label","question_page")})};
t.PP=function(){var b=S[4];Dg&&Dg.length&&(b=Dg[0][1]);this.ob=new lw(this.data.jb,S,b);this.M(this.ob);this.ob.n(this.OJ);Ig&&Ig.length?this.ob.La(Ig[0]):!Bg.vc&&B&&this.ob.La("<p></p>");!this.data.co&&!this.Ej&&(this.data.Nm&&this.data.Nm.length&&this.data.Nm[3]!==S[3]?this.ob.gb(m,"只有 "+at(this.data.Nm)+" 能回答此问题"):("normal"===Cg.status||Ig)&&this.ob.Gd());this.g().c(this.ob,"change",this.OP);this.g().c(this.ob,"cancel_delete_answer",this.XP);this.ob.ready(function(){var b=this.lr();b&&"writing"===
location.hash.slice(1)&&b.execCommand("toggleFullScreen")});gC(this);fC(this,k);hC(this);this.g().c(Ii,"anon_change",function(b){this.data.jb=b.jb});if(b=$("#zh-question-filter-wrap")[0]){var c=this,d=new pz({options:{vote:"按票数排序",added_time:"按时间排序"}});d.sa("vote");d.n(b);c.g().c(d,"change",function(b){b=b.data.key;if(b!==c.Eu){c.Eu=b;var d=function(b,c){return b-c},h=function(b,c){return c-b};b===dC.eu?z.vH(c.Hk,"vote",h):b===dC.wI&&z.vH(c.Hk,"added_time",d);z.forEach(c.Hk,function(b){b=this.Hf[b.aid];
b.Qg||jc(b.h(),this.Mm.firstChild)},c)}$(window).trigger("updatelazy")})}this.g().c(Ii,"answer_reorder",this.JN)};t.Ny=function(){this.NN=j;this.lk=$(this.xo.HP)[0];kc(this.lk,H("zh-question-redirect-info"));R(this.lk,j);Bg.vc||(this.Xi=new Dp,this.Xi.n(this.lk),Xr(this.Xi));this.g().c(this.lk,"click",this.GD);fC(this)};
a.eC=function(b,c){!S.Ma()||!c?(iC(b,"zh-question-detail",ha),iC(b,"zh-question-answer-summary",ha)):(iC(b,"zh-question-detail",b.iO),iC(b,"zh-question-answer-summary",b.kO))},a.iC=function(b,c,d){if(c=H(c)){var e=new ox;b.g().c(e,"expand",d).c(e,"invalid",d);e.n(c)}};
t.iO=function(b){if("close"!==Cg.status){b=b.target.h();this.Kb=new Sy(this.data.V,"/question/detail","content",j,k,600);var c=dt(this.data.Qs);this.Kb.Fl=c;this.Kb.nX=pk;J("zm-editable-content",b).innerHTML&&(this.Kb.Xj=j);this.Kb.n(b);this.g().c(this.Kb,"click_edit",function(){W.X("ga_question_supplement_edit_start")});this.g().c(this.Kb,"cancel_edit",function(){W.X("ga_question_supplement_edit_cancel")});this.g().c(this.Kb,"save_changed",function(){W.X("ga_question_supplement_edit_save_changed")});
this.g().c(this.Kb,"save_unchanged",function(){W.X("ga_question_supplement_edit_save_unchanged")})}};t.kO=function(b){var b=b.target.h(),c=H("zh-question-answer-summary-link"),d;if(b&&(Bg.xE||!this.data.oT))d=new fq(j,"/question/summary","content"),d.de=["id="+this.data.V],d.tq=m,d.n(b);if(c){var e=H("zh-question-answer-summary-wrap");this.g().c(c,"click",function(){d&&(R(e,j),d.Gd())}).c(e,"click",function(b){"cancel"===b.target.name&&(b=!d.Wf(),R(e,!b))})}this.eZ=d};
t.GD=function(b){if("close"===b.target.name){if(this.Xi&&(Jp(this.Xi),Ip(this.Xi,m),history.replaceState)){var b=new tf(location.href),c=b.Ic();c.remove("q");c.remove("psq");history.replaceState({},"",b.jg+"?"+c.toString())}R(this.lk,m);R(this.Rs,m)}else if("A"===b.target.tagName&&"zh-question-suggest-reask"===b.target.id&&(R(this.Rs,m),W.fireEvent("query_string_change")),c="a"===$(b.target).prop("tagName").toLowerCase()?b.target:this.df(b.target,"A"))b.preventDefault(),b.stopPropagation(),b=c.getAttribute("data-source")||
c.href,c=b.indexOf("#"),b=0>c?k:b.substr(c+1),fC(this,b&&decodeURIComponent(b))};a.hC=function(b){var c=0,d=0,e=0;z.forEach(b.Gk,function(b){b=this.Hf[b];b.ag||(b.Qg?d++:e++,c++)},b);b.data.yq=+b.KK.innerHTML;S.Ma()||(b.data.yq=0);b.data.fq=e;R(b.Ah,0<b.data.yq);b.zB&&xc(b.zB,e?e+" 个回答":"还没有回答");b.wH&&R(b.wH,1<b.data.fq);R(b.Ah,0<b.data.yq)};
t.oE=function(){this.hO||(this.AB=Vb(this.Ek,this.Mm),this.UJ=this.AB.length,this.PJ=200,this.sC=0);this.hO=j;for(var b=this.sC,c=this.PJ,d=this.UJ,e=b;e<d&&e<b+c;)jC(this,this.AB[e],e),e++;e<d?(this.sC=e,setTimeout(v(this.oE,this),30)):this.dispatchEvent("answers_inited")};
a.jC=function(b,c,d,e){e=new bC(b.V,k,e);b.dq.M(e);e.n(c);b.Hf[e.ka]=e;b.Gk.push(e.ka);b.g().c(e,"change",b.qy);e.Me&&(b.Ej=e.ka,e.YJ=S,b.g().c(e.qe,"change",b.gN),b.Ve=e);e.Qg?e.Me&&b.en.appendChild(e.h()):b.Hk.push({added_time:e.kv,vote:d,aid:e.ka});e.ag&&R(e.h(),m)};
t.gN=function(){var b=this.Ve,c=b.h(),d=b.qe.bb()[0];R(c,m);d=fc(Ka(d));jc(d,c);this.Hf[b.ka]=k;this.Gk=z.filter(this.Gk,function(c){return c!==b.ka},this);var e=999;this.Hk=z.filter(this.Hk,function(c){c.aid===b.ka&&(e=c.vote);return c.aid!==b.ka},this);L(c);b.C();jC(this,d,e,m)};t.JN=function(b){1>=this.Gk.length||this.Eu!==dC.eu||gk(this.Hf[b.yB].h())};
t.qy=function(b){b=b.target;if(b instanceof bC){var c=b.h();switch(b.ku){case "collap":this.en.appendChild(c);D.add(c,"zm-item-collapsed");hC(this);break;case "cancel_collap":this.Mm.appendChild(c);D.remove(c,"zm-item-collapsed");kC(this,c);hC(this);break;case "set_delete":gC(this);hC(this);break;case "cancel_delete":kC(this,this.Hf[this.Ej].h()),gC(this),hC(this)}}};
a.gC=function(b){var c=k,c=k,d={suggest:"建议修改",evaluate:"建议修改",close:"关闭"};!Ig&&"normal"!==Cg.status&&(c="被"+d[Cg.status]+'的问题不允许添加新的回答。<a data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a>');b.Ej&&(c=b.Hf[b.Ej],c=c.ag?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':'一个问题你只能回答一次，但你可以对 <a href="#answer-'+c.ka+'">现有的回答</a> 进行修改');b.data.co&&(c='该问题目前已经被锁定，无法添加新答案。<a href="http://www.zhihu.com/question/19604313" target="_blank">问题为什么会被锁定？</a>');
c&&!b.ob.Mf&&b.ob.gb(m,c)},a.lC=function(b,c){var d=H("zh-question-collapsed-switcher");c?(d.name="collap",b.eC=j,R(b.en,j),D.add(b.Ah,"zu-question-collap-title-active")):(b.eC=m,d.name="expand",R(b.en,m),D.remove(b.Ah,"zu-question-collap-title-active"))};
t.rT=function(b){if((b=kk(this.Ah,b.target))&&b.name)if("expand"===b.name){if(!this.MK){this.MK=j;var c=this,d=this.en,b=$.get("/node/QuestionCollapsedAnswerListV2",{params:{question_id:this.data.V}});b.done(function(b){b=fc(b);lC(c,j);D.remove(d,"zm-question-collapsed-list-loading");d.appendChild(b);z.forEach(oc(d),function(b){b!==e&&jC(c,b,99999)});$("img.lazy",d).lazyload({data_attribute:"actualsrc",threshold:400})});var e=oc(d)[0];e&&(R(e,m),b.done(function(){R(e,j)}));R(d,j);D.add(d,"zm-question-collapsed-list-loading")}lC(this,
j)}else lC(this,m)};t.XP=function(){var b=this.Hf[this.Ej];b.ag=m;b.status=0;yx(b);kC(this,b.h())};
t.OP=function(){var b=this.ob.cq.checked,c={pF:j,title:"确认放弃匿名身份？",content:"你在该问题下的赞同和关注行为将以实名显示。"},d=v(function(){if(!this.xhr||!this.xhr.Gb()){var c=this.ob.Wf();if(c){var d=new V(j),h=new Qi,l=b?1:0;h.add("id",this.V).add("content",c).add("anon",l);d.on("success",function(){Cg.jb!==l&&Ii.dispatchEvent(new Wr(l));var b=Ge(this.xhr);b&&!b.r?(b=fc(Ka(b.msg[0])),this.Mm.appendChild(b),jC(this,b,this.Gk.length,j),gC(this),Cg.jb||(this.DP=new OB(this.Hf[this.Ej]),this.DP.show()),hC(this),this.ob.C()):
U(b.msg)},m,this);d.ajax("/answer/add",h.toString());this.xhr=d}}},this);Cg.jb&&!b?Ai(c,function(b){b&&d()}):d()};t.df=ba();t.NP=function(b){if((b=this.df(b.target))&&b.name){var c=b.name;"close"===c?R(this.cv,m):"addtag"===c&&(this.Na.Ue(b.id.split("-")[1],b.innerHTML),R(b,m))}};t.Vn=function(){this.Nz=new PB(this.V);this.Nz.v()};
a.fC=function(b,c){if(c=c||location.hash.slice(1)){var d=c.split("-"),e=d[1];"answer"===d[0]&&(d=b.Hf[e])&&(d.Qg&&!b.eC?kC(b,b.Ah):kC(b,d.h()))}},a.kC=function(b,c){if(c){var d=vg(document.body).top,e=b.NN?mg(b.lk).height:0,d={paddingTop:d+e};"number"===$.type(d)&&(d={offsetTop:d});d.gI=ws;vs(c,d);gk(c);b.Xi&&b.Xi.Bp()}};a.mC=function(){cC.call(this);this.data=Cg;this.V=this.data.V};y(mC,cC);t=mC.prototype;t.iH=function(){(this.Uq=H("zh-single-answer-disable-wrap"))&&this.g().c(this.Uq,"click",this.nS);this.Cl();this.Vn();var b=$("#zh-question-answer-collestions");b.length&&$("a[name=focus]",b).click(function(){ok(this,"favlist")});eC(this,m)};t.qx=function(){this.g().c(this,["click!","show!"],function(b){"invitation"===b.namespace&&b.bd.fill("label","answer_page")});mC.m.qx.call(this)};
t.nS=function(b){b.target&&b.target.name&&(b=this.ed,b.ag=m,b.status=0,yx(b))};
t.Cl=function(){var b=J("zm-item-answer",H("zh-question-answer-wrap"));if(b){this.ed=new bC(this.V);this.M(this.ed);this.ed.n(b);b=this.g();b.c(this.ed,"change",this.qy);if(this.ed.HO){b.c(Ii,"anon_change",function(b){var c=b.jb,b=$("#js-sidebar-author-info");if(!$("a[name=focus]",b).length){var g={"0":"fullname",1:"url_token",2:"avatar_path",3:"hash",4:"headline"},h=z.reduce(S,function(b,c,d){b[g[d]]=c;return b},{}),c=tk(this.ZJ,{author:!c&&h});b.html(c)}});var c=this.ed.qe;c&&b.c(c,"change",function(){var b=
Ka(c.bb()[0]),b=fc(b);mc(b,this.ed.e);this.Cl(b)})}nC(this);ux(this.ed,{autofocus:m,WE:j})}};t.ZJ='<h3>关于作者</h3><% if (author) { %>    <a class="zm-list-avatar-link" href="/people/<%= author.url_token %>" tabindex="-1">        <img class="zm-list-avatar-medium" src="<%= author.avatar_path.replace("_s.","_m.") %>"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">            <a href="/people/<%= author.url_token %>"><%= author.fullname %></a>        </h2>        <div class="zg-gray-normal"><%= author.headline || "" %></div>    </div><% } else { %>    <a class="zm-list-avatar-link" href="javascript:;">        <img class="zm-list-avatar-medium" src="http://img.zhihu.dev:4080/66/6b/666b0abfc_m.jpg"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">匿名用户</h2>    </div><% } %>';
t.Vn=function(){this.Nz=new PB(this.V,this.ed);this.Nz.v();var b=H("js-sidebar-author-info");b&&(new Bn(b)).v()};t.qy=function(b){b=b.target;if(b instanceof bC)switch(b.ku){case "collap":D.add(b.h(),"zm-item-collapsed");break;case "cancel_collap":D.remove(b.h(),"zm-item-collapsed");break;case "set_delete":case "cancel_delete":nC(this),location.reload()}};
a.nC=function(b){b.ed?b.ed.ag?(b.Uq.innerHTML=b.ed.Me?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':"此答案已经被作者删除",R(b.ed.h(),m)):R(b.ed.h(),j):b.Uq.innerHTML="此答案已经被作者删除"};a.oC=function(){T.call(this);this.page=1};y(oC,T);oC.prototype.v=function(){var b=J("js-topic-feed-page");this.n(b)};
oC.prototype.z=function(){oC.m.z.call(this);var b=this;this.IA=$(".js-topic-feed-container",this.e);this.IA.find(".js-topic-item").each(function(){var c=new pC;b.M(c);c.n(this)});this.Is=new qC;this.Is.n($(".js-pinned-topics",this.element)[0]);(this.Xb=H("js-load-more"))&&this.g().c(this.Xb,"click",this.Ay);$(".instruction .close-normal").click(function(){var b=new V(m);b.ajax("/notifeature?feature=6",k,"GET");vd(b,"success",function(){$(".instruction").fadeOut()})});this.g().c(this.Is,"change",function(b){$("#tf-"+
b.JH).find(".js-pin").replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')})};a.rC=function(b,c){xc(b,c?"加载中...":"更多")};oC.prototype.Ay=function(){rC(this.Xb,j);this.xhr=new V(j);P(this.g(),this.xhr,"complete",v(this.of,this));var b=new lk;b.add("page",++this.page);this.xhr.ajax(location.pathname,b.Ic())};
oC.prototype.of=function(){var b=this,c=Ge(this.xhr);c&&!c.r&&(0<c.msg.length?($(c.msg).each(function(c,e){var g=new pC;b.M(g);g.n($(e)[0]);b.IA.append(g.h())}),rC(this.Xb,m)):$(this.Xb).hide())};a.pC=function(){T.call(this)};y(pC,T);pC.prototype.z=function(){pC.m.z.call(this);this.g().c(this.e,"click",v(this.oy,this))};
pC.prototype.oy=function(b){var c=b.target,b=$(c).attr("data-action"),d=$(this.e).find(".topic-avatar img"),e=d.clone(),g,h=$(this.e).data("id");if("pin-topic"===b)g=this.getParent().Is,sC(g,h).done(function(b){if(!b.r&&b.msg){gk(c);$(c).replaceWith('<a href="javascript:;" data-action="unpin-topic" class="zg-gray unpin topic-hover-content" style=""><i class="z-icon-unpin"></i>取消固定</a>');var b=d.offset(),h=$(g.e).offset();1E3<b.top-h.top?(h=$(".top-nav-topic-selector.current a").offset(),h={top:h.top+
20,left:h.left+15,width:"25px",height:"25px",opacity:0.1},e.css({position:"absolute","z-index":"999"}).css("top",b.top).css("left",b.left).appendTo("body").animate(h,300,function(){e.remove()})):e.css({position:"absolute","z-index":"999"}).appendTo("body").css("top",b.top).css("left",b.left).animate({top:h.top-63+$(g.e).height(),left:h.left,width:"-=50px",height:"-=50px",opacity:0.5},300,function(){e.remove()})}});else if("unpin-topic"===b){var l=this.getParent().Is,n=function(){var b=$(c).replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')[0];
gk(b)},q=$(l.e).find("[data-topicid="+h+"]");q.fadeOut(function(){q.remove();l.Bt().done(function(){n&&n()});l.dispatchEvent({type:"change",JH:q.attr("data-topicid")})})}else if("follow"===b||"unfollow"===b)ok(c,"topic",k,["follow","unfollow"]),$(this.e).fadeOut()};a.qC=function(){T.call(this)};y(qC,T);qC.prototype.eS=tk('<div class="side-topic-item js-pin-item  cursor-move" data-topicid="<%=topic.id%>" >    <a href="/topic/<%=topic.url_token%>" class="pin-topic-avatar-link">        <img src="<%=topic.avatar_path%>" alt="" title="拖动以排序" class="side-topic-avatar js-topic-avatar">    </a>    <div class="side-topic-content ellipsis">        <a href="/topic/<%=topic.url_token%>" class="topic-link side-topic-title"><%=topic.name%></a>        <div class="side-topic-meta">        <% if (topic.children_num > 0) { %>            <span class="zg-gray"><%=topic.children_num%> 个子话题</span>            <span class="bull">&bull;</span>        <% } %>            <span class="zg-gray"><%=topic.followers_num%> 人关注</span>        </div>        <% if (topic.feed_num > 0) { %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>"><%=topic.feed_num %> 条动态&nbsp;&raquo;</a>        <% }else{ %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>">进入话题 &raquo;</a>        <% } %>    </div>    <a href="javascript:;" data-action="up" class="up" data-tip="s$b$置顶"></a>    <a href="javascript:;" data-action="remove" class="delete"></a></div>');
qC.prototype.z=function(){qC.m.z.call(this);this.g().c(this.e,"click",v(this.oy,this));tC(this)};a.tC=function(b){b.Nf&&b.Nf.C();var c=new Jn;c.Yq="pin-topic-moving";Kn(c,b.e,0);c.v();b.g().c(c,"dragend",v(b.Bt,b));b.Nf=c;$("a",b.e).each(function(){b.g().c(this,"mousedown",function(b){b.stopPropagation()})})};
qC.prototype.oy=function(b){var c=this,d=b.target,e=$(d).attr("data-action");if(e){var g=$(d).parents(".js-pin-item");if("up"===e){var b=g.position(),h=g.clone();g.before(h).css({position:"absolute","z-index":"999"}).css("top",b.top).animate({top:$(c.e).position().top},200,function(){h.remove();g.css({position:"relative",top:0}).prependTo(c.e);c.Bt()});h.css("opacity",0)}else"remove"===e&&g.fadeOut(function(){g.remove();c.Bt();c.dispatchEvent({type:"change",JH:g.attr("data-topicid")})})}else b.stopPropagation()};
a.sC=function(b,c){return $.post("/pin-topic/add",{tid:c},$.proxy(function(b){!b.r&&b.msg?($(this.e).append($(this.eS({topic:b.msg})).hide().fadeIn()),tC(this)):U(b.msg,2E3)},b))};qC.prototype.Bt=function(){var b=[];$(this.e).find("div.js-pin-item").each(function(){b.push($(this).attr("data-topicid"))});return $.post("/pin-topic",{topic_ids:b.join(",")},ba())};a.uC=function(){T.call(this);this.aD="even";this.mn="current"};y(uC,T);t=uC.prototype;t.v=function(){Ar.M(this);this.n(document.body)};
t.z=function(){uC.m.z.call(this);this.Xt=$("ul.zm-topic-cat-main").children();var b=this.ud=$("div.zh-general-list"),c=new Qt({Ya:["autoload","nodeSource"]});this.M(c);c.n(b.get(0));this.g().c(c,"next",this.$p);this.RE=c;b.on("click","a.follow",function(){ok(this,"topic",xa(gk,this),k,{follow_text:"关注"})});N(window,"hashchange",this.PF,m,this);this.PF()||(b.show(),this.$p())};
t.$p=function(){var b=this.ud.show().children();if(!b.length)return this.ud.html('<p class="zg-gray-normal" style="text-align:center;line-height:4;">没有子话题。</p>');b.removeClass("no-border "+this.aD);b.filter(":odd").addClass(this.aD);b=b.last();b.index()%2?b.add(b.prev()).addClass("no-border"):b.addClass("no-border");var b=this.or(),c=b.params&&b.params.topic_id,b=this.Xt.filter(function(){return $(this).attr("data-id")===String(c)});b.length&&b.addClass(this.mn).siblings().removeClass(this.mn)};
t.or=function(){return this.ud.data("init")};t.PF=function(){var b;a:{var c=decodeURIComponent(location.hash.slice(1));if(c&&(b=this.Xt.filter(function(){return $(this).text()===c}),b.length&&this.Xt.filter("."+this.mn).text()!==c)){b.addClass(this.mn).siblings().removeClass(this.mn);b={params:{topic_id:b.data("id")}};var d=this.or();$.extend(j,d,b);this.ud.attr("data-init",JSON.stringify(d));this.ud.empty();this.RE.Fi();this.RE.Vx();b=j;break a}b=i}return b};a.vC=function(){T.call(this)};y(vC,T);vC.prototype.v=function(){Ar.M(this);this.n(document.body)};vC.prototype.z=function(){vC.m.z.call(this);wC(this,"zh-global-logs-wrap");wC(this,"zh-global-logs-questions-wrap");wC(this,"zh-question-log-list-wrap")};a.wC=function(b,c){var d=H(c);if(d){var e=new Qt;b.M(e);e.Ya("locationSource",{Gs:j});e.n(d);Jy(d)}};a.xC=function(){T.call(this)};y(xC,T);xC.prototype.v=function(){Ar.M(this);this.n(document.body)};xC.prototype.z=function(){xC.m.z.call(this);this.Un("zh-question-followers-list-wrap")};xC.prototype.Un=function(b){if(b=H(b)){var c=new Qt;this.M(c);c.Ya("locationSource");c.n(b)}};a.yC=function(){};yC.prototype.v=function(){var b=H("zh-invited-member-list");b&&(new Oy(b,"/invitation/more","people",["zg-btn-follow","zg-btn-unfollow"],j)).v();(b=H("zh-invited-sina-member-list"))&&(new Oy(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j)).v();H("zh-sina-invite")&&(new lz).v();new Rm(H("invite_friend"))};a.zC=function(b,c){var d=this;this.F={};this.R={source:"/topic/autocomplete",select:k,filter:k,Vj:k,od:function(b,c,e){e.innerHTML=d.Bf(b.data)}};F.extend(this.F,this.R,c||{});var e=new Pp(b,this.F);N(e,"show",function(){1<e.fb.length&&!e.fb[0].id&&nm(e)});this.Z=e};zC.prototype.Bf=tk('<% if (data.avatar) { %><img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><% } %><% if(data.type === "search_link" || !data.id){ %><span class="zu-autocomplete-row-name zu-autocomplete-row-name-info"><%=data.type === "search_link"?("添加 "+label+" 话题"):label%></span><% } else { %><span class="zu-autocomplete-row-name"><%=label%></span><% } %><span class="zg-gray-normal zu-autocomplete-row-description"><% if (data.alias && data.followers) { %><% if ( data.alias ) { %>又称 <%=alias%><% } %><% if ( data.alias && data.followers ){ %>，<% } %><% if ( data.followers ){ %><%=followers%> 人关注<% } %><% }else{ %>&nbsp;<% } %></span>');
a.AC=function(b,c){var d=this.F={};F.extend(d,this.R,c||{});this.input=b;this.dc=d.dc;this.kh=this.sR();this.Ru=[];this.Ru.push({action:"remove",method:this.YR,aL:d.VR,P:"删除"});setTimeout(v(this.xg,this))};y(AC,Fd);
ya(AC.prototype,{R:{dc:k,oL:"",Vu:m,Bf:'<li data-id="<%=id%>"><a class="zm-item-tag" href="<%=url%>"><%=name%></a></li>',parse:function(b){return{$s:j,id:Number(b.getAttribute("data-id")),url:b.href,name:Fc(b)}},SS:lf,GL:"zm-profile-tag-editable",$m:"zm-profile-tag-btn",VR:"zm-profile-tag-btn-del"},has:function(b){return!!z.find(this.kh,function(c){return c.name===b.name||c.id===b.id})},hD:function(b){return z.find(this.kh,function(c){return c.name===b})},IX:function(b){b=Number(b);return z.find(this.kh,
function(c){return c.id===b})},add:function(b,c){if(b){var d=v(function(){this.has(b)||this.kh.push(b);b.$s=m;if(c||this.F.SS.call(this,b))this.cS(b),b.$s=j,this.dispatchEvent("add")},this);b.id?d():sC(Fx,b.name)}},remove:function(b){b=Number(b);this.kh=z.filter(this.kh,function(c){return b!==c.id},this);this.dispatchEvent("remove")},mM:function(){return z.filter(this.kh,function(b){return b.$s!==m})},cS:function(b){b=fc(this.MG(b));this.dc.appendChild(b);this.be(b)},MG:function(b){return tk(this.F.Bf,
b)},W:function(){this.dc.innerHTML=z.map(this.kh,this.MG,this).join("")},sR:function(){return z.map(this.BD(),this.F.parse)},BD:function(){return oc(this.dc)},xg:function(){var b=this,c=b.F;this.PT=new zC(this.input,{Vj:Hc(b.input,function(b){return"static"!==$.css(b,"position")}),placeholder:this.input.getAttribute("placeholder"),select:function(d){b.add({id:d.id,name:d.id?d.label:b.input.value,url:"/topic/"+d.url_token,avatar:d.avatar,url_token:d.url_token});return c.oL},filter:function(d){return z.filter(d,
function(d){return c.Vu&&!d.id?m:!z.find(b.kh,function(b){return b.$s&&b.id===d.id})})}});z.forEach(this.BD(),this.be,this);N(this.input,"keypress",function(d){var e;if(13===d.keyCode&&!c.Vu&&(e=Ka(this.value))&&!b.PT.Z.qb())b.add(b.hD(e)||{id:k,name:e,url:"/topic/"+e})})},YR:function(b){this.remove(b.getAttribute("data-id"));this.dc.removeChild(b)},vR:function(b,c){var d=z.find(this.Ru,function(c){return c.action===b});d&&d.method&&d.method.call(this,c);this.input.focus()},be:function(b){var c=this.F;
D.add(b,c.GL);z.forEach(this.Ru,function(d){var e=new Jq(" ",Kq.D());e.th([c.$m,d.aL].join(" "));e.W(b);e.gb(j);e.Nc(d.P);e.addEventListener("action",function(){this.vR(d.action,b)},m,this)},this)}});a.BC=function(){this.KA=this.LA=k};
BC.prototype.v=function(){function b(b,c){var g=K("li"),h=K("span","item-label",b);g.appendChild(h);var l=new Jq("",Kq.D());l.th("zm-profile-tag-btn zm-profile-tag-btn-del");l.gb(j);l.Nc("移除动作");l.sa(c);l.addEventListener("action",function(){var b=l.U();e(b,m);L(g);X.Ws(j);d()});l.W(g);Xa.appendChild(g)}function c(){na.w(X.nl()!==z.filter(X.Mb(),function(b){return!!(b.da&8)}).length)}function d(){z.forEach(Q,function(b){b.selected||(b=new Qz(b.text,b.value),X.Da(b))});c()}function e(b,c){var d=z.find(Q,
function(c){return c.value===b});d&&(d.selected=c)}function g(){var b=$.grep(n.get(0).options,function(b){return b.selected});$.map(b,function(b){return b.value})}function h(){q=$.map(G.mM(),function(b){return b.id});I.val(q.join(","))}var l=$("#rq-settings-ui"),n=$("select.select",l);$(".topics-num",l);$(".actions-num",l);var q=[];this.KA=$("#rq-info-block");l.on("click",".beginedit-button",function(b){b.preventDefault();l.addClass("expanded-view")}).on("click",".exitedit-button",function(b){b.preventDefault();
l.removeClass("expanded-view")}).on("click",".endedit-button",function(b){b.preventDefault();l.get(0).submit()});var r=$(".topic-editor",l),x=$("input.topic-input",r).get(0),E=$("ul.tag-list",r).get(0),G=new AC(x,{Vu:j,dc:E}),I=$('input[name="topics"]',r);G.on(["add","remove"],h);n.on("change",g);h();g();r=n.get(0);R(r,m);var Q=r.options,X=new iu;X.on("action",function(d){d=d.target;b(d.Jg(),d.U());e(d.U(),j);X.removeItem(d);c()});var na=new Ju("添加动作",X);na.th("menu-button");na.W(r.parentNode);na.Ys=
j;Lu(na);var Xa=K("ul","display-list");d();z.forEach(Q,function(c){c.selected&&b(c.text,c.value)});r.parentNode.insertBefore(Xa,na.h());var Na=this,r=$("#rq3-item-list"),Ta={yT:function(b){return $.post("/watch/thank",{id:b,rq_type:"thank"})},NR:function(b){return $.post("/watch/seen",{id:b,rq_type:"seen"})}};r.on("click",".read-button",function(){var b=$(this).closest(".rq-item"),c=b.data("id");Ta.NR(c);c=ce.text()||0;0<c&&ce.text(c-1);var d=Na.KA,e=Number(Na.LA.text());setTimeout(function(){d.toggleClass("hidden",
!!e)},210);b.slideUp(function(){b.remove()})}).on("click",".thank-button",function(b){b.preventDefault();var b=$(this),c=b.closest(".rq-item").data("id");b.hasClass("thanked")||(Ta.yT(c),b.addClass("thanked").text("已感谢"))});Jy(r);r=new ju(r.get(0),location.href,j);r.mG=function(b){return b.getAttribute("data-id")};r.wf("rq-item");r.v();var r=$("#rq3-sidenav-link"),ce=$(".zg-num",r);this.LA=ce};a.CC=function(){};CC.prototype.v=function(){$("a.js-obfuscate-email").each(function(){var b=$(this),c=b.data("email").split("").reverse().join("");b.attr("href","mailto:"+c).text(c)})};a.DC=function(){};y(DC,T);DC.prototype.v=function(){Ar.M(this);this.n(document.body)};DC.prototype.z=function(){DC.m.z.call(this);var b=$("#zh-following-question-item-list").children(".zh-general-list");if(b.length){var c=new Qt;this.M(c);c.Ya("nodeSource");c.n(b.get(0))}this.rx();Cr()};DC.prototype.rx=function(){var b=H("zh-trendings");b&&(this.TT=new zt).n(b)};a.EC=function(){T.call(this)};y(EC,T);EC.prototype.z=function(){this.g().c(this.e,"click",this.Co)};EC.prototype.Co=function(b){var c=b.target;c&&"rmdraft"===c.name&&Ai("删除草稿","你确定要删除这个草稿吗？",function(b){b&&(Ci("/answer/draft/delete",k,"POST","qid="+c.id.split("-")[1]),L(this.e))},this)};a.FC=function(){};y(FC,T);FC.prototype.v=function(){var b=H("zh-draft-page-wrap");b&&this.n(b)};
FC.prototype.z=function(){N(H("zh-clear-all-draft"),"click",function(){Ai("删除所有草稿","你确定要删除所有草稿吗？删除后将无法恢复",function(b){b&&(window.location.href="/draft/clear")});return m});this.Un()};FC.prototype.Un=function(){var b=H("zh-draft-item-list");if(b){var c=new Qt;c.Ya("locationSource",{Gs:j}).Ya("childConstructor",{Eh:EC});c.n(b)}};a.GC=function(b){return $.post("/node/ExploreAnswerListV2",{method:"get_feeds",params:{offset:b}})};a.HC=function(){this.Jj="explore";this.RL="explore_feed"};y(HC,T);HC.prototype.v=function(){Ar.M(this);this.n(document.body)};HC.prototype.z=function(){HC.m.z.call(this);var b=H("zh-explore-list"),c=new IC;this.M(c);c.n(b);this.g().c(this,"click!",function(b){"comment"===b.namespace&&b.bd.fill("category",this.Jj).fill("label",this.RL)})};a.IC=function(){Jt.call(this,{source:this.source});this.xR=3E5};y(IC,Qt);
IC.prototype.z=function(){IC.m.z.call(this);this.Ya("childConstructor",{Eh:zx}).Ya("activeSource",{UB:"%d 条新热门内容",source:v(this.gJ,this)})};IC.prototype.gJ=function(b,c){var d=this,e=setInterval(function(){var e;e=c()[0]||d.Mb()[0];e=$(e).data("offset");GC(-e).done(function(c){c.r||b(c.msg)})},this.xR);return{C:function(){clearInterval(e)}}};IC.prototype.source=function(){return GC($(this.Mb()).last().data("offset")).then(function(b){return!b.r&&{results:b.msg}})};a.JC=function(){T.call(this)};y(JC,T);JC.prototype.v=function(){Ar.M(this);this.n(document.body)};JC.prototype.z=function(){JC.m.z.call(this);this.Un()};JC.prototype.Un=function(){var b=H("js-suggest-people");if(b){var c=0,d=new Qt({source:function(){return $.get("",{start:c+20,limit:20}).then(function(b){if(!b.r)return b=b.msg,b.hasmore&&(c+=20),{results:b.htmls,next:Boolean(b.hasmore)}})}});this.M(d);d.n(b)}};Ca("ZH.entryQuestionLog",function(){(new vC).v()});Ca("ZH.entryQuestionFollowersPage",function(){(new xC).v()});Ca("ZH.entrySQ",function(){(new cC).v()});Ca("ZH.entrySA",function(){(new mC).v()});Ca("ZH.entryL",function(){(new vz).v()});Ca("ZH.entryT",function(){(new rz).v()});Ca("ZH.entryTS",function(){(new uC).v()});Ca("ZH.entryP",function(){(new Ky).v()});Ca("ZH.entryM",function(){(new dz).v()});Ca("ZH.entryPM",function(){(new Xt).v()});Ca("ZH.entryPMDetail",function(){(new Yt).v()});
Ca("ZH.entryHelp",function(){(new Ft).v()});Ca("ZH.entryInvite",function(){(new yC).v()});Ca("ZH.entryQueue",function(){(new cz).v()});Ca("ZH.entryTest",ba());Ca("ZH.entrySettings",function(){(new gz).v()});Ca("ZH.entryTopicFeed",function(){(new oC).v()});Ca("ZH.entryTest",function(){(new Xs.NW).v()});Ca("ZH.entryRQ3",function(){(new BC).v()});Ca("ZH.entryTerms",function(){(new CC).v()});Ca("ZH.entryHome",function(){(new Oz).v()});Ca("ZH.entryQuestionFollowing",function(){(new DC).v()});
Ca("ZH.entryDraft",function(){(new FC).v()});Ca("ZH.entryExplore",function(){(new HC).v()});Ca("ZH.entryLookup",function(){(new JC).v()});Ca("ZH.entryCC",function(){$(function(){$("#js-apply-button").click(function(){if(S.Ma()){$.post("/classical-chinese");var b=$(this),c=b.data("num");b.text("您已申請使用").addClass("disabled");$(".apply-num").text("已有 "+(c+1)+" 人申請")}else nk.D().w(j)})})});Gf("app");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/app.js